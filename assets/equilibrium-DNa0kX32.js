import{c as S,i as Lt,g as Ct,a as Wt,r as N,e as Rt,o as Ue,d as T,S as ke,j as e,H as It,L as mt,X as Ie,n as Ft,s as Mt,h as zt,p as $t,u as M,q as K,t as qt,R as _t,m as Bt}from"./x-CZayGA_K.js";import{T as Ee}from"./triangle-alert-DkjWnX7a.js";import{S as Pt,B as Ye,C as We,a as Ht,L as Ve,R as Kt,P as Gt}from"./step-back-B0OJpjC1.js";import{H as ae}from"./hexagon-C9XtkT1l.js";import{C as Re}from"./crown-Dx9ZX0tf.js";import{T as Qe}from"./trash-2-CvQllGyi.js";import{H as Ut}from"./history-Zl31ME6M.js";import{P as pe}from"./paw-print-WS0y3B9i.js";import{E as fe}from"./eye-vNcUtVSg.js";import{C as Yt,S as Xe,a as Vt}from"./snowflake-DNcYKQQf.js";import{C as me,R as Se,a as Ze,S as Je,T as Qt}from"./turtle-BwLHCN3D.js";import{F as Xt}from"./footprints-BzVO5ZaY.js";import{B as te,F as Zt}from"./fish-DQ5YZdb7.js";import{O as et}from"./origami-CzfET1jJ.js";import{F as Jt}from"./flame-XBfCM_8i.js";import{G as es}from"./ghost-BsYVa44o.js";import{F as ts,L as ss}from"./leaf-BVvn15JN.js";import{B as as}from"./bug-Byvs5i_t.js";import{T as rs}from"./target-C75h6gJn.js";import{T as ns}from"./trophy-DYxnvBw2.js";const ls=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],os=S("arrow-up",ls);const is=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],xt=S("chart-no-axes-column",is);const ds=[["path",{d:"M6 5h12",key:"fvfigv"}],["path",{d:"M4 12h10",key:"oujl3d"}],["path",{d:"M12 19h8",key:"baeox8"}]],cs=S("chart-no-axes-gantt",ds);const ms=[["path",{d:"M5 20a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1z",key:"b89hwq"}],["path",{d:"M15 18c1.5-.615 3-2.461 3-4.923C18 8.769 14.5 4.462 12 2 9.5 4.462 6 8.77 6 13.077 6 15.539 7.5 17.385 9 18",key:"8jdkhx"}],["path",{d:"m16 7-2.5 2.5",key:"1jq90w"}],["path",{d:"M9 2h6",key:"1jrp98"}]],xs=S("chess-bishop",ms);const us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ae=S("circle",us);const hs=[["path",{d:"M16.17 7.83 2 22",key:"t58vo8"}],["path",{d:"M4.02 12a2.827 2.827 0 1 1 3.81-4.17A2.827 2.827 0 1 1 12 4.02a2.827 2.827 0 1 1 4.17 3.81A2.827 2.827 0 1 1 19.98 12a2.827 2.827 0 1 1-3.81 4.17A2.827 2.827 0 1 1 12 19.98a2.827 2.827 0 1 1-4.17-3.81A1 1 0 1 1 4 12",key:"17k36q"}],["path",{d:"m7.83 7.83 8.34 8.34",key:"1d7sxk"}]],ps=S("clover",hs);const fs=[["path",{d:"m20.9 18.55-8-15.98a1 1 0 0 0-1.8 0l-8 15.98",key:"53pte7"}],["ellipse",{cx:"12",cy:"19",rx:"9",ry:"3",key:"1ji25f"}]],bs=S("cone",fs);const gs=[["path",{d:"m21.12 6.4-6.05-4.06a2 2 0 0 0-2.17-.05L2.95 8.41a2 2 0 0 0-.95 1.7v5.82a2 2 0 0 0 .88 1.66l6.05 4.07a2 2 0 0 0 2.17.05l9.95-6.12a2 2 0 0 0 .95-1.7V8.06a2 2 0 0 0-.88-1.66Z",key:"1u2ovd"}],["path",{d:"M10 22v-8L2.25 9.15",key:"11pn4q"}],["path",{d:"m10 14 11.77-6.87",key:"1kt1wh"}]],js=S("cuboid",gs);const ys=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5v14a9 3 0 0 0 18 0V5",key:"aqi0yr"}]],Ns=S("cylinder",ys);const vs=[["path",{d:"M11.25 16.25h1.5L12 17z",key:"w7jh35"}],["path",{d:"M16 14v.5",key:"1lajdz"}],["path",{d:"M4.42 11.247A13.152 13.152 0 0 0 4 14.556C4 18.728 7.582 21 12 21s8-2.272 8-6.444a11.702 11.702 0 0 0-.493-3.309",key:"u7s9ue"}],["path",{d:"M8 14v.5",key:"1nzgdb"}],["path",{d:"M8.5 8.5c-.384 1.05-1.083 2.028-2.344 2.5-1.931.722-3.576-.297-3.656-1-.113-.994 1.177-6.53 4-7 1.923-.321 3.651.845 3.651 2.235A7.497 7.497 0 0 1 14 5.277c0-1.39 1.844-2.598 3.767-2.277 2.823.47 4.113 6.006 4 7-.08.703-1.725 1.722-3.656 1-1.261-.472-1.855-1.45-2.239-2.5",key:"v8hric"}]],ws=S("dog",vs);const ks=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],Es=S("droplet",ks);const Ss=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Oe=S("earth",Ss);const As=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],Os=S("feather",As);const Ts=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],Ds=S("moon",Ts);const Ls=[["path",{d:"M11.25 17.25h1.5L12 18z",key:"1wmwwj"}],["path",{d:"m15 12 2 2",key:"k60wz4"}],["path",{d:"M18 6.5a.5.5 0 0 0-.5-.5",key:"1ch4h4"}],["path",{d:"M20.69 9.67a4.5 4.5 0 1 0-7.04-5.5 8.35 8.35 0 0 0-3.3 0 4.5 4.5 0 1 0-7.04 5.5C2.49 11.2 2 12.88 2 14.5 2 19.47 6.48 22 12 22s10-2.53 10-7.5c0-1.62-.48-3.3-1.3-4.83",key:"1c660l"}],["path",{d:"M6 6.5a.495.495 0 0 1 .5-.5",key:"eviuep"}],["path",{d:"m9 12-2 2",key:"326nkw"}]],tt=S("panda",Ls);const Cs=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],Ws=S("piggy-bank",Cs);const Rs=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]],Is=S("repeat-1",Rs);const Fs=[["path",{d:"M15.236 22a3 3 0 0 0-2.2-5",key:"21bitc"}],["path",{d:"M16 20a3 3 0 0 1 3-3h1a2 2 0 0 0 2-2v-2a4 4 0 0 0-4-4V4",key:"oh0fg0"}],["path",{d:"M18 13h.01",key:"9veqaj"}],["path",{d:"M18 6a4 4 0 0 0-4 4 7 7 0 0 0-7 7c0-5 4-5 4-10.5a4.5 4.5 0 1 0-9 0 2.5 2.5 0 0 0 5 0C7 10 3 11 3 17c0 2.8 2.2 5 5 5h10",key:"980v8a"}]],st=S("squirrel",Fs);const Ms=[["path",{d:"M11.264 2.205A4 4 0 0 0 6.42 4.211l-4 8a4 4 0 0 0 1.359 5.117l6 4a4 4 0 0 0 4.438 0l6-4a4 4 0 0 0 1.576-4.592l-2-6a4 4 0 0 0-2.53-2.53z",key:"1si4ox"}],["path",{d:"M11.99 22 14 12l7.822 3.184",key:"1u8to0"}],["path",{d:"M14 12 8.47 2.302",key:"guo3d5"}]],zs=S("stone",Ms);const $s=[["path",{d:"m19 12-1.5 3",key:"9bcu4o"}],["path",{d:"M19.63 18.81 22 20",key:"121v98"}],["path",{d:"M6.47 8.23a1.68 1.68 0 0 1 2.44 1.93l-.64 2.08a6.76 6.76 0 0 0 10.16 7.67l.42-.27a1 1 0 1 0-2.73-4.21l-.42.27a1.76 1.76 0 0 1-2.63-1.99l.64-2.08A6.66 6.66 0 0 0 3.94 3.9l-.7.4a1 1 0 1 0 2.55 4.34z",key:"1tij6q"}]],at=S("worm",$s),rt="/rawfids-gamehub/assets/harmony_cover-CSLe_GE3.png",qs={apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},ut=Lt(qs),Te=Ct(ut),D=Wt(ut),L=typeof __app_id<"u"?__app_id:"equilibrium-game",_s="9",xe=()=>e.jsx("style",{children:`
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(16, 185, 129, 0.3); border-radius: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(16, 185, 129, 0.6); }
    
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(10deg); }
    }
    .animate-float { animation: float infinite ease-in-out; }
    
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .animate-spin-slow { animation: spin-slow 12s linear infinite; }

    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    .mask-gradient-right { mask-image: linear-gradient(to right, black 85%, transparent 100%); }
  `}),ue=({isShaking:t})=>e.jsxs("div",{className:`absolute inset-0 overflow-hidden pointer-events-none z-0 ${t?"animate-shake bg-red-900/20":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:[...Array(20)].map((a,s)=>{const r=Object.keys(B),p=B[r[s%r.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(p,{size:32})},s)})}),e.jsx("style",{children:`
      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
      }
      .animate-float { animation: float infinite ease-in-out; }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
      .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    `})]}),B={WOOD:{id:"WOOD",color:"bg-amber-800",border:"border-amber-950",icon:Ns,name:"Log",validOn:["EMPTY","WOOD"],scoreType:"TREE"},LEAF:{id:"LEAF",color:"bg-emerald-500",border:"border-emerald-700",icon:ss,name:"Foliage",validOn:["EMPTY","WOOD"],scoreType:"TREE"},STONE:{id:"STONE",color:"bg-slate-400",border:"border-slate-600",icon:zs,name:"Stone",validOn:["EMPTY","STONE"],scoreType:"MOUNTAIN"},WATER:{id:"WATER",color:"bg-cyan-500",border:"border-cyan-700",icon:Es,name:"Water",validOn:["EMPTY"],scoreType:"RIVER"},SAND:{id:"SAND",color:"bg-yellow-400",border:"border-yellow-600",icon:cs,name:"Sand",validOn:["EMPTY"],scoreType:"FIELD"},BRICK:{id:"BRICK",color:"bg-red-700",border:"border-red-900",icon:js,name:"Brick",validOn:["EMPTY","BRICK","STONE","WOOD"],scoreType:"BUILDING"}},A=(t,a)=>[{q:t+1,r:a},{q:t+1,r:a-1},{q:t,r:a-1},{q:t-1,r:a},{q:t-1,r:a+1},{q:t,r:a+1}],G=t=>{if(!t||t.stack.length!==2)return!1;const a=t.stack[1],s=t.stack[0];return a==="BRICK"&&["BRICK","STONE","WOOD"].includes(s)},l=(t,a)=>!t||t.stack.length!==a.length?!1:t.stack.every((s,r)=>s===a[r]),C=(t,a,s,r)=>A(a,s).some(x=>{const b=t[`${x.q},${x.r}`];return b&&r(b)}),Bs=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],W=(t,a,s,r)=>Bs.some(p=>r.every((x,b)=>{const w=a+p.q*(b+1),j=s+p.r*(b+1),v=t[`${w},${j}`];return v&&x(v)})),_={SQUIRREL:{id:"SQUIRREL",name:"Squirrel",desc:"Small Tree (1 Wood + 1 Leaf)",points:[3,3,4],slots:3,icon:st,iconColor:"text-orange-500",visual:{type:"stack",tokens:["WOOD","LEAF"]},check:t=>l(t,["WOOD","LEAF"])},LIZARD:{id:"LIZARD",name:"Lizard",desc:"1 Stone next to Bush (1 Leaf)",points:[3,3,3,4],slots:4,icon:Se,iconColor:"text-emerald-400",visual:{type:"adj",main:["STONE"],others:[["LEAF"]]},check:(t,a)=>l(t,["STONE"])&&C(a,t.q,t.r,s=>l(s,["LEAF"]))},SNAIL:{id:"SNAIL",name:"Snail",desc:"1 Stone next to 1 Water",points:[3,3,3,4],slots:4,icon:Je,iconColor:"text-lime-300",visual:{type:"adj",main:["STONE"],others:[["WATER"]]},check:(t,a)=>l(t,["STONE"])&&C(a,t.q,t.r,s=>l(s,["WATER"]))},HERON:{id:"HERON",name:"Heron",desc:"1 Water next to Bush (1 Leaf)",points:[3,3,3,4],slots:4,icon:te,iconColor:"text-cyan-300",visual:{type:"adj",main:["WATER"],others:[["LEAF"]]},check:(t,a)=>l(t,["WATER"])&&C(a,t.q,t.r,s=>l(s,["LEAF"]))},DUCK:{id:"DUCK",name:"Duck",desc:"1 Water next to 1 Wood",points:[3,3,3,4],slots:4,icon:et,iconColor:"text-green-600",visual:{type:"adj",main:["WATER"],others:[["WOOD"]]},check:(t,a)=>l(t,["WATER"])&&C(a,t.q,t.r,s=>l(s,["WOOD"]))},HAWK:{id:"HAWK",name:"Hawk",desc:"Dead Tree (3 Woods)",points:[6,7],slots:2,icon:te,iconColor:"text-red-700",visual:{type:"stack",tokens:["WOOD","WOOD","WOOD"]},check:t=>l(t,["WOOD","WOOD","WOOD"])},EAGLE:{id:"EAGLE",name:"Eagle",desc:"Highest Peak (3 Stones)",points:[3,4],slots:2,icon:rs,iconColor:"text-sky-600",visual:{type:"stack",tokens:["STONE","STONE","STONE"]},check:t=>l(t,["STONE","STONE","STONE"])},FROG:{id:"FROG",name:"Frog",desc:"Bush (1 Leaf) next to 1 Water",points:[3,3,3,4],slots:4,icon:ps,iconColor:"text-lime-500",visual:{type:"adj",main:["LEAF"],others:[["WATER"]]},check:(t,a)=>l(t,["LEAF"])&&C(a,t.q,t.r,s=>l(s,["WATER"]))},BEAVER:{id:"BEAVER",name:"Beaver",desc:"1 Wood next to 1 Water AND Small Tree",points:[4,5,5],slots:3,icon:Se,iconColor:"text-amber-800",visual:{type:"adj",main:["WOOD"],others:[["WATER"],["WOOD","LEAF"]]},check:(t,a)=>{if(!l(t,["WOOD"]))return!1;const s=A(t.q,t.r).map(x=>a[`${x.q},${x.r}`]),r=s.some(x=>l(x,["WATER"])),p=s.some(x=>x&&l(x,["WOOD","LEAF"]));return r&&p}},TURTLE:{id:"TURTLE",name:"Turtle",desc:"1 Water next to 1 Sand AND 1 Stone",points:[4,4,5],slots:3,icon:Qt,iconColor:"text-teal-600",visual:{type:"adj",main:["WATER"],others:[["SAND"],["STONE"]]},check:(t,a)=>{if(!l(t,["WATER"]))return!1;const s=A(t.q,t.r).map(r=>a[`${r.q},${r.r}`]);return s.some(r=>l(r,["SAND"]))&&s.some(r=>l(r,["STONE"]))}},HEDGEHOG:{id:"HEDGEHOG",name:"Hedgehog",desc:"1 Sand next to 1 Wood AND Bush(1 Leaf)",points:[4,4,5],slots:3,icon:Ze,iconColor:"text-blue-600",visual:{type:"adj",main:["SAND"],others:[["LEAF"],["WOOD"]]},check:(t,a)=>{if(!l(t,["SAND"]))return!1;const s=A(t.q,t.r).map(r=>a[`${r.q},${r.r}`]);return s.some(r=>r&&l(r,["LEAF"]))&&s.some(r=>r&&l(r,["WOOD"]))}},SHELL:{id:"SHELL",name:"Shell",desc:"1 Sand next to 1 Water AND 1 Stone",points:[4,4,5],slots:3,icon:Vt,iconColor:"text-red-600",visual:{type:"adj",main:["SAND"],others:[["WATER"],["STONE"]]},check:(t,a)=>{if(!l(t,["SAND"]))return!1;const s=A(t.q,t.r).map(r=>a[`${r.q},${r.r}`]);return s.some(r=>l(r,["WATER"]))&&s.some(r=>l(r,["STONE"]))}},BOAR:{id:"BOAR",name:"Boar",desc:"1 Sand next to 1 Water AND Small Tree",points:[4,5,5],slots:3,icon:Ws,iconColor:"text-amber-900",visual:{type:"adj",main:["SAND"],others:[["WATER"],["WOOD","LEAF"]]},check:(t,a)=>{if(!l(t,["SAND"]))return!1;const s=A(t.q,t.r).map(r=>a[`${r.q},${r.r}`]);return s.some(r=>l(r,["WATER"]))&&s.some(r=>r&&l(r,["WOOD","LEAF"]))}},ANTS:{id:"ANTS",name:"Ants",desc:"1 Sand next to Bush(1 Leaf) AND Small Tree",points:[4,5,5],slots:3,icon:as,iconColor:"text-amber-600",visual:{type:"adj",main:["SAND"],others:[["LEAF"],["WOOD","LEAF"]]},check:(t,a)=>{if(!l(t,["SAND"]))return!1;const s=A(t.q,t.r).map(r=>a[`${r.q},${r.r}`]);return s.some(r=>r&&l(r,["LEAF"]))&&s.some(r=>r&&l(r,["WOOD","LEAF"]))}},FOX:{id:"FOX",name:"Fox",desc:"Medium Rock (2 Stones) next to Medium Log (2 Woods)",points:[4,5,5],slots:3,icon:me,iconColor:"text-orange-600",visual:{type:"adj",main:["STONE","STONE"],others:[["WOOD","WOOD"]]},check:(t,a)=>l(t,["STONE","STONE"])&&C(a,t.q,t.r,s=>l(s,["WOOD","WOOD"]))},DEER:{id:"DEER",name:"Deer",desc:"Tall Tree next to 1 Sand",points:[4,4,5],slots:3,icon:ws,iconColor:"text-amber-600",visual:{type:"adj",main:["SAND"],others:[["WOOD","WOOD","LEAF"]]},check:(t,a)=>l(t,["SAND"])&&C(a,t.q,t.r,s=>l(s,["WOOD","WOOD","LEAF"]))},BEAR:{id:"BEAR",name:"Bear",desc:"Tall Tree next to Medium Rock (2 Stones)",points:[5,5,6],slots:3,icon:tt,iconColor:"text-amber-800",visual:{type:"adj",main:["STONE","STONE"],others:[["WOOD","WOOD","LEAF"]]},check:(t,a)=>l(t,["STONE","STONE"])&&C(a,t.q,t.r,s=>l(s,["WOOD","WOOD","LEAF"]))},PANDA:{id:"PANDA",name:"Panda",desc:"Tall Tree next to 1 Water",points:[6,7],slots:2,icon:tt,iconColor:"text-red-300",visual:{type:"adj",main:["WOOD","WOOD","LEAF"],others:[["WATER"]]},check:(t,a)=>l(t,["WOOD","WOOD","LEAF"])&&C(a,t.q,t.r,s=>l(s,["WATER"]))},SCORPION:{id:"SCORPION",name:"Scorpion",desc:"Medium Rock (2 Stones) next to 1 Sand",points:[4,4,5],slots:3,icon:Je,iconColor:"text-rose-600",visual:{type:"adj",main:["STONE","STONE"],others:[["SAND"]]},check:(t,a)=>l(t,["STONE","STONE"])&&C(a,t.q,t.r,s=>l(s,["SAND"]))},BEE:{id:"BEE",name:"Bee",desc:"Bush (1 Leaf) next to 2 other Bushes",points:[3,4,5],slots:3,icon:ts,iconColor:"text-yellow-400",visual:{type:"adj",main:["LEAF"],others:[["LEAF"],["LEAF"]]},check:(t,a)=>{if(!l(t,["LEAF"]))return!1;let s=0;return A(t.q,t.r).forEach(r=>{const p=a[`${r.q},${r.r}`];p&&l(p,["LEAF"])&&s++}),s>=2}},WOLF:{id:"WOLF",name:"Wolf",desc:"Small Tree next to 2 other Small Trees",points:[6,7],slots:2,icon:Ds,iconColor:"text-orange-500",visual:{type:"adj",main:["WOOD","LEAF"],others:[["WOOD","LEAF"],["WOOD","LEAF"]]},check:(t,a)=>{if(!l(t,["WOOD","LEAF"]))return!1;let s=0;return A(t.q,t.r).forEach(r=>{const p=a[`${r.q},${r.r}`];p&&l(p,["WOOD","LEAF"])&&s++}),s>=2}},SALMON:{id:"SALMON",name:"Salmon",desc:"1 Water next to 2 other Water",points:[3,4,4,4],slots:4,icon:Zt,iconColor:"text-rose-400",visual:{type:"adj",main:["WATER"],others:[["WATER"],["WATER"]]},check:(t,a)=>{if(!l(t,["WATER"]))return!1;let s=0;return A(t.q,t.r).forEach(r=>{l(a[`${r.q},${r.r}`],["WATER"])&&s++}),s>=2}},RABBIT:{id:"RABBIT",name:"Rabbit",desc:"1 Sand next to 2 Bushes",points:[3,4,5,5],slots:4,icon:Ze,iconColor:"text-fuchsia-300",visual:{type:"adj",main:["SAND"],others:[["LEAF"],["LEAF"]]},check:(t,a)=>{if(!l(t,["SAND"]))return!1;let s=0;return A(t.q,t.r).forEach(r=>{const p=a[`${r.q},${r.r}`];p&&l(p,["LEAF"])&&s++}),s>=2}},PENGUIN:{id:"PENGUIN",name:"Penguin",desc:"1 Stone next to 2 Waters",points:[3,4,5,5],slots:4,icon:te,iconColor:"text-cyan-300",visual:{type:"adj",main:["STONE"],others:[["WATER"],["WATER"]]},check:(t,a)=>{if(!l(t,["STONE"]))return!1;let s=0;return A(t.q,t.r).forEach(r=>{const p=a[`${r.q},${r.r}`];l(p,["WATER"])&&s++}),s>=2}},MOLE:{id:"MOLE",name:"Mole",desc:"1 Stone next to 2 Sands",points:[3,4,5,5],slots:4,icon:Se,iconColor:"text-amber-700",visual:{type:"adj",main:["STONE"],others:[["SAND"],["SAND"]]},check:(t,a)=>{if(!l(t,["STONE"]))return!1;let s=0;return A(t.q,t.r).forEach(r=>{const p=a[`${r.q},${r.r}`];l(p,["SAND"])&&s++}),s>=2}},BAT:{id:"BAT",name:"Bat",desc:"Building next to 1 Water",points:[4,4,5],slots:3,icon:es,iconColor:"text-violet-400",visual:{type:"adj",main:["BRICK","BRICK"],others:[["WATER"]]},check:(t,a)=>G(t)&&C(a,t.q,t.r,s=>l(s,["WATER"]))},CAT:{id:"CAT",name:"Cat",desc:"Building next to 2 Sands",points:[5,6],slots:2,icon:me,iconColor:"text-yellow-600",visual:{type:"adj",main:["BRICK","BRICK"],others:[["SAND"],["SAND"]]},check:(t,a)=>{if(!G(t))return!1;let s=0;return A(t.q,t.r).forEach(r=>{const p=a[`${r.q},${r.r}`];l(p,["SAND"])&&s++}),s>=2}},OWL:{id:"OWL",name:"Owl",desc:"Tall Tree next to Building",points:[6,7],slots:2,icon:fe,iconColor:"text-indigo-400",visual:{type:"adj",main:["WOOD","WOOD","LEAF"],others:[["BRICK","BRICK"]]},check:(t,a)=>l(t,["WOOD","WOOD","LEAF"])&&C(a,t.q,t.r,s=>G(s))},SPIDER:{id:"SPIDER",name:"Spider",desc:"Dead Tree (3 Woods) next to Building",points:[7,8],slots:2,icon:Xe,iconColor:"text-red-900",visual:{type:"adj",main:["WOOD","WOOD","WOOD"],others:[["BRICK","BRICK"]]},check:(t,a)=>l(t,["WOOD","WOOD","WOOD"])&&C(a,t.q,t.r,s=>G(s))},CATERPILLAR:{id:"CATERPILLAR",name:"Caterpillar",desc:"Line: Leaf -> Leaf -> Leaf",points:[4,4,5],slots:3,icon:at,iconColor:"text-lime-600",visual:{type:"line",sequence:[["LEAF"],["LEAF"],["LEAF"]]},check:(t,a)=>l(t,["LEAF"])?W(a,t.q,t.r,[s=>l(s,["LEAF"]),s=>l(s,["LEAF"])]):!1},SNAKE:{id:"SNAKE",name:"Snake",desc:"Line: Bush -> Bush -> Stone",points:[4,5],slots:2,icon:at,iconColor:"text-emerald-500",visual:{type:"line",sequence:[["LEAF"],["LEAF"],["STONE"]]},check:(t,a)=>l(t,["LEAF"])?W(a,t.q,t.r,[s=>l(s,["LEAF"]),s=>l(s,["STONE"])]):!1},CAMEL:{id:"CAMEL",name:"Camel",desc:"Line: Sand -> Sand -> Stone",points:[4,5],slots:2,icon:Jt,iconColor:"text-amber-400",visual:{type:"line",sequence:[["SAND"],["SAND"],["STONE"]]},check:(t,a)=>l(t,["SAND"])?W(a,t.q,t.r,[s=>l(s,["SAND"]),s=>l(s,["STONE"])]):!1},RHINO:{id:"RHINO",name:"Rhino",desc:"Line: Stone -> Stone -> Field",points:[4,5],slots:2,icon:bs,iconColor:"text-stone-400",visual:{type:"line",sequence:[["STONE"],["STONE"],["SAND"]]},check:(t,a)=>l(t,["STONE"])?W(a,t.q,t.r,[s=>l(s,["STONE"]),s=>l(s,["SAND"])]):!1},SWAN:{id:"SWAN",name:"Swan",desc:"Line: Water -> Water -> Leaf",points:[4,5],slots:2,icon:et,iconColor:"text-pink-400",visual:{type:"line",sequence:[["WATER"],["WATER"],["LEAF"]]},check:(t,a)=>l(t,["WATER"])?W(a,t.q,t.r,[s=>l(s,["WATER"]),s=>l(s,["LEAF"])]):!1},CRANE:{id:"CRANE",name:"Crane",desc:"Line: Water -> Wood -> Water",points:[4,4],slots:2,icon:te,iconColor:"text-red-400",visual:{type:"line",sequence:[["WATER"],["WOOD"],["WATER"]]},check:(t,a)=>l(t,["WATER"])?W(a,t.q,t.r,[s=>l(s,["WOOD"]),s=>l(s,["WATER"])]):!1},OCTOPUS:{id:"OCTOPUS",name:"Octopus",desc:"Line: Water -> Stone -> Water",points:[4,4],slots:2,icon:Xe,iconColor:"text-indigo-600",visual:{type:"line",sequence:[["WATER"],["STONE"],["WATER"]]},check:(t,a)=>l(t,["WATER"])?W(a,t.q,t.r,[s=>l(s,["STONE"]),s=>l(s,["WATER"])]):!1},MONKEY:{id:"MONKEY",name:"Monkey",desc:"Line: Small Tree -> Tall Tree",points:[5,6],slots:2,icon:st,iconColor:"text-amber-500",visual:{type:"line",sequence:[["WOOD","LEAF"],["WOOD","WOOD","LEAF"]]},check:(t,a)=>l(t,["WOOD","LEAF"])?W(a,t.q,t.r,[s=>l(s,["WOOD","WOOD","LEAF"])]):!1},COUGAR:{id:"COUGAR",name:"Cougar",desc:"Line: Medium Rock -> Highest Peak",points:[5,6],slots:2,icon:me,iconColor:"text-red-600",visual:{type:"line",sequence:[["STONE","STONE"],["STONE","STONE","STONE"]]},check:(t,a)=>l(t,["STONE","STONE"])?W(a,t.q,t.r,[s=>l(s,["STONE","STONE","STONE"])]):!1},KINGFISHER:{id:"KINGFISHER",name:"Kingfisher",desc:"Line: Small Tree -> Water -> Small Tree",points:[5,5],slots:2,icon:te,iconColor:"text-cyan-500",visual:{type:"line",sequence:[["WOOD","LEAF"],["WATER"],["WOOD","LEAF"]]},check:(t,a)=>l(t,["WOOD","LEAF"])?W(a,t.q,t.r,[s=>l(s,["WATER"]),s=>l(s,["WOOD","LEAF"])]):!1},ELEPHANT:{id:"ELEPHANT",name:"Elephant",desc:"Line: Sand -> Small Tree -> Water",points:[5,5],slots:2,icon:xs,iconColor:"text-pink-400",visual:{type:"line",sequence:[["SAND"],["WOOD","LEAF"],["WATER"]]},check:(t,a)=>l(t,["SAND"])?W(a,t.q,t.r,[s=>l(s,["WOOD","LEAF"]),s=>l(s,["WATER"])]):!1},GIRAFFE:{id:"GIRAFFE",name:"Giraffe",desc:"Line: Small Tree -> Bush -> Building",points:[6,7],slots:2,icon:Xt,iconColor:"text-yellow-600",visual:{type:"line",sequence:[["WOOD","LEAF"],["LEAF"],["BRICK","BRICK"]]},check:(t,a)=>l(t,["WOOD","LEAF"])?W(a,t.q,t.r,[s=>l(s,["LEAF"]),s=>G(s)]):!1},TIGER:{id:"TIGER",name:"Tiger",desc:"Line: Bush -> Tall Tree -> Bush",points:[5,5],slots:2,icon:me,iconColor:"text-orange-500",visual:{type:"line",sequence:[["LEAF"],["WOOD","WOOD","LEAF"],["LEAF"]]},check:(t,a)=>l(t,["LEAF"])?W(a,t.q,t.r,[s=>l(s,["WOOD","WOOD","LEAF"]),s=>l(s,["LEAF"])]):!1},PEACOCK:{id:"PEACOCK",name:"Peacock",desc:"Line: Small Tree -> Building ->Small Tree",points:[6,7],slots:2,icon:Os,iconColor:"text-purple-500",visual:{type:"line",sequence:[["WOOD","LEAF"],["BRICK","BRICK"],["WOOD","LEAF"]]},check:(t,a)=>l(t,["WOOD","LEAF"])?W(a,t.q,t.r,[s=>G(s),s=>l(s,["WOOD","LEAF"])]):!1},GOAT:{id:"GOAT",name:"Goat",desc:"Highest Peak (3 Stones) next to another Stone",points:[4,5,5],slots:3,icon:Re,iconColor:"text-orange-400",visual:{type:"adj",main:["STONE"],others:[["STONE","STONE","STONE"]]},check:(t,a)=>l(t,["STONE"])&&C(a,t.q,t.r,s=>l(s,["STONE","STONE","STONE"]))},HORSE:{id:"HORSE",name:"Horse",desc:"1 Sand next to 1 Sand AND Tall Tree",points:[4,5,5],slots:3,icon:Yt,iconColor:"text-red-400",visual:{type:"adj",main:["SAND"],others:[["SAND"],["WOOD","WOOD","LEAF"]]},check:(t,a)=>{if(!l(t,["SAND"]))return!1;const s=A(t.q,t.r).map(r=>a[`${r.q},${r.r}`]);return s.some(r=>l(r,["SAND"]))&&s.some(r=>r&&l(r,["WOOD","WOOD","LEAF"]))}}},nt=(t,a)=>{if(!t||t.animal||t.stack.length>=3||a==="BRICK"&&t.stack.length>=2||t.stack.length>=2&&t.stack[t.stack.length-1]==="BRICK")return!1;const s=t.stack.length>0?t.stack[t.stack.length-1]:"EMPTY";return B[a].validOn.includes(s)},Ps=t=>{let a={trees:0,mountains:0,fields:0,rivers:0,buildings:0};const s=new Set,r=Object.values(t);return r.forEach(x=>{const b=x.stack.length;if(b===0)return;const w=x.stack[b-1],j=x.stack[0];w!=="BRICK"&&w!=="WOOD"&&w==="LEAF"&&(b===1?a.trees+=1:j==="WOOD"&&(b===2?a.trees+=3:b===3&&(a.trees+=7)))}),r.forEach(x=>{const b=x.stack.length;x.stack[0]==="STONE"&&x.stack[b-1]==="STONE"&&A(x.q,x.r).some(v=>{const n=t[`${v.q},${v.r}`];return n&&n.stack.length>0&&n.stack[n.stack.length-1]==="STONE"})&&(b===1?a.mountains+=1:b===2?a.mountains+=3:b>=3&&(a.mountains+=7))}),s.clear(),r.forEach(x=>{if(x.stack[0]==="SAND"&&!s.has(`${x.q},${x.r}`)){let b=0,w=[x];for(s.add(`${x.q},${x.r}`);w.length>0;){const j=w.pop();b++,A(j.q,j.r).forEach(v=>{const n=t[`${v.q},${v.r}`],$=`${v.q},${v.r}`;n&&n.stack[0]==="SAND"&&!s.has($)&&(s.add($),w.push(n))})}b>=2&&(a.fields+=5)}}),s.clear(),r.forEach(x=>{if(x.stack[0]==="WATER"&&!s.has(`${x.q},${x.r}`)){let b=0,w=[x];for(s.add(`${x.q},${x.r}`);w.length>0;){const j=w.pop();b++,A(j.q,j.r).forEach(v=>{const n=t[`${v.q},${v.r}`],$=`${v.q},${v.r}`;n&&n.stack[0]==="WATER"&&!s.has($)&&(s.add($),w.push(n))})}b===2?a.rivers+=2:b===3?a.rivers+=5:b===4?a.rivers+=8:b===5?a.rivers+=11:b===6?a.rivers+=15:b>6&&(a.rivers+=15+(b-6)*4)}}),r.forEach(x=>{if(G(x)){const b=A(x.q,x.r),w=new Set;b.forEach(j=>{const v=t[`${j.q},${j.r}`];if(v&&v.stack.length>0){const n=v.stack[v.stack.length-1];n!=="BRICK"&&w.add(n)}}),w.size>=3&&(a.buildings+=5)}}),{total:Object.values(a).reduce((x,b)=>x+b,0),breakdown:a}},De=()=>{const t={};return[{r:-2,qStart:-1,qEnd:3},{r:-1,qStart:-1,qEnd:2},{r:0,qStart:-2,qEnd:2},{r:1,qStart:-2,qEnd:1},{r:2,qStart:-3,qEnd:1}].forEach(({r:s,qStart:r,qEnd:p})=>{for(let x=r;x<=p;x++)t[`${x},${s}`]={q:x,r:s,stack:[],animal:null}}),t},lt=()=>{const t={WOOD:21,LEAF:19,STONE:23,WATER:23,SAND:19,BRICK:15};let a=[];Object.entries(t).forEach(([s,r])=>{for(let p=0;p<r;p++)a.push(s)});for(let s=a.length-1;s>0;s--){const r=Math.floor(Math.random()*(s+1));[a[s],a[r]]=[a[r],a[s]]}return a},ot=()=>{let t=Object.keys(_);for(let a=t.length-1;a>0;a--){const s=Math.floor(Math.random()*(a+1));[t[a],t[s]]=[t[s],t[a]]}return t},it=(t,a)=>{let s=[...t],r=[...a];for(;s.length<5&&r.length>=3;)s.push({id:Math.random().toString(36).substr(2,9),tokens:[r.pop(),r.pop(),r.pop()].filter(Boolean)});return{market:s,bag:r}},dt=(t,a)=>{let s=[...t],r=[...a];for(;s.length<5&&r.length>0;){const p=r.pop();s.push({id:Math.random().toString(36).substr(2,9),type:p})}return{market:s,deck:r}},he=({tokens:t,scale:a=1.2,spacing:s=8})=>e.jsx("div",{className:"relative w-8 h-12 mx-auto",style:{transform:`scale(${a})`,height:`${t.length*s+24}px`},children:t.map((r,p)=>e.jsx("div",{className:`absolute left-1/2 -translate-x-1/2 w-6 h-6 rounded-full border shadow-sm ${B[r].color} ${B[r].border} flex items-center justify-center`,style:{bottom:`${p*s}px`,zIndex:p},children:p===t.length-1&&(()=>{const x=B[r].icon;return e.jsx(x,{size:12,className:"text-white/70"})})()},p))}),se=({visual:t})=>t?t.type==="stack"?e.jsx(he,{tokens:t.tokens,spacing:8}):t.type==="adj"?e.jsxs("div",{className:"flex -mt-3 items-center justify-center gap-2",children:[e.jsxs("div",{className:"relative z-10 rounded-xl p-1",children:[e.jsx(he,{tokens:Array.isArray(t.main)?t.main:[t.main],scale:1.2,spacing:8}),e.jsx("div",{className:"absolute -top-2 w-3 h-3 bg-white rounded-full flex items-center justify-center border border-slate-500 shadow",children:e.jsx("div",{className:"w-1 h-1 bg-slate-900 rounded-full"})})]}),e.jsx("div",{className:"flex items-center flex-col gap-2",children:t.others.map((a,s)=>e.jsx("div",{className:"origin-bottom",children:e.jsx(he,{tokens:Array.isArray(a)?a:[a],scale:1.2,spacing:8})},s))})]}):t.type==="line"?e.jsx("div",{className:"flex -mt-3 items-center justify-center gap-1 py-4",children:t.sequence.map((a,s)=>e.jsx(_t.Fragment,{children:e.jsxs("div",{className:`relative ${s===0?"z-10 scale-100":"scale-100"}`,children:[s===0&&e.jsx("div",{className:"absolute center -top-2 w-3 h-3 bg-white rounded-full flex items-center justify-center border border-slate-500 shadow z-20",children:e.jsx("div",{className:"w-1 h-1 bg-slate-900 rounded-full"})}),e.jsx(he,{tokens:Array.isArray(a)?a:[a],scale:1.2,spacing:8})]})},s))}):null:null,Le=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(ae,{size:12,className:"text-emerald-400"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-emerald-400 uppercase",children:"EQUILIBRIUM"})]}),ct=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(ae,{size:20,className:"text-emerald-400"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-emerald-400 uppercase",children:"EQUILIBRIUM"})]}),Hs=({q:t,r:a,stack:s,animal:r,onClick:p,ghostToken:x,isPlaceable:b,ghostAnimal:w,isValidTarget:j})=>{const n=44*(Math.sqrt(3)*t+Math.sqrt(3)/2*a),$=44*(3/2*a);return e.jsxs("div",{onClick:()=>p&&p(t,a),className:"absolute flex items-center justify-center transition-all duration-300",style:{left:`calc(50% + ${n}px)`,top:`calc(50% + ${$}px)`,width:`${44*1.8}px`,height:"88px",transform:"translate(-50%, -50%)",zIndex:10+a,cursor:b||w?"pointer":"default"},children:[e.jsx("div",{className:`w-full h-full absolute transition-all duration-300 ${j?"bg-emerald-500/60 hover:bg-emerald-400/70 hover:scale-110 shadow-[0_0_30px_rgba(16,185,129,0.6)] z-10":b||w?"bg-slate-700/80 hover:bg-slate-600 hover:scale-105 shadow-[0_0_15px_rgba(52,211,153,0.3)]":"bg-slate-800/90"}`,style:{clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)",zIndex:0}}),e.jsx("svg",{viewBox:"0 0 100 100",className:"absolute inset-0 pointer-events-none z-10 overflow-visible",style:{width:"100%",height:"100%"},children:e.jsx("polygon",{points:"50 0, 100 25, 100 75, 50 100, 0 75, 0 25",fill:"none",stroke:j?"#10b981":"rgba(255,255,255,0.4)",strokeWidth:j?"4":"1.5",strokeDasharray:"4 2",className:j?"animate-pulse":""})}),e.jsxs("div",{className:"relative z-20 flex items-center justify-center w-full h-full pb-2 pointer-events-none",children:[s.map((R,E)=>{const U=B[R];return e.jsx("div",{className:`absolute w-10 h-10 rounded-full border-2 shadow-xl flex items-center justify-center ${U.color} ${U.border}`,style:{transform:`translateY(-${E*8}px) scale(${1-E*.02})`,zIndex:E},children:E===s.length-1&&e.jsx(U.icon,{size:16,className:"text-white/80"})},E)}),b&&x&&e.jsx("div",{className:`absolute w-10 h-10 rounded-full border-2 border-dashed opacity-60 flex items-center justify-center animate-pulse ${B[x].color} border-white`,style:{transform:`translateY(-${s.length*8}px)`,zIndex:10},children:e.jsx(os,{size:16,className:"text-white"})}),j&&!r&&e.jsx("div",{className:"absolute -top-8 w-10 h-10 rounded-full border-4 border-emerald-400 bg-emerald-900 shadow-xl flex items-center justify-center z-50 animate-bounce",children:e.jsx(We,{size:24,className:"text-emerald-400"})}),w&&!r&&e.jsx("div",{className:"absolute -top-8 w-8 h-8 rounded-full border-2 border-dashed border-white shadow-xl flex items-center justify-center z-50 animate-pulse opacity-70",children:(()=>{const R=_[w];if(!R)return null;const E=R.icon;return e.jsx(E,{size:16,className:R.iconColor,fill:"currentColor",fillOpacity:.2})})()}),r&&e.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-white border-2 border-emerald-500 shadow-[0_0_10px_rgba(0,0,0,0.5)] flex items-center justify-center z-50 animate-in zoom-in duration-300",style:{transform:`translateY(-${s.length*8+6}px)`},children:(()=>{const R=_[r];if(!R)return e.jsx("div",{className:"text-black text-[8px]",children:"?"});const E=R.icon;return e.jsx(E,{size:18,className:R.iconColor,fill:"currentColor",fillOpacity:.2})})()})]})]})},Ks=({type:t,message:a,subtext:s,icon:r})=>e.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center pointer-events-none animate-in fade-in zoom-in duration-300",children:e.jsxs("div",{className:`flex flex-col items-center justify-center p-8 md:p-12 rounded-3xl border-4 shadow-2xl backdrop-blur-xl max-w-sm md:max-w-xl mx-4 text-center ${t==="success"?"bg-emerald-900/90 border-emerald-500 text-emerald-100":t==="failure"?"bg-red-900/90 border-red-500 text-red-100":t==="warning"?"bg-amber-900/90 border-amber-500 text-amber-100":"bg-blue-900/90 border-blue-500 text-blue-100"}`,children:[r&&e.jsx("div",{className:"mb-4 p-4 bg-black/20 rounded-full",children:e.jsx(r,{size:64,className:"animate-bounce"})}),e.jsx("h2",{className:"text-3xl md:text-5xl font-black uppercase tracking-widest drop-shadow-md mb-2",children:a}),s&&e.jsx("p",{className:"text-lg md:text-xl font-bold opacity-90 tracking-wide",children:s})]})}),Ce=({onClose:t})=>e.jsx("div",{className:"fixed inset-0 z-[200] bg-slate-950/95 backdrop-blur-md flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-emerald-900/50 w-full max-w-3xl rounded-3xl shadow-2xl p-6 relative max-h-[90vh] overflow-y-auto custom-scrollbar",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 bg-slate-800 rounded-full hover:bg-slate-700 transition-colors",children:e.jsx(Ie,{size:24})}),e.jsx("h2",{className:"text-3xl font-black text-center mb-6 text-emerald-400",children:"Architect's Handbook"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(ae,{className:"text-emerald-500"})," Landscape Scoring"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-slate-300",children:[e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-emerald-900/30",children:[e.jsx("strong",{className:"text-emerald-400 block mb-1",children:"Trees (Wood + Leaf)"}),e.jsxs("ul",{className:"list-disc pl-4 text-xs space-y-1",children:[e.jsx("li",{children:"Bush (1 Leaf): 1 Pt"}),e.jsx("li",{children:"Small Tree (1 Wood + 1 Leaf): 3 Pts"}),e.jsx("li",{children:"Tall Tree (2 Wood + 1 Leaf): 7 Pts"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-emerald-900/30",children:[e.jsx("strong",{className:"text-slate-400 block mb-1",children:"Mountains (Stone)"}),e.jsxs("ul",{className:"list-disc pl-4 text-xs space-y-1",children:[e.jsx("li",{children:"Only scores if adjacent to at least one other Mountain stack. The more the better."}),e.jsx("li",{children:"Height of Mountain (1=1pt, 2=3pts, 3=7pts)"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-emerald-900/30",children:[e.jsx("strong",{className:"text-yellow-400 block mb-1",children:"Fields (Sand)"}),e.jsxs("ul",{className:"list-disc pl-4 text-xs space-y-1",children:[e.jsx("li",{children:"5 Pts for every distinct group of 2+ connected Sands."}),e.jsx("li",{children:"No matter how long the chain is, only disjointed groups score points."})]})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-emerald-900/30",children:[e.jsx("strong",{className:"text-cyan-400 block mb-1",children:"Rivers (Water)"}),e.jsxs("ul",{className:"list-disc pl-4 text-xs space-y-1",children:[e.jsx("li",{children:"Make chain to score big. The longer the better."}),e.jsx("li",{children:"Length of River chain (2=2pts, 3=5pts, 4=8pts, 5=11pts, 6+ = +4pts for each)"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl md:col-span-2 border border-emerald-900/30",children:[e.jsx("strong",{className:"text-red-400 block mb-1",children:"Buildings (Brick)"}),e.jsxs("ul",{className:"list-disc pl-4 text-xs space-y-1",children:[e.jsx("li",{children:"5 Pts for each Building if surrounded by 3+ distinct token types (Except Brick)."}),e.jsx("li",{children:"Wooden House (1 Wood + 1 Brick)"}),e.jsx("li",{children:"Stoned House(1 Stone + 1 Brick)"}),e.jsx("li",{children:"Brick House(1 Brick + 1 Brick)"}),e.jsx("li",{children:"All of them are considered as Building."})]})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(pe,{className:"text-orange-500"})," Animal Scoring"]}),e.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Draft animals to your hand. When you create their pattern on the board, select the animal to place it!"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.values(_).map(a=>{const s=a.icon;return e.jsxs("div",{className:"bg-slate-800 p-3 rounded-xl border border-emerald-900/30 flex flex-col items-center gap-2 text-xs relative overflow-hidden",children:[e.jsx("div",{className:"bg-black/30 p-2 rounded-full mb-1",children:e.jsx(s,{size:20,className:a.iconColor})}),e.jsx("div",{className:"scale-75 mb-2",children:e.jsx(se,{visual:a.visual})}),e.jsxs("div",{className:"text-center z-10",children:[e.jsx("div",{className:"font-bold text-white text-sm",children:a.name}),e.jsx("div",{className:"text-[10px] text-slate-400 leading-tight mb-2 h-8 overflow-hidden line-clamp-2",children:a.desc}),e.jsxs("div",{className:"text-[10px] text-yellow-500 font-bold bg-black/20 px-2 py-1 rounded-full inline-block",children:[a.points.join(" / ")," Pts"]})]})]},a.id)})})]})]}),e.jsx("div",{className:"mt-8 flex flex-col items-center gap-2",children:e.jsx("button",{onClick:t,className:"flex items-center gap-2 px-8 py-3 rounded-xl font-bold text-lg shadow-lg transition-all bg-gradient-to-br from-emerald-600 to-teal-700 text-white hover:bg-emerald-400 hover:scale-105 hover:shadow-emerald-500/20",children:"Understood"})})]})}),Gs=({gameState:t,onClose:a})=>e.jsx("div",{className:"fixed inset-0 z-[200] bg-slate-950/95 backdrop-blur-md flex items-center justify-center pt-20 pb-10 px-4",children:e.jsxs("div",{className:"bg-slate-900 border border-emerald-900/50 w-full max-w-lg rounded-3xl shadow-2xl p-6 relative flex flex-col max-h-full",children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 p-2 bg-slate-800 rounded-full hover:bg-slate-700 transition-colors z-10",children:e.jsx(Ie,{size:24})}),e.jsx("div",{className:"shrink-0 mb-6",children:e.jsxs("h2",{className:"text-2xl font-black text-center text-emerald-400 flex items-center justify-center gap-2",children:[e.jsx(xt,{})," Live Scores"]})}),e.jsx("div",{className:"space-y-4 overflow-y-auto custom-scrollbar flex-1 pr-2",children:t.players.map(s=>{const r=s.score||0,p=s.landscapeScore||0,x=(s.penalties||0)*2,b=r+p-x;return e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-slate-700 pb-2 mb-2",children:[e.jsx("span",{className:"font-bold text-lg text-white",children:s.name}),e.jsx("span",{className:"text-2xl font-black text-yellow-500",children:b})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex justify-between text-fuchsia-300",children:[e.jsx("span",{children:"Animals:"})," ",e.jsx("span",{className:"text-fuchsia-500 font-bold",children:r})]}),e.jsxs("div",{className:"flex justify-between text-green-300",children:[e.jsx("span",{children:"Trees:"})," ",e.jsx("span",{className:"text-green-500 font-bold",children:s.landscapeScoreBreakdown?.trees||0})]}),e.jsxs("div",{className:"flex justify-between text-slate-300",children:[e.jsx("span",{children:"Mountains:"})," ",e.jsx("span",{className:"text-slate-500 font-bold",children:s.landscapeScoreBreakdown?.mountains||0})]}),e.jsxs("div",{className:"flex justify-between text-yellow-300",children:[e.jsx("span",{children:"Fields:"})," ",e.jsx("span",{className:"text-yellow-500 font-bold",children:s.landscapeScoreBreakdown?.fields||0})]}),e.jsxs("div",{className:"flex justify-between text-blue-300",children:[e.jsx("span",{children:"Rivers:"})," ",e.jsx("span",{className:"text-blue-500 font-bold",children:s.landscapeScoreBreakdown?.rivers||0})]}),e.jsxs("div",{className:"flex justify-between text-red-300",children:[e.jsx("span",{children:"Buildings:"})," ",e.jsx("span",{className:"text-red-500 font-bold",children:s.landscapeScoreBreakdown?.buildings||0})]}),x>0&&e.jsxs("div",{className:"flex justify-between text-red-400 font-bold col-span-2 border-t border-slate-700 pt-1 mt-1",children:[e.jsx("span",{children:"Penalties:"})," ",e.jsxs("span",{children:["-",x]})]})]})]},s.id)})})]})}),Us=({animal:t,onClose:a})=>e.jsx("div",{className:"fixed inset-0 z-[210] bg-black/80 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:a,children:e.jsxs("div",{className:"bg-slate-900 border-2 border-slate-700 p-6 rounded-2xl max-w-sm w-full text-center shadow-2xl relative",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-slate-800 p-4 rounded-full border-4 border-slate-900",children:e.jsx(t.icon,{size:48,className:t.iconColor})}),e.jsx("h3",{className:"text-2xl font-black text-white mt-8 mb-2 uppercase",children:t.name}),e.jsxs("div",{className:"text-yellow-500 font-bold text-lg mb-4",children:["+",t.points[0]," Pts per placement"]}),e.jsx("div",{className:"flex justify-center mb-6 bg-black/20 p-4 rounded-xl",children:e.jsx(se,{visual:t.visual})}),e.jsx("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-slate-700 mb-4",children:e.jsx("p",{className:"text-slate-300 text-sm",children:t.desc})}),e.jsx("div",{className:"flex justify-center gap-1 mb-4",children:Array.from({length:t.slots}).map((s,r)=>e.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-700 border border-slate-600"},r))}),e.jsx("button",{onClick:a,className:"bg-slate-700 hover:bg-slate-600 w-full py-3 rounded-xl font-bold",children:"Close"})]})}),Ys=({onStart:t})=>{const[a,s]=N.useState(!1),[r,p]=N.useState(!1),[x,b]=N.useState(!1);return N.useEffect(()=>{const w=localStorage.getItem("equilibrium_roomId");s(!!w);const j=new Image;j.src=rt,j.onload=()=>{p(!0),setTimeout(()=>{b(!0)},2e3)}},[]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-black flex flex-col items-center justify-end pb-20 md:justify-center md:pb-0 font-sans overflow-hidden",children:[!r&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-50 text-emerald-500/50",children:[e.jsx(mt,{size:48,className:"animate-spin mb-4"}),e.jsx("div",{className:"font-mono text-xs tracking-[0.3em] animate-pulse",children:"INITIALIZING SYSTEM..."})]}),e.jsxs("div",{className:`absolute inset-0 z-0 overflow-hidden transition-opacity duration-1000 ${r?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:`w-full h-full bg-cover bg-center transition-transform duration-[2000ms] ease-out ${r?"scale-100":"scale-130"}`,style:{backgroundImage:`url(${rt})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40"})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-8 animate-in fade-in slide-in-from-bottom-10 duration-1000",children:e.jsx("div",{className:`transform transition-all duration-1000 ease-out ${x?"translate-y-0 opacity-100":"translate-y-32 opacity-0"}`,children:e.jsxs("button",{onClick:t,className:"group relative px-12 py-5 bg-emerald-600/20 hover:bg-emerald-600/40 border border-emerald-500/50 hover:border-emerald-400 text-emerald-300 font-black text-2xl tracking-widest rounded-none transform transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.4)] backdrop-blur-md overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-emerald-400/10 to-transparent translate-y-[-100%] animate-[scan_2s_infinite_linear]"}),e.jsx("span",{className:"relative z-10 flex items-center gap-3 animate-pulse",children:a?e.jsxs(e.Fragment,{children:[e.jsx(Kt,{className:"animate-spin-slow"})," RESUME"]}):e.jsxs(e.Fragment,{children:[e.jsx(Gt,{})," PLAY"]})})]})})}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Harmonies. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),"."]}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(200%); }
        }
      `})]})};function Vs(){const[t,a]=N.useState(null),[s,r]=N.useState("splash"),[p,x]=N.useState(""),[b,w]=N.useState(""),[j,v]=N.useState(""),[n,$]=N.useState(null),[R,E]=N.useState(""),[U,Y]=N.useState(!1),[ht,Fe]=N.useState(!1),[Me,ze]=N.useState(!1),[be,pt]=N.useState(!1),[ge,Z]=N.useState(!1),[ft,$e]=N.useState(!1),[qe,V]=N.useState(!1),[J,F]=N.useState(null),[je,re]=N.useState(null),[H,ye]=N.useState(null),[_e,bt]=N.useState(null),[O,ne]=N.useState(null),[z,Ne]=N.useState(null),le=N.useRef(null),[oe,Be]=N.useState(null),P=N.useRef(null),ie=d=>{P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{Be(d)},500)},Q=()=>{P.current&&clearTimeout(P.current),P.current=null,Be(null)},Pe=()=>{P.current&&clearTimeout(P.current),P.current=null},gt=()=>{if(!oe)return null;const d=_[oe.type];if(!d)return null;const i=oe.slotsFilled||0,m=oe.maxSlots||d.slots,c=i>=m;return e.jsx("div",{className:"fixed inset-0 z-[9999] pointer-events-none flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"relative w-64 h-80 bg-slate-900 border-4 rounded-3xl flex flex-col shadow-2xl overflow-hidden scale-110 md:scale-125 transition-transform border-emerald-500/50",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-white/10 bg-black/40",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d.icon,{size:24,className:d.iconColor}),e.jsx("span",{className:"text-lg font-bold text-white tracking-wide",children:d.name})]}),e.jsxs("span",{className:"text-xl font-black text-yellow-500 drop-shadow-md",children:["+",d.points.join("/")]})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-gradient-to-b from-slate-800 to-slate-950 p-4",children:[e.jsx("div",{className:"scale-150 origin-center mb-6",children:e.jsx(se,{visual:d.visual})}),e.jsx("p",{className:"text-center text-slate-300 text-sm font-medium px-4 leading-snug",children:d.desc})]}),e.jsxs("div",{className:"p-4 bg-black/20 border-t border-white/5",children:[e.jsx("div",{className:"flex gap-2 justify-center",children:Array.from({length:m}).map((g,o)=>e.jsx("div",{className:`h-3 w-full rounded-full border-2 ${o<i?"bg-emerald-500 border-emerald-400 shadow-[0_0_10px_rgba(16,185,129,0.6)]":"bg-slate-800 border-slate-600"}`},o))}),e.jsx("div",{className:"text-center mt-2 text-xs text-slate-500 uppercase font-bold tracking-widest",children:c?"Completed":"In Progress"})]})]})})},jt=()=>{const d=localStorage.getItem("equilibrium_roomId");d&&(Y(!0),v(d)),r("menu")};N.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await Ft(Te,__initial_auth_token):await Mt(Te))();const i=Rt(Te,m=>{if(a(m),m){const c=localStorage.getItem("gameHub_playerName");c&&x(c),re(m.uid)}});return()=>i()},[]),N.useEffect(()=>{const d=Ue(T(D,"game_hub_settings","config"),i=>{i.exists()&&i.data()[_s]?.maintenance?Fe(!0):Fe(!1)},i=>console.log("Config Read Error (Safe to ignore):",i));return()=>d()},[]),N.useEffect(()=>{if(!j||!t)return;const d=T(D,"artifacts",L,"public","data","rooms",j),i=Ue(d,m=>{if(m.exists()){const c=m.data();if(!c.players.some(g=>g.id===t.uid)){v(""),localStorage.removeItem("equilibrium_roomId"),r("menu"),E("You were removed from the world.");return}$(c),c.status==="playing"||c.status==="finished"?r("game"):c.status==="lobby"&&r("lobby")}else r("menu"),v(""),localStorage.removeItem("equilibrium_roomId"),E("Voyage ended.")},m=>{console.error(m),E("Connection lost.")});return()=>i()},[j,t]),N.useEffect(()=>{if(!n?.logs||n.logs.length===0)return;const d=n.logs[n.logs.length-1];if(le.current===null){le.current=d.id;return}d.id<=le.current||(le.current=d.id,d.type==="success"?(F({type:"success",message:"HARMONY!",subtext:d.text,icon:ke}),setTimeout(()=>F(null),2500)):d.type==="warning"?(F({type:"warning",message:"ATTENTION",subtext:d.text,icon:Ee}),setTimeout(()=>F(null),2500)):d.type==="failure"&&(F({type:"failure",message:"PENALTY",subtext:d.text,icon:Ee}),setTimeout(()=>F(null),2500)))},[n?.logs]);const yt=async()=>{if(!p)return E("Enter Name");localStorage.setItem("gameHub_playerName",p),Y(!0);const d="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let i="";for(let h=0;h<6;h++)i+=d.charAt(Math.floor(Math.random()*d.length));const m=lt(),c=ot(),{market:g,bag:o}=it([],m),u=dt([],c),f={roomId:i,hostId:t.uid,status:"lobby",players:[{id:t.uid,name:p,score:0,penalties:0,landscapeScore:0,landscapeScoreBreakdown:{trees:0,mountains:0,fields:0,rivers:0,buildings:0},board:De(),holding:[],animals:[],ready:!0,hasDraftedTokens:!1,hasDraftedAnimal:!1}],market:g,bag:o,animalMarket:u.market,animalDeck:u.deck,turnIndex:0,startPlayerIndex:0,isLastRound:!1,turnPhase:"PLAY",logs:[],winnerId:null};try{await zt(T(D,"artifacts",L,"public","data","rooms",i),f),v(i),localStorage.setItem("equilibrium_roomId",i),re(t.uid)}catch(h){console.error(h),E("Failed to create world.")}Y(!1)},Nt=async()=>{if(!b||!p)return E("Enter details");localStorage.setItem("gameHub_playerName",p),Y(!0);try{const d=b.toUpperCase().trim(),i=T(D,"artifacts",L,"public","data","rooms",d),m=await $t(i);if(m.exists()&&m.data().status==="lobby"){const c=m.data();if(!c.players.some(g=>g.id===t.uid)){if(c.players.length>=4){E("World is full."),Y(!1);return}const g=[...c.players,{id:t.uid,name:p,score:0,penalties:0,landscapeScore:0,landscapeScoreBreakdown:{trees:0,mountains:0,fields:0,rivers:0,buildings:0},board:De(),holding:[],animals:[],hasDraftedTokens:!1,hasDraftedAnimal:!1}];await M(i,{players:g})}v(d),localStorage.setItem("equilibrium_roomId",d),re(t.uid)}else E("Room not found or in progress")}catch(d){E(d.message)}Y(!1)},vt=async()=>{const d=n.players.length,i=Math.floor(Math.random()*d);n.players[i].name,await M(T(D,"artifacts",L,"public","data","rooms",j),{status:"playing",turnIndex:i,startPlayerIndex:i,isLastRound:!1,logs:K({text:"The ecosystem awakens.",type:"neutral",id:Date.now()})})},He=async()=>{if(j){try{const d=T(D,"artifacts",L,"public","data","rooms",j);if(n.hostId===t.uid)await qt(d);else{const i=n.players.filter(m=>m.id!==t.uid);await M(d,{players:i})}}catch{console.log("Room gone")}localStorage.removeItem("equilibrium_roomId"),v(""),r("menu"),V(!1),$(null)}},wt=async d=>{if(!(!n||n.hostId!==t.uid))try{const i=n.players.filter(m=>m.id!==d);await M(T(D,"artifacts",L,"public","data","rooms",j),{players:i,logs:K({text:"A player was removed from the world.",type:"warning",id:Date.now()})})}catch(i){console.error("Error kicking player:",i)}},Ke=async()=>{if(n.hostId!==t.uid)return;const d=lt(),i=ot(),{market:m,bag:c}=it([],d),g=dt([],i),o=n.players.map(u=>({...u,score:0,penalties:0,landscapeScore:0,landscapeScoreBreakdown:{trees:0,mountains:0,fields:0,rivers:0,buildings:0},board:De(),holding:[],animals:[],ready:!1,hasDraftedTokens:!1,hasDraftedAnimal:!1}));await M(T(D,"artifacts",L,"public","data","rooms",j),{status:"lobby",players:o,market:m,bag:c,animalMarket:g.market,animalDeck:g.deck,logs:[],winnerId:null,turnIndex:0,turnPhase:"PLAY"}),V(!1)},kt=d=>{if(!n?.isLastRound||n.status==="finished")return!1;const i=n.turnIndex,m=n.startPlayerIndex;return d===m?!1:i<m?d>=i&&d<m:d>=i||d<m},ve=async d=>{const i=H===d?null:d;if(ye(i),!n||!t)return;const m=n.players.findIndex(g=>g.id===t.uid);if(m===-1)return;const c=[...n.players];c[m].activePalette=i;try{await M(T(D,"artifacts",L,"public","data","rooms",j),{players:c})}catch(g){console.error("Error syncing palette state:",g)}},Et=async d=>{const i=n.players.findIndex(y=>y.id===t.uid);if(n.turnIndex!==i)return;const m=[...n.players],c=m[i];if(c.hasDraftedTokens)return;let g=[...n.market],o=[...n.bag],u=n.isLastRound,f=[];if(c.holding=g[d].tokens,c.hasDraftedTokens=!0,c.activePalette=null,g.splice(d,1),o.length>=3){const y={id:Math.random().toString(36).substr(2,9),tokens:[o.pop(),o.pop(),o.pop()].filter(Boolean)};g.push(y)}else u||(u=!0,f.push({text:"The Bag is empty! Finishing the round...",type:"warning",id:Date.now()}));f.push({text:`${c.name} drafted tokens.`,type:"neutral",id:Date.now()+1});const h=n.logs?[...n.logs,...f]:f;await M(T(D,"artifacts",L,"public","data","rooms",j),{players:m,market:g,bag:o,isLastRound:u,logs:h}),ye(null)},St=async d=>{const i=n.players.findIndex(y=>y.id===t.uid);if(n.turnIndex!==i)return;const m=[...n.players],c=m[i];if(c.hasDraftedAnimal||c.animals.filter(y=>y.slotsFilled<y.maxSlots).length>=4)return;let o=[...n.animalMarket],u=[...n.animalDeck];const f=o[d],h=_[f.type];if(c.animals.push({...f,slotsFilled:0,maxSlots:h.slots}),c.hasDraftedAnimal=!0,c.activePalette=null,o.splice(d,1),u.length>0){const y={id:Math.random().toString(36).substr(2,9),type:u.pop()};o.push(y)}await M(T(D,"artifacts",L,"public","data","rooms",j),{players:m,animalMarket:o,animalDeck:u,logs:K({text:`${c.name} adopted a ${h.name}.`,type:"neutral",id:Date.now()})}),ye(null)},At=async(d,i)=>{try{const m=n.players.findIndex(u=>u.id===t.uid);if(n.turnIndex!==m)return;const c=[...n.players],g=c[m],o={players:c};if(O!==null&&g.holding[O]){const u=`${d},${i}`,f=g.board[u],h=g.holding[O];if(!nt(f,h))return;f.stack.push(h),g.holding.splice(O,1),ne(null);const y=Ps(g.board);g.landscapeScore=y.total,g.landscapeScoreBreakdown=y.breakdown,!Object.values(g.board).some(q=>q.stack.length===0)&&!n.isLastRound&&(o.isLastRound=!0,o.logs||(o.logs=[]),o.logs.push({text:`${g.name}'s world is full! Finishing the round...`,type:"warning",id:Date.now()})),await M(T(D,"artifacts",L,"public","data","rooms",j),o);return}if(z!==null&&g.animals[z]){const u=g.animals[z],f=_[u.type];if(!f){console.error("Animal definition missing for type:",u.type);return}const h=g.board[`${d},${i}`];if(!h.animal&&u.slotsFilled<u.maxSlots&&f.check(h,g.board)){h.animal=u.type;const y=f.points[u.slotsFilled];u.slotsFilled+=1,g.score+=y,Ne(null),o.logs||(o.logs=[]),o.logs.push({text:`${g.name} placed a ${f.name} (+${y})!`,type:"success",id:Date.now()}),await M(T(D,"artifacts",L,"public","data","rooms",j),o)}}}catch(m){console.error("Placement error:",m),E("Something went wrong with placement. Try refreshing.")}},Ot=async()=>{const d=n.players.findIndex(c=>c.id===t.uid);if(n.turnIndex!==d)return;const i=[...n.players],m=i[d];O===null||!m.holding[O]||(m.holding.splice(O,1),m.penalties=(m.penalties||0)+1,ne(null),await M(T(D,"artifacts",L,"public","data","rooms",j),{players:i,logs:K({text:`${m.name} discarded a token (-2 pts).`,type:"failure",id:Date.now()})}))},Tt=async()=>{const d=n.players.findIndex(o=>o.id===t.uid);if(n.turnIndex!==d)return;const i=[...n.players],m=i[d];if(m.holding.length>0){F({type:"warning",message:"Place Tokens",subtext:"You must place or discard all tokens."}),setTimeout(()=>F(null),2e3);return}if(!m.hasDraftedTokens&&n.market.length>0){F({type:"warning",message:"Draft Tokens",subtext:"You must take tokens from the market."}),setTimeout(()=>F(null),2e3);return}m.hasDraftedTokens=!1,m.hasDraftedAnimal=!1;const c={players:i},g=(n.turnIndex+1)%n.players.length;n.market.length===0&&n.bag.length===0?(c.status="finished",c.logs=K({text:"Market exhausted. Game Over!",type:"warning",id:Date.now()})):n.isLastRound&&g===n.startPlayerIndex?(c.status="finished",c.logs=K({text:"Round complete. Game Over!",type:"neutral",id:Date.now()})):(c.turnIndex=g,c.logs=K({text:`Turn passed to ${n.players[g].name}.`,type:"neutral",id:Date.now()})),await M(T(D,"artifacts",L,"public","data","rooms",j),c)},Dt=()=>{const d=n.roomId,i=()=>{ze(!0),setTimeout(()=>ze(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",We)};try{navigator.clipboard.writeText(d),i()}catch{const c=document.createElement("textarea");c.value=d,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c),i()}},de=()=>{const d=n.players.findIndex(m=>m.id===t.uid);return n.turnIndex===d&&je!==t.uid?(F({type:"warning",message:"WRONG WORLD",subtext:"Return to your world to make moves.",icon:fe}),setTimeout(()=>F(null),2e3),!1):!0};if(ht)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(ct,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(It,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"Meteor impact detected! We're busy repairing the ecosystem."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(ke,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(ke,{size:16})]})})})}),e.jsx(Le,{})]});if(!t)return e.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center text-emerald-500 animate-pulse",children:"Returning to the wild..."});if(j&&!n&&!R)return e.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(xe,{}),e.jsx(ue,{}),e.jsxs("div",{className:"bg-slate-900/80 backdrop-blur p-8 rounded-2xl border border-slate-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(mt,{size:48,className:"text-emerald-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Resuming your session"})]})]})]});if(s==="splash")return e.jsx(Ys,{onStart:jt});if(s==="menu")return e.jsxs("div",{className:"min-h-screen bg-slate-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans select-none",children:[e.jsx(xe,{}),e.jsx(ue,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-emerald-800 rounded-lg 
			font-bold shadow-md hover:text-emerald-400 transition-colors w-fit animate-pulse`,children:[e.jsx(Pt,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),ge&&e.jsx(Ce,{onClose:()=>Z(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(ae,{size:64,className:"text-emerald-400 mx-auto mb-4 animate-spin-slow"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-thin text-transparent bg-clip-text bg-gradient-to-b from-emerald-400 to-teal-600 tracking-tighter drop-shadow-md",children:"EQUILIBRIUM"}),e.jsx("p",{className:"text-emerald-200/40 tracking-[0.5em] uppercase mt-2 text-xs",children:"Build. Balance. Score."})]}),e.jsxs("div",{className:"bg-slate-900/80 backdrop-blur-md border border-emerald-500/30 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10 relative",children:[R&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 text-red-200 p-3 mb-4 rounded text-center text-sm font-bold flex items-center justify-center gap-2",children:[e.jsx(Ee,{size:16})," ",R]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{className:"w-full bg-black/50 border border-emerald-700 focus:border-emerald-500 p-4 rounded-xl text-white outline-none transition-all text-lg font-bold text-center",placeholder:"YOUR NAME",value:p,onChange:d=>x(d.target.value),maxLength:12}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[e.jsxs("button",{onClick:yt,disabled:U,className:"bg-gradient-to-br from-emerald-600 to-teal-700 hover:from-emerald-500 hover:to-teal-600 p-4 rounded-xl font-bold flex flex-col items-center justify-center gap-1 transition-all active:scale-95 shadow-lg shadow-emerald-900/50",children:[e.jsx(Oe,{size:24}),e.jsx("span",{children:"Create"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{className:"bg-black/50 border border-emerald-700 focus:border-emerald-500 p-2 rounded-xl text-white text-center uppercase font-mono font-bold tracking-widest outline-none h-12",placeholder:"CODE",value:b,onChange:d=>w(d.target.value),maxLength:6}),e.jsx("button",{onClick:Nt,disabled:U,className:"bg-slate-800 hover:bg-slate-700 p-2 rounded-xl font-bold text-slate-300 transition-all active:scale-95 h-full",children:"Occupy"})]})]}),e.jsxs("button",{onClick:()=>Z(!0),className:"w-full mt-4 text-emerald-400 hover:text-emerald-300 text-sm font-bold flex items-center justify-center gap-2 transition-colors py-2",children:[e.jsx(Ye,{size:16})," Architect's Guide"]})]})]})]});if(s==="lobby"&&n){const d=n.hostId===t.uid;return e.jsxs("div",{className:"min-h-screen bg-slate-950 text-white flex flex-col items-center justify-center p-6 relative",children:[e.jsx(xe,{}),e.jsx(ue,{}),e.jsx(ct,{}),ge&&e.jsx(Ce,{onClose:()=>Z(!1)}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-slate-900/90 backdrop-blur p-8 rounded-2xl border border-emerald-500/30 shadow-2xl animate-in slide-in-from-bottom-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg md:text-xl flex items-center gap-2 text-emerald-500 font-bold uppercase",children:[e.jsx(Oe,{size:24})," World Coordinates:"]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:j}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:Dt,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:Me?e.jsx(We,{size:16,className:"text-green-500"}):e.jsx(Ht,{size:16})}),Me&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-emerald-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>V(!0),className:"p-2 hover:bg-red-900/30 rounded text-red-400",children:e.jsx(Ve,{size:20})})})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2",children:["Architects (",n.players.length,"/4)"]}),n.players.map(i=>e.jsxs("div",{className:"flex justify-between items-center bg-slate-800 p-4 rounded-xl border border-slate-700",children:[e.jsxs("span",{className:"font-bold flex items-center gap-3 text-lg",children:[i.name,i.id===n.hostId&&e.jsx(Re,{size:16,className:"text-yellow-500"})]}),n.hostId===t.uid&&i.id!==t.uid&&e.jsx("button",{onClick:()=>wt(i.id),className:"p-2 bg-red-900/20 hover:bg-red-900/50 text-red-500 rounded-lg transition-colors border border-red-900/30",title:"Kick Player",children:e.jsx(Qe,{size:16})})]},i.id)),Array.from({length:4-n.players.length}).map((i,m)=>e.jsx("div",{className:"border-2 border-dashed border-slate-700 rounded-xl p-4 flex items-center justify-center text-slate-600 font-bold uppercase text-sm",children:"Empty Slot"},m))]}),d&&e.jsxs("div",{className:"mt-8 flex flex-col items-center gap-2",children:[e.jsxs("button",{onClick:vt,disabled:n.players.length<1,className:"flex items-center gap-2 px-8 py-3 rounded-xl font-bold text-lg shadow-lg transition-all bg-gradient-to-br from-emerald-600 to-teal-700 text-white hover:bg-emerald-400 hover:scale-105 hover:shadow-emerald-500/20",children:[e.jsx(Oe,{size:24})," Create World"]}),n.players.length<1&&e.jsx("p",{className:"text-slate-600 text-xs uppercase tracking-widest font-bold",children:"Need 1+ player"})]}),!d&&e.jsx("div",{className:"mt-8 text-center text-slate-500 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Waiting for host to start..."})]}),qe&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 p-6 rounded-xl max-w-xs w-full text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2 uppercase",children:"Leave World?"}),e.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:n.hostId===t.uid?"As Host, leaving ends the game for everyone.":"You will leave this session."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V(!1),className:"flex-1 bg-slate-800 py-2 rounded font-bold text-slate-300",children:"Stay"}),e.jsx("button",{onClick:He,className:"flex-1 bg-red-600 py-2 rounded font-bold text-white",children:"Leave"})]})]})}),e.jsx(Le,{})]})}if(s==="game"&&n){const d=n.players.findIndex(o=>o.id===t.uid),i=n.players[d],m=n.turnIndex===d,c=n.players.find(o=>o.id===je)||i,g=m&&i.hasDraftedTokens&&i.holding.length===0;return e.jsxs("div",{className:"fixed inset-0 bg-slate-950 text-white flex flex-col overflow-hidden font-sans select-none",children:[e.jsx(xe,{}),e.jsx(ue,{}),e.jsx(gt,{}),J&&e.jsx(Ks,{type:J.type,message:J.message,subtext:J.subtext,icon:J.icon}),ge&&e.jsx(Ce,{onClose:()=>Z(!1)}),ft&&e.jsx(Gs,{gameState:n,onClose:()=>$e(!1)}),_e&&e.jsx(Us,{animal:_e,onClose:()=>bt(null)}),e.jsxs("div",{className:"h-14 md:h-16 bg-slate-900 border-b border-emerald-900/30 flex items-center justify-between px-2 z-[160] shrink-0 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-900/50 rounded-lg flex items-center justify-center border border-emerald-700",children:e.jsx(ae,{className:"text-emerald-400",size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm tracking-wider text-emerald-100",children:"EQUILIBRIUM"}),e.jsx("div",{className:"text-[10px] font-mono uppercase",children:n.status==="finished"?e.jsx("span",{className:"text-red-400",children:"GAME OVER"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-white-400",children:"Turn:"})," ",e.jsx("span",{className:"text-emerald-400",children:n.players[n.turnIndex].name})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>$e(!0),className:"p-2 hover:bg-slate-800 rounded text-yellow-500 hover:text-white",children:e.jsx(xt,{size:18})}),e.jsx("button",{onClick:()=>Z(!0),className:"p-2 hover:bg-slate-800 rounded text-slate-400 hover:text-white",children:e.jsx(Ye,{size:18})}),e.jsx("button",{onClick:()=>pt(!be),className:`p-2 rounded-full ${be?"bg-emerald-900 text-emerald-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(Ut,{size:18})}),e.jsx("button",{onClick:()=>V(!0),className:"p-2 hover:bg-red-900/30 rounded text-red-400",children:e.jsx(Ve,{size:18})})]})]}),be&&e.jsxs("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-slate-900/95 border border-slate-700 rounded-xl z-[155] overflow-y-auto p-2 shadow-2xl custom-scrollbar",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 sticky top-0 bg-slate-900/95 py-2",children:"World History"}),e.jsx("div",{className:"space-y-2",children:n.logs.slice().reverse().map(o=>e.jsx("div",{className:`text-xs p-2 rounded border-l-2 ${o.type==="success"?"border-emerald-500 bg-emerald-900/10":o.type==="warning"?"border-amber-500 bg-amber-900/10":o.type==="failure"?"border-red-500 bg-red-900/10":"border-slate-500 bg-slate-800/30"}`,children:o.text},o.id))})]}),qe&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 p-6 rounded-xl max-w-xs w-full text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2 uppercase",children:"Leave World?"}),e.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:n.hostId===t.uid?"As Host, leaving ends the game for everyone.":"You will leave this session."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V(!1),className:"flex-1 bg-slate-800 py-2 rounded font-bold text-slate-300",children:"Stay"}),e.jsx("button",{onClick:He,className:"flex-1 bg-red-600 py-2 rounded font-bold text-white",children:"Leave"})]}),n.hostId===t.uid&&e.jsx("button",{onClick:Ke,className:"w-full bg-slate-700 hover:bg-slate-600 py-2 rounded font-bold text-emerald-400 mt-2 text-sm",children:"Return All to Lobby"})]})}),e.jsxs("div",{className:"flex-1 relative bg-transparent overflow-hidden flex flex-col items-center justify-center",children:[e.jsx("div",{className:"absolute top-2 md:top-4 left-0 right-0 z-10 grid grid-cols-4 gap-1 px-2 w-full max-w-2xl mx-auto pointer-events-auto",children:n.players.map((o,u)=>{const f=n.turnIndex===u,h=kt(u),y=(o.score||0)+(o.landscapeScore||0)-(o.penalties||0)*2;return e.jsxs("button",{onClick:()=>re(o.id),className:`
          relative overflow-visible
          flex flex-col items-center justify-center h-12 md:h-14 rounded-xl border-2 transition-all w-full
          ${je===o.id?"bg-slate-800 border-emerald-500 shadow-lg scale-105 z-10":"bg-slate-900/80 border-slate-700 hover:bg-slate-800/80 text-slate-400"}
        `,children:[h&&e.jsx("div",{className:"absolute -top-2 -left-1 z-30",children:e.jsx("div",{className:"bg-amber-500 text-slate-950 p-1 rounded-md shadow-lg border border-amber-200 animate-pulse",children:e.jsx(Is,{size:10,strokeWidth:3})})}),o.activePalette==="TOKENS"&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-slate-900 rounded-full p-1 border border-cyan-500 shadow-lg z-20 animate-pulse",children:e.jsx(Ae,{size:10,className:"text-cyan-400 fill-cyan-400/20"})}),o.activePalette==="ANIMALS"&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-slate-900 rounded-full p-1 border border-orange-500 shadow-lg z-20 animate-pulse",children:e.jsx(pe,{size:10,className:"text-orange-400 fill-orange-400/20"})}),f&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 z-50 pointer-events-none",children:e.jsxs("div",{className:"flex flex-col items-center animate-bounce-slight",children:[e.jsxs("div",{className:"bg-emerald-500 text-white text-[8px] md:text-[9px] font-black px-2 py-0.5 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.5)] flex items-center gap-1 whitespace-nowrap",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"}),"PLAYING"]}),e.jsx("div",{className:"w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[4px] border-t-emerald-500 -mt-[1px]"})]})}),e.jsx("span",{className:`text-[9px] md:text-[10px] font-bold uppercase truncate max-w-full px-1 ${f?"text-emerald-400":""}`,children:o.name}),e.jsx("span",{className:"text-[10px] md:text-xs font-black text-yellow-500",children:y})]},o.id)})}),c.id!==t.uid?e.jsxs("div",{className:"absolute top-20 bg-red-800/80 px-4 py-1 rounded-full text-xs font-bold text-slate-300 flex items-center gap-2 z-10 backdrop-blur",children:[e.jsx(fe,{size:12})," ",c.name,"'s World"]}):e.jsxs("div",{className:"absolute top-20 bg-green-800/80 px-4 py-1 rounded-full text-xs font-bold text-slate-300 flex items-center gap-2 z-10 backdrop-blur",children:[e.jsx(fe,{size:12})," Your World"]}),e.jsx("div",{className:"relative w-[340px] h-[300px] transition-transform -mt-20 md:-mt-24 transform scale-100 md:scale-125",children:Object.values(c.board).map(o=>{let u=!1;if(z!==null&&i.animals[z]){const f=_[i.animals[z].type];f&&!o.animal&&i.animals[z].slotsFilled<i.animals[z].maxSlots&&(u=f.check(o,c.board))}return e.jsx(Hs,{...o,isPlaceable:m&&c.id===t.uid&&(O!==null&&i.holding[O]&&nt(o,i.holding[O])||u),ghostToken:O!==null?i.holding[O]:null,ghostAnimal:z!==null?i.animals[z].type:null,isValidTarget:u,onClick:c.id===t.uid?At:void 0},`${o.q},${o.r}`)})}),H&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-[60] h-44 bg-slate-900/95 border-t-2 border-emerald-500/50 backdrop-blur-xl flex flex-col animate-in slide-in-from-bottom-full duration-300 shadow-2xl",onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center px-4 h-8 border-b border-white/10 bg-black/20 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[H==="TOKENS"?e.jsx(Ae,{className:"text-cyan-400",size:14}):e.jsx(pe,{className:"text-orange-400",size:14}),e.jsxs("h3",{className:"text-xs font-black text-white uppercase tracking-widest leading-none",children:["Draft ",H==="TOKENS"?"Tokens":"Animal"]})]}),e.jsxs("button",{onClick:()=>ve(H),className:"flex items-center gap-1 px-2 py-0.5 bg-slate-800 hover:bg-slate-700 rounded-full text-slate-300 hover:text-white transition-colors border border-slate-600 font-bold text-[10px]",children:[e.jsx("span",{children:"Close"}),e.jsx(Ie,{size:12})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto overflow-y-hidden px-4 no-scrollbar flex items-center bg-gradient-to-b from-transparent to-black/30",children:e.jsxs("div",{className:"flex gap-4 items-center min-w-max h-full justify-center",children:[H==="TOKENS"&&n.market.map((o,u)=>e.jsxs("button",{onClick:()=>Et(u),disabled:!m||i.hasDraftedTokens,className:"relative group h-32 w-14 shrink-0 rounded-full transition-all active:scale-95 disabled:opacity-60 disabled:cursor-not-allowed",children:[e.jsxs("div",{className:"absolute inset-0 bg-slate-800 rounded-full border-4 border-slate-700 shadow-xl group-hover:border-cyan-500 group-hover:bg-slate-750 transition-colors flex flex-col items-center justify-evenly py-1",children:[e.jsx("div",{className:"absolute inset-x-2 top-2 bottom-2 bg-black/30 rounded-full border border-white/5"}),e.jsx("div",{className:"relative z-10 flex flex-col gap-1.5 h-full justify-center",children:o.tokens.map((f,h)=>{const y=B[f];return e.jsx("div",{className:`w-8 h-8 rounded-full border-2 shadow-lg flex items-center justify-center ${y.color} ${y.border}`,children:e.jsx(y.icon,{size:14,className:"text-white/90"})},h)})})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-20",children:e.jsxs("div",{className:"bg-cyan-600 text-white text-[10px] font-bold px-2 py-3 rounded-xl shadow-lg border border-cyan-400 tracking-widest uppercase flex flex-col items-center leading-none gap-1",children:[e.jsx("span",{children:"G"}),e.jsx("span",{children:"E"}),e.jsx("span",{children:"T"})]})})]},o.id)),H==="ANIMALS"&&n.animalMarket.map((o,u)=>{const f=_[o.type],h=m&&!i.hasDraftedAnimal&&i.animals.filter(I=>I.slotsFilled<I.maxSlots).length<4,y=Object.values(i.board).some(I=>!I.animal&&f.check(I,i.board));return e.jsxs("button",{onClick:()=>St(u),onMouseDown:()=>ie(o),onMouseUp:Q,onMouseLeave:Q,onTouchStart:()=>ie(o),onTouchEnd:Q,onTouchMove:Pe,disabled:!h,className:`
          relative w-24 h-32 shrink-0 bg-slate-800 border-2 rounded-xl flex flex-col shadow-xl text-left overflow-hidden transition-all duration-300 group
          ${h?"hover:-translate-y-1 cursor-pointer":"cursor-not-allowed"}
          ${y?"border-emerald-400 shadow-[0_0_20px_rgba(16,185,129,0.5)] animate-pulse z-10":h?"border-slate-600 hover:border-orange-500 hover:shadow-[0_5px_15px_rgba(249,115,22,0.2)]":"border-slate-800 opacity-60"}
        `,children:[e.jsxs("div",{className:"flex justify-between items-center px-2 py-1 border-b border-white/5 bg-black/20 shrink-0 h-7",children:[e.jsx("span",{className:"text-[10px] font-bold text-white truncate max-w-[50px]",children:f.name}),e.jsxs("span",{className:"text-[10px] font-black text-yellow-500",children:["+",f.points.join("/")]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center bg-gradient-to-b from-slate-800 to-slate-900",children:e.jsx("div",{className:"scale-75 origin-center",children:e.jsx(se,{visual:f.visual})})}),h&&e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-orange-600 text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-lg transform translate-y-2 group-hover:translate-y-0 transition-transform",children:"ADOPT"})})]},o.id)}),H==="ANIMALS"&&n.animalMarket.length===0&&e.jsx("div",{className:"w-full text-center text-slate-500 font-bold text-xs italic pr-4",children:"Empty..."})]})})]}),n.status==="finished"&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center backdrop-blur-sm pt-20 pb-10 px-4",children:e.jsxs("div",{className:"bg-slate-900 p-6 md:p-8 rounded-2xl border-2 border-yellow-500 text-center shadow-2xl animate-in zoom-in max-w-lg w-full flex flex-col max-h-full relative",children:[e.jsxs("div",{className:"shrink-0 mb-4",children:[e.jsx(ns,{size:64,className:"text-yellow-400 mx-auto mb-2 animate-bounce"}),(()=>{const o=k=>k.animals.reduce((ee,X)=>ee+X.slotsFilled,0),u=k=>(k.score||0)+(k.landscapeScore||0)-(k.penalties||0)*2,f=[...n.players].sort((k,ee)=>{const X=u(k),ce=u(ee);if(ce!==X)return ce-X;const we=o(k);return o(ee)-we}),h=f[0],y=u(h),I=o(h),q=f.filter(k=>u(k)===y&&o(k)===I);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-amber-500 uppercase mb-2 leading-tight",children:q.map(k=>k.name).join(" & ")}),e.jsx("p",{className:"text-emerald-400 font-bold tracking-widest text-sm uppercase",children:"Rescued the World!"})]})})()]}),e.jsx("div",{className:"space-y-3 mb-4 overflow-y-auto custom-scrollbar text-sm flex-1 pr-1",children:(()=>{const o=h=>(h.score||0)+(h.landscapeScore||0)-(h.penalties||0)*2,u=[...n.players].sort((h,y)=>o(y)-o(h)),f=o(u[0]);return u.map((h,y)=>{const I=(h.penalties||0)*2,q=o(h),k=q===f,X=(ce=>ce.animals.reduce((we,Ge)=>we+Ge.slotsFilled,0))(h);return e.jsxs("div",{className:`p-3 rounded-xl border flex flex-col gap-2 relative overflow-hidden transition-all
                            ${k?"bg-slate-800 border-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"bg-slate-800 border-slate-700 opacity-80"}`,children:[k&&e.jsx("div",{className:"absolute inset-0 bg-yellow-500/5 pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-center border-b border-slate-700 pb-2 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-mono font-bold ${k?"text-yellow-500":"text-slate-500"}`,children:["#",y+1]}),e.jsxs("span",{className:"font-bold text-white text-lg flex items-center gap-2",children:[h.name,k&&e.jsx(Re,{size:18,className:"text-yellow-400 fill-yellow-400/20"})]})]}),e.jsx("span",{className:`text-2xl font-black ${k?"text-yellow-400 scale-110":"text-slate-400"}`,children:q})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-slate-400 relative z-10",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Animals Placed:"})," ",e.jsx("span",{className:"text-white font-bold",children:X})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Animal Pts:"})," ",e.jsx("span",{className:"text-white font-bold",children:h.score})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Landscape Pts:"})," ",e.jsx("span",{className:"text-white font-bold",children:h.landscapeScore})]}),I>0?e.jsxs("div",{className:"flex justify-between text-red-400 font-bold",children:[e.jsx("span",{children:"Penalties:"})," ",e.jsxs("span",{children:["-",I]})]}):e.jsxs("div",{className:"flex justify-between text-emerald-600/50",children:[e.jsx("span",{children:"Penalties:"})," ",e.jsx("span",{children:"0"})]})]})]},h.id)})})()}),n.hostId===t.uid?e.jsx("div",{className:"shrink-0 pt-2",children:e.jsx("button",{onClick:Ke,className:"bg-slate-700 hover:bg-slate-600 px-6 py-3 rounded-xl font-bold w-full text-white transition-colors",children:"Return to Lobby"})}):e.jsx("div",{className:"shrink-0 pt-2",children:e.jsx("button",{disabled:!0,className:"bg-slate-700/60 px-6 py-3 rounded-xl font-bold w-full text-white",children:"Waiting for Host..."})})]})})]}),e.jsx("div",{className:"h-64 bg-transparent absolute bottom-0 left-0 right-0 z-40 px-2 pb-2 flex justify-between items-end pointer-events-none",children:e.jsxs("div",{className:"flex gap-2 items-end w-full pointer-events-none",children:[e.jsxs("div",{className:"relative h-46 flex flex-col justify-end gap-2 mb-1 shrink-0 z-50 pointer-events-none items-start",children:[e.jsx("div",{className:`
        absolute top-0 left-0
        pointer-events-auto
        px-3 py-1.5 rounded-full w-30 font-black text-[10px] uppercase tracking-widest shadow-lg backdrop-blur-md border animate-in slide-in-from-left-8
    ${m?"bg-slate-800/90 text-emerald-300 border-emerald-400":"bg-slate-800/90 text-slate-400 border-slate-600"}
  `,children:e.jsx("div",{className:"flex items-center gap-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-ping"}),"YOUR TURN"]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"AWAIT TURN"]})})}),c.holding.length>0&&e.jsxs("div",{className:`
      w-full px-2 py-2 rounded-xl shadow-2xl flex flex-col items-center gap-2 backdrop-blur-md animate-in slide-in-from-left-4 pointer-events-auto
      ${c.id===t.uid?"bg-slate-900/90 border border-emerald-500 opacity-90":"bg-slate-900/90 border border-slate-600 opacity-90"}
    `,children:[e.jsx("span",{className:`text-[8px] font-bold uppercase tracking-widest ${c.id===t.uid?"text-emerald-400":"text-slate-400"}`,children:c.id===t.uid?"Placing":"Holding"}),e.jsxs("div",{className:"flex items-center gap-1",children:[c.holding.map((o,u)=>{const f=B[o],h=c.id===t.uid;return e.jsx("button",{onClick:()=>{if(h){if(!de())return;ne(O===u?null:u),Ne(null)}},className:`
                w-10 h-10 rounded-full border-2 shadow-lg flex items-center justify-center transition-all 
                ${f.color} ${f.border}
                ${h?"active:scale-90 cursor-pointer hover:opacity-100 hover:scale-105":"cursor-default opacity-100"}
                ${h&&O===u?"ring-4 ring-white scale-110 z-10":"opacity-90"}
              `,children:e.jsx(f.icon,{size:18,className:"text-white/80"})},u)}),c.id===t.uid&&O!==null&&e.jsx("button",{onClick:Ot,className:"w-8 h-8 rounded-full border-2 border-red-500 bg-red-900/50 flex items-center justify-center hover:bg-red-800 transition-colors",title:"Discard Token (-2 pts)",children:e.jsx(Qe,{size:12,className:"text-red-300"})})]})]}),g&&e.jsx("button",{onClick:Tt,className:"bg-red-600 hover:bg-red-500 text-white font-bold py-3 px-6 w-full rounded-xl shadow-lg flex items-center justify-center gap-2 text-sm whitespace-nowrap pointer-events-auto animate-bounce [animation-duration:1.5s]",children:"End Turn"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{de()&&ve("TOKENS")},className:`w-14 h-14 rounded-full border-2 shadow-xl flex items-center justify-center transition-all active:scale-90 pointer-events-auto ${m&&!i.hasDraftedTokens?"bg-cyan-600 border-cyan-400 text-white animate-bounce-subtle":"bg-slate-800 border-slate-600 text-slate-500"}`,children:e.jsx(Ae,{size:24})}),e.jsx("button",{onClick:()=>{de()&&ve("ANIMALS")},className:`w-14 h-14 rounded-full border-2 shadow-xl flex items-center justify-center transition-all active:scale-90 pointer-events-auto ${m&&!i.hasDraftedAnimal&&i.animals.filter(o=>o.slotsFilled<o.maxSlots).length<4?"bg-orange-600 border-orange-400 text-white":"bg-slate-800 border-slate-600 text-slate-500"}`,children:e.jsx(pe,{size:24})})]})]}),e.jsxs("div",{className:"flex-1 flex gap-2 items-end overflow-x-auto pb-4 no-scrollbar h-60 pl-2 pointer-events-none",children:[c.animals.map((o,u)=>{const f=_[o.type],h=u===z&&c.id===t.uid,y=o.slotsFilled>=o.maxSlots,I=c.id===t.uid&&!y&&Object.values(i.board).some(q=>!q.animal&&f.check(q,i.board));return e.jsxs("button",{onClick:()=>{if(c.id!==t.uid){de();return}ne(null),Ne(h?null:u)},onMouseDown:()=>ie(o),onMouseUp:Q,onMouseLeave:Q,onTouchStart:()=>ie(o),onTouchEnd:Q,onTouchMove:Pe,className:`
          relative w-32 h-44 bg-slate-900/90 border-2 rounded-xl flex flex-col shadow-xl shrink-0 backdrop-blur-md transition-all duration-300 text-left overflow-hidden pointer-events-auto
          ${h?"border-yellow-400 ring-2 ring-yellow-500/50 scale-105 z-10 -translate-y-6":"hover:-translate-y-4"}
          ${I&&!h?"border-emerald-400 shadow-[0_0_20px_rgba(16,185,129,0.4)] animate-pulse":h?"":"border-slate-600 hover:border-slate-400"}
          ${y?"grayscale opacity-75 border-slate-700":""}
        `,children:[e.jsxs("div",{className:"flex justify-between items-center p-2 border-b border-white/10 bg-black/20 h-10 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f.icon,{size:14,className:f.iconColor}),e.jsx("span",{className:"text-xs font-bold text-white truncate max-w-[70px]",children:f.name})]}),!y&&e.jsxs("span",{className:"text-xs font-black text-yellow-500",children:["+",f.points[Math.min(o.slotsFilled,f.points.length-1)]]}),y&&e.jsx("span",{className:"text-[10px] font-bold text-emerald-500 uppercase",children:"Done"})]}),e.jsxs("div",{className:"p-2 flex-1 flex flex-col items-center w-full min-h-0 justify-between bg-gradient-to-b from-slate-800/50 to-transparent",children:[e.jsx("div",{className:"scale-75 origin-center shrink-0",children:e.jsx(se,{visual:f.visual})}),e.jsx("div",{className:"text-[9px] text-slate-300 text-center leading-tight line-clamp-2 px-1 w-full break-words min-h-[24px] flex items-center justify-center font-medium",children:f.desc}),e.jsx("div",{className:"w-full shrink-0 pt-2",children:e.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:o.maxSlots}).map((q,k)=>e.jsx("div",{className:`h-1.5 w-full rounded-full border ${k<o.slotsFilled?"bg-emerald-500 border-emerald-400 shadow-[0_0_5px_rgba(16,185,129,0.5)]":"bg-slate-700 border-slate-600"}`},k))})})]})]},o.id)}),c.animals.length===0&&e.jsx("div",{className:"h-44 w-32 border-2 border-dashed border-slate-700 rounded-xl flex items-center justify-center text-slate-600 text-xs text-center p-4",children:"No Animals Drafted"})]})]})}),e.jsx(Le,{})]})}return null}Bt.createRoot(document.getElementById("root")).render(e.jsx(N.StrictMode,{children:e.jsx(Vs,{})}));
