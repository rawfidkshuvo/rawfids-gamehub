import{c as be,i as ot,g as it,a as dt,R as $e,j as e,r as u,e as ct,o as Oe,d as R,H as mt,S as Pe,q as te,u as G,L as Ue,n as xt,s as ut,h as pt,p as Ae,t as gt,X as qe,m as ft}from"./x-CZayGA_K.js";import{U as ht}from"./utensils-Czw7CYer.js";import{C as U}from"./crown-Dx9ZX0tf.js";import{S as ye}from"./sword-KUbQjWul.js";import{G as bt}from"./gem-iRgZMJ1J.js";import{S as yt,B as De,C as Ge,a as jt,L as Me,R as fe,P as wt}from"./step-back-B0OJpjC1.js";import{U as J}from"./user-iW0fLfER.js";import{T as X}from"./trash-2-CvQllGyi.js";import{T as Fe}from"./triangle-alert-DkjWnX7a.js";import{S as je}from"./scale-DxufNqoF.js";import{G as we}from"./gift-GBbOpwtX.js";import{E as Z}from"./eye-off-B97m9-k-.js";import{T as he}from"./trophy-DYxnvBw2.js";import{C as Le}from"./check-CHMW_x8H.js";import{H as Ve}from"./history-Zl31ME6M.js";import{L as vt}from"./layers-CZxw1yXP.js";import{E as Nt}from"./eye-vNcUtVSg.js";import{H as kt}from"./house-BF2Y3ccd.js";import{S as It}from"./shield-rt-fAWQh.js";const Ct=[["path",{d:"M10 5V3",key:"1y54qe"}],["path",{d:"M14 5V3",key:"m6isi"}],["path",{d:"M15 21v-3a3 3 0 0 0-6 0v3",key:"lbp5hj"}],["path",{d:"M18 3v8",key:"2ollhf"}],["path",{d:"M18 5H6",key:"98imr9"}],["path",{d:"M22 11H2",key:"1lmjae"}],["path",{d:"M22 9v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9",key:"1rly83"}],["path",{d:"M6 3v8",key:"csox7g"}]],St=be("castle",Ct);const Rt=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],Tt=be("heart-pulse",Rt);const Et=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],_t=be("scroll",Et),He="/rawfids-gamehub/assets/emperor_cover-CJaFWmyv.png",zt={apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},Ye=ot(zt),ue=it(Ye),T=dt(Ye),O=typeof __app_id<"u"?__app_id:"emperor-game",$t="4",z={TREASURE:{id:"TREASURE",name:"The Merchant",val:5,icon:bt,color:"text-yellow-400",bg:"bg-gray-900",border:"border-yellow-500",item:"Treasure"},WEAPON:{id:"WEAPON",name:"The Warlord",val:4,icon:ye,color:"text-red-500",bg:"bg-gray-900",border:"border-red-600",item:"Weapon"},ART:{id:"ART",name:"The Patron",val:3,icon:U,color:"text-purple-400",bg:"bg-gray-900",border:"border-purple-500",item:"Art"},CLOTH:{id:"CLOTH",name:"The Weaver",val:3,icon:_t,color:"text-blue-400",bg:"bg-gray-900",border:"border-blue-500",item:"Cloth"},FOOD:{id:"FOOD",name:"The Glutton",val:2,icon:ht,color:"text-green-400",bg:"bg-gray-900",border:"border-green-500",item:"Food"},HOUSING:{id:"HOUSING",name:"The Architect",val:2,icon:St,color:"text-orange-400",bg:"bg-gray-900",border:"border-orange-500",item:"Housing"},HEALTH:{id:"HEALTH",name:"The Healer",val:2,icon:Tt,color:"text-pink-400",bg:"bg-gray-900",border:"border-pink-500",item:"Treatment"}},E={SECRET:{id:"SECRET",name:"Secret Plan",icon:Z,color:"text-blue-400",count:1,desc:"Place 1 card face down (revealed at round end).",reqCards:1},SABOTAGE:{id:"SABOTAGE",name:"Sabotage",icon:X,color:"text-red-400",count:1,desc:"Discard 2 cards permanently.",reqCards:2},GIFT:{id:"GIFT",name:"The Offering",icon:we,color:"text-purple-400",count:1,desc:"Offer 3 cards. Opponent picks 1, you keep 2.",reqCards:3},TRADE:{id:"TRADE",name:"The Divide",icon:je,color:"text-green-400",count:1,desc:"Make two piles (2+2). Opponent picks one pile.",reqCards:4}},Ot=n=>{let f=n.length,p;for(;f!==0;)p=Math.floor(Math.random()*f),f--,[n[f],n[p]]=[n[p],n[f]];return n},F=(n,f="neutral")=>({text:n,type:f,id:Date.now().toString()+Math.random().toString(36).substr(2,9)}),W=$e.memo(()=>{const n=$e.useMemo(()=>[...Array(20)].map((f,p)=>{const c=Object.keys(z),g=z[c[p%c.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(g,{size:32})},p)}),[]);return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:n}),e.jsx("style",{children:`
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-20px) rotate(10deg); }
        }
        .animate-float { animation: float infinite ease-in-out; }
      `})]})}),pe=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(U,{size:12,className:"text-yellow-500"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-yellow-500 uppercase",children:"EMPEROR"})]}),Be=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(U,{size:22,className:"text-yellow-500"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-yellow-500 uppercase",children:"EMPEROR"})]}),Ke=({onConfirm:n,onCancel:f,isHost:p,onReturnToLobby:c})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Abandon Kingdom?"}),e.jsx("p",{className:"text-gray-400 mb-6 text-sm",children:p&&c?"As Emperor (Host), you can return everyone to the Lobby or dissolve the room completely.":"Are you sure you want to leave? This will remove you from the room."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[p&&c&&e.jsxs("button",{onClick:c,className:"w-full bg-blue-600 hover:bg-blue-500 text-white py-3 rounded font-bold transition-colors flex items-center justify-center gap-2 border border-blue-400",children:[e.jsx(kt,{size:18})," Return Crew to Lobby"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:f,className:"bg-gray-700 hover:bg-gray-600 text-white py-3 rounded font-bold transition-colors",children:"Stay"}),e.jsx("button",{onClick:n,className:"bg-red-600 hover:bg-red-500 text-white py-3 rounded font-bold transition-colors",children:"Leave"})]})]})]})}),_=({typeId:n,onClick:f,selected:p,disabled:c,small:g,tiny:j,faceDown:$,isOpponent:P})=>{if($)return e.jsx("div",{className:`
        ${j?"w-6 h-8 rounded-sm":g?"w-10 h-14 rounded":"w-16 h-24 md:w-20 md:h-32 rounded"} 
        bg-gray-800 border-2 border-gray-600 flex items-center justify-center shadow-lg transition-transform
        ${P?"":"hover:border-gray-400"}
      `,children:e.jsx("div",{className:"w-full h-full bg-[radial-gradient(ellipse_at_center,var(--tw-gradient-stops))] from-gray-700 to-gray-900 opacity-50 flex items-center justify-center",children:e.jsx("span",{className:`${j?"text-[10px]":"text-2xl"} text-gray-500 font-bold font-serif`,children:"?"})})});const t=z[n];return t?j?e.jsx("div",{className:`w-6 h-8 ${t.bg} border ${t.border} rounded-sm flex items-center justify-center shadow-sm`,children:e.jsx(t.icon,{className:`${t.color} w-3 h-3`})}):e.jsxs("button",{onClick:f,disabled:c,className:`
        relative rounded border-2 transition-all flex flex-col items-center justify-center shadow-lg
        ${g?"w-10 h-14 p-1":"w-16 h-24 md:w-24 md:h-36 p-1 md:p-2"}
        ${p?"ring-4 ring-yellow-400 -translate-y-2 z-10":"border-gray-600"}
        ${t.bg}
        ${c?"cursor-not-allowed brightness-75":"hover:scale-105 cursor-pointer hover:border-white"}
      `,children:[e.jsx("div",{className:`absolute top-0.5 left-1 md:top-1 md:left-1 text-[9px] md:text-[10px] font-bold ${t.color} leading-none`,children:t.val}),e.jsx("div",{className:`absolute bottom-0.5 right-1 md:bottom-1 md:right-1 text-[9px] md:text-[10px] font-bold ${t.color} leading-none rotate-180`,children:t.val}),e.jsx(t.icon,{className:`${t.color} ${g?"w-4 h-4":"w-6 h-6 md:w-10 md:h-10"}`}),!g&&e.jsx("span",{className:"font-bold text-[9px] md:text-xs mt-1 md:mt-2 text-gray-300 text-center leading-none truncate w-full",children:t.item})]}):null},Pt=({type:n,used:f,onClick:p,active:c,disabled:g})=>{const j=E[n];return e.jsxs("button",{onClick:p,disabled:f||g,className:`
        relative p-2 md:p-3 rounded-full border-2 transition-all flex items-center justify-center group
        ${f?"bg-gray-800 border-gray-700 opacity-40 grayscale":"bg-gray-800 border-gray-500 hover:border-white hover:bg-gray-700"}
        ${c?"ring-2 md:ring-4 ring-yellow-400 scale-110 bg-gray-700":""}
      `,title:j.desc,children:[e.jsx(j.icon,{size:16,className:`${f?"text-gray-500":j.color} w-4 h-4 md:w-5 md:h-5`}),e.jsxs("div",{className:"absolute bottom-full mb-2 hidden md:group-hover:block w-32 bg-black text-white text-[10px] p-2 rounded z-50 pointer-events-none",children:[j.desc," (",j.reqCards," cards)"]})]})},At=({id:n,data:f,myColor:p})=>{const c=z[n],g=f.owner,j=p==="red"?f.blueItems:f.redItems,$=p==="red"?f.redItems:f.blueItems;return e.jsxs("div",{className:"flex flex-col items-center gap-1 w-full",children:[e.jsx("div",{className:"flex flex-wrap justify-center gap-0.5 min-h-4 items-end w-full content-end",children:j.map((P,t)=>e.jsx(_,{typeId:P,tiny:!0},t))}),e.jsxs("div",{className:`
        relative w-full bg-gray-800 rounded-lg md:rounded-xl border-2 md:border-4 transition-all flex flex-col items-center justify-center z-10
        aspect-2/3 p-1
        ${g==="red"?"border-red-600 shadow-[0_0_10px_rgba(220,38,38,0.3)]":g==="blue"?"border-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.3)]":"border-gray-600"}
      `,children:[e.jsx("div",{className:`absolute top-1 left-1 font-bold text-[10px] md:text-lg ${c.color}`,children:c.val}),e.jsx("div",{className:`absolute bottom-1 right-1 font-bold text-[10px] md:text-lg ${c.color} rotate-180`,children:c.val}),g&&e.jsx("div",{className:`absolute -top-2 -right-2 md:-top-3 md:-right-3 rounded-full p-1 md:p-2 border-2 bg-gray-900 z-20 shadow-lg
            ${g==="red"?"border-red-500 bg-red-900/80 text-red-200":"border-blue-500 bg-blue-900/80 text-blue-200"}`,children:e.jsx(It,{className:"w-3 h-3 md:w-5 md:h-5",fill:"currentColor"})}),e.jsx(c.icon,{className:`${c.color} w-5 h-5 md:w-10 md:h-10 mb-1 md:mb-2`}),e.jsx("span",{className:`${c.color} font-serif font-bold text-[8px] md:text-sm text-center leading-tight truncate w-full`,children:c.name.split(" ").pop()}),e.jsx("span",{className:"text-gray-500 text-[8px] md:text-[10px] mt-0.5 uppercase tracking-wide hidden md:block",children:c.item})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-0.5 min-h-8 items-start w-full",children:$.map((P,t)=>e.jsx(_,{typeId:P,tiny:!0},t))})]})},Dt=({logs:n,onClose:f})=>e.jsx("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-gray-900/95 border border-gray-700 rounded-xl z-155 overflow-y-auto p-2 shadow-2xl",children:e.jsxs("div",{className:"bg-gray-800 w-full max-w-md h-[70vh] rounded-xl flex flex-col border border-gray-700 shadow-2xl animate-in zoom-in-95",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-xl",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx(Ve,{size:20})," Chronicles"]}),e.jsx("button",{onClick:f,className:"p-2 bg-gray-700 rounded-full hover:bg-gray-600",children:e.jsx(qe,{size:16,className:"text-gray-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...n].reverse().map((p,c)=>e.jsxs("div",{className:`text-sm p-3 rounded border-l-2 flex items-center gap-2 ${p.type==="danger"?"bg-red-900/20 border-red-500 text-red-200":p.type==="blue"?"bg-blue-900/20 border-blue-500 text-blue-200":p.type==="success"?"bg-green-900/20 border-green-500 text-green-200":"bg-gray-700/30 border-gray-500 text-gray-300"}`,children:[(p.type==="danger"||p.type==="blue")&&e.jsx(J,{size:14,className:"shrink-0"}),p.text]},c))})]})}),ge=({onClose:n})=>e.jsx("div",{className:"fixed inset-0 bg-black/95 z-100 flex items-center justify-center p-0 md:p-4",children:e.jsxs("div",{className:"bg-gray-900 md:rounded-2xl w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] overflow-hidden border-none md:border border-yellow-700 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-4 md:p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-serif text-yellow-500 uppercase tracking-widest",children:"Imperial Decree"}),e.jsx("span",{className:"text-gray-500 text-xs",children:"Rules of Engagement"})]}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-800 rounded-full text-gray-400",children:e.jsx(qe,{size:24})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 text-gray-300 scrollbar-thin scrollbar-thumb-gray-700",children:[e.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-3 flex items-center gap-3",children:[e.jsx(he,{className:"text-yellow-500"})," The Goal"]}),e.jsxs("p",{children:["Conquer the Seven Kingdoms by having the most items in a kingdom at the end of a round.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{className:"text-white",children:"Victory Conditions:"}),e.jsxs("ul",{className:"list-disc ml-5 mt-2 space-y-1",children:[e.jsxs("li",{children:["Control ",e.jsx("span",{className:"text-yellow-400",children:"4 Kingdoms"})]}),e.jsxs("li",{children:["OR amass"," ",e.jsx("span",{className:"text-yellow-400",children:"11 Victory Points"})," (Sum of Kingdom Values)"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-3",children:[e.jsx(ye,{className:"text-red-500"})," Action Tokens"]}),e.jsx("p",{className:"mb-4 text-sm text-gray-400",children:"You must use each token exactly once per round."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(Z,{className:"text-blue-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"Secret Plan (1 Card)"}),e.jsx("span",{className:"text-sm",children:"Place 1 card face down. It is revealed and added to your kingdoms at the end of the round."})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(X,{className:"text-red-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"Sabotage (2 Cards)"}),e.jsx("span",{className:"text-sm",children:"Discard 2 cards permanently from the game. Use this to deny items to your opponent."})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(we,{className:"text-purple-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"The Offering (3 Cards)"}),e.jsx("span",{className:"text-sm",children:"Select 3 cards. Your opponent picks 1 to keep. You keep the other 2."})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(je,{className:"text-green-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"The Divide (4 Cards)"}),e.jsx("span",{className:"text-sm",children:"Split 4 cards into two piles (2+2). Your opponent chooses one pile to keep. You get the other."})]})]})]})]})]}),e.jsx("div",{className:"p-4 bg-gray-950 border-t border-gray-800 text-center",children:e.jsx("button",{onClick:n,className:"bg-yellow-700 hover:bg-yellow-600 text-white px-8 py-3 rounded-lg font-bold",children:"Close Guide"})})]})}),Gt=({onStart:n})=>{const[f,p]=u.useState(!1),[c,g]=u.useState(!1),[j,$]=u.useState(!1);return u.useEffect(()=>{const P=localStorage.getItem("emperor_room_id");p(!!P);const t=new Image;t.src=He,t.onload=()=>{g(!0),setTimeout(()=>{$(!0)},2e3)}},[]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-black flex flex-col items-center justify-end pb-20 md:justify-center md:pb-0 font-sans overflow-hidden",children:[!c&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-50 text-yellow-500/50",children:[e.jsx(Ue,{size:48,className:"animate-spin mb-4"}),e.jsx("div",{className:"font-mono text-xs tracking-[0.3em] animate-pulse",children:"INITIALIZING SYSTEM..."})]}),e.jsxs("div",{className:`absolute inset-0 z-0 overflow-hidden transition-opacity duration-1000 ${c?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:`w-full h-full bg-cover bg-center transition-transform duration-[2000ms] ease-out ${c?"scale-100":"scale-130"}`,style:{backgroundImage:`url(${He})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40"})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-8 animate-in fade-in slide-in-from-bottom-10 duration-1000",children:e.jsx("div",{className:`transform transition-all duration-1000 ease-out ${j?"translate-y-0 opacity-100":"translate-y-32 opacity-0"}`,children:e.jsxs("button",{onClick:n,className:"group relative px-12 py-5 bg-yellow-600/20 hover:bg-yellow-600/40 border border-yellow-500/50 hover:border-yellow-400 text-yellow-300 font-black text-2xl tracking-widest rounded-none transform transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.4)] backdrop-blur-md overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-yellow-400/10 to-transparent translate-y-[-100%] animate-[scan_2s_infinite_linear]"}),e.jsx("span",{className:"relative z-10 flex items-center gap-3 animate-pulse",children:f?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"animate-spin-slow"})," RESUME"]}):e.jsxs(e.Fragment,{children:[e.jsx(wt,{})," PLAY"]})})]})})}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Hanamikoji. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),"."]}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(200%); }
        }
      `})]})};function Mt(){const[n,f]=u.useState(null),[p,c]=u.useState("splash"),[g,j]=u.useState(""),[$,P]=u.useState(""),[t,se]=u.useState(null),[ve,A]=u.useState(!1),[ae,K]=u.useState(""),[We,Ne]=u.useState(!1),[ke,Ie]=u.useState(!1),[v,re]=u.useState(null),[S,q]=u.useState([]),[le,ne]=u.useState(null),[L,oe]=u.useState([]),[Je,Q]=u.useState(!1),[Xe,ie]=u.useState(!1),[de,V]=u.useState(!1),[ce,Ce]=u.useState(!1),[Se,H]=u.useState(!1),[D,Ze]=u.useState(()=>localStorage.getItem("gameHub_playerName")||"");u.useEffect(()=>{D&&localStorage.setItem("gameHub_playerName",D)},[D]),u.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await xt(ue,__initial_auth_token):await ut(ue))();const s=ct(ue,f);return()=>s()},[]);const Qe=()=>{const r=localStorage.getItem("emperor_room_id");r&&(A(!0),j(r)),c("menu")};u.useEffect(()=>{if(!g||!n)return;const r=Oe(R(T,"artifacts",O,"public","data","rooms",g),s=>{if(s.exists()){const l=s.data();if(!l.players.some(i=>i.id===n.uid)){j(""),c("menu"),K("You were removed from the room."),localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name"),A(!1);return}se(l),l.status==="playing"||l.status==="round_end"||l.status==="finished"?c("game"):c("lobby"),A(!1)}else j(""),c("menu"),K("The Kingdom has fallen (Room Closed)."),localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name"),A(!1)});return()=>r()},[g,n]),u.useEffect(()=>{if(t&&(t.status==="round_end"||t.status==="finished")&&t.hostId===n?.uid&&Object.keys(t.readyForNextRound||{}).length===2){const s=t.status==="finished";Te(!s)}},[t,n]);const me=u.useRef("");if(u.useEffect(()=>{t&&(me.current!=="round_end"&&me.current!=="finished"&&(t.status==="round_end"||t.status==="finished")&&(ie(!0),Q(!1)),me.current=t.status)},[t?.status]),u.useEffect(()=>{const r=Oe(R(T,"game_hub_settings","config"),s=>{s.exists()&&(s.data()[$t]?.maintenance?Ne(!0):Ne(!1))});return()=>r()},[]),We)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(Be,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(mt,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"The Emperor's court is currently closed for renovations."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(Pe,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(Pe,{size:16})]})})})}),e.jsx(pe,{})]});const et=async()=>{if(!D)return K("Name required");A(!0);const r="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let s="";for(let i=0;i<6;i++)s+=r.charAt(Math.floor(Math.random()*r.length));const l={};Object.values(z).forEach(i=>{const{icon:y,...x}=i;l[i.id]={...x,owner:null,redItems:[],blueItems:[]}}),await pt(R(T,"artifacts",O,"public","data","rooms",s),{roomId:s,hostId:n.uid,status:"lobby",players:[{id:n.uid,name:D,color:"red",hand:[],tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1}],kings:l,deck:[],round:1,turnPlayerId:null,roundStarterId:null,phase:"lobby",pendingInteraction:null,logs:[],winnerId:null,roundReveal:null,readyForNextRound:{},winReason:null}),localStorage.setItem("emperor_room_id",s),localStorage.setItem("emperor_player_name",D),j(s),P(s),c("lobby"),A(!1)},tt=async()=>{if(!$||!D)return K("Room ID and Name required");A(!0);const r=R(T,"artifacts",O,"public","data","rooms",$),s=await Ae(r);if(!s.exists()){K("Room not found"),A(!1);return}const l=s.data();if(l.players.length>=2&&!l.players.some(i=>i.id===n.uid)){K("Room full"),A(!1);return}if(!l.players.some(i=>i.id===n.uid)){const i=[...l.players,{id:n.uid,name:D,color:"blue",hand:[],tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1}];await G(r,{players:i})}localStorage.setItem("emperor_room_id",$),localStorage.setItem("emperor_player_name",D),j($),A(!1)},Re=async()=>{if(!(!g||!n)){try{const r=R(T,"artifacts",O,"public","data","rooms",g),s=await Ae(r);if(s.exists()){const l=s.data();if(l.hostId===n.uid)await gt(r);else{const i=l.players.filter(y=>y.id!==n.uid);await G(r,{players:i})}}}catch(r){console.error("Error leaving room:",r)}localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name"),j(""),c("menu"),se(null),H(!1)}},st=async r=>{if(!t||t.hostId!==n.uid)return;const s=t.players.filter(l=>l.id!==r);await G(R(T,"artifacts",O,"public","data","rooms",g),{players:s})},at=()=>{const r=t.roomId,s=()=>{Ie(!0),setTimeout(()=>Ie(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",Ge)};try{navigator.clipboard.writeText(r),s()}catch{const i=document.createElement("textarea");i.value=r,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),s()}},rt=async()=>{if(!t||t.hostId!==n.uid)return;const r=t.players.map(l=>({...l,hand:[],tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1})),s={...t.kings};Object.keys(s).forEach(l=>{s[l].redItems=[],s[l].blueItems=[],s[l].owner=null}),await G(R(T,"artifacts",O,"public","data","rooms",g),{status:"lobby",phase:"lobby",players:r,kings:s,deck:[],round:1,turnPlayerId:null,pendingInteraction:null,logs:[],winnerId:null,roundReveal:null,readyForNextRound:{},winReason:null}),H(!1)},Te=async(r=!1)=>{if(t.hostId!==n.uid)return;let s=[];Object.values(z).forEach(d=>{for(let h=0;h<d.val;h++)s.push(d.id)}),s=Ot(s),s.pop();let l;if(r){const d=t.roundStarterId,h=t.players.find(m=>m.id!==d);l=h?h.id:t.players[0].id}else{const d=Math.floor(Math.random()*t.players.length);l=t.players[d].id}const i=t.players.map(d=>{const h=[];for(let m=0;m<6;m++)s.length>0&&h.push(s.pop());return{...d,hand:h,tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1}}),y=i.findIndex(d=>d.id===l);y!==-1&&s.length>0&&i[y].hand.push(s.pop());const x={...t.kings};Object.keys(x).forEach(d=>{x[d].redItems=[],x[d].blueItems=[],r||(x[d].owner=null)});const N=i[y].name,b={status:"playing",kings:x,deck:s,players:i,round:r?t.round+1:1,turnPlayerId:l,roundStarterId:l,phase:"turn",pendingInteraction:null,winnerId:null,winReason:null,roundReveal:null,readyForNextRound:{}};r?b.logs=te(F(`âš”ï¸ Round ${t.round+1} Begins! ${N} draws and starts.`,"info")):b.logs=[F(`âš”ï¸ New Game! ${N} draws 1 card and starts.`,"info")],await G(R(T,"artifacts",O,"public","data","rooms",g),b),ie(!1),Q(!1)},Ee=async()=>{if(!t)return;const r=t.readyForNextRound?.[n.uid];await G(R(T,"artifacts",O,"public","data","rooms",g),{[`readyForNextRound.${n.uid}`]:!r})},ee=async(r,s,l,i,y="turn",x=null)=>{if(r.every(d=>Object.values(d.tokens).every(h=>h===!0))&&!x){await ze(r,s);return}let b=t.players.find(d=>d.id!==n.uid).id;if(x)b=x.targetId;else if(l.length>0){const d=l.pop(),h=r.findIndex(m=>m.id===b);r[h].hand.push(d)}await G(R(T,"artifacts",O,"public","data","rooms",g),{players:r,kings:s||t.kings,deck:l||t.deck,turnPlayerId:b,phase:y,pendingInteraction:x,logs:te(F(i,"neutral"))}),re(null),q([]),oe([]),ne(null)},lt=(r,s)=>{if(S.includes(s))q(S.filter(l=>l!==s));else if(v){const l=E[v].reqCards;S.length<l&&q([...S,s])}},Y=(r,s,l)=>{const i=r[s];l==="red"?i.redItems.push(s):i.blueItems.push(s)},_e=async()=>{if(!v||!n)return;const r=t.players.find(m=>m.id===n.uid),s=E[v].reqCards;if(S.length!==s){alert(`Select exactly ${s} cards.`);return}let l=JSON.parse(JSON.stringify(t.players)),i=l.findIndex(m=>m.id===n.uid),y=l.findIndex(m=>m.id!==n.uid),x=JSON.parse(JSON.stringify(t.kings)),N=[...t.deck];const b=[...r.hand].sort((m,w)=>z[w].val-z[m].val),d=S.map(m=>b[m]),h=m=>{m.forEach(w=>{const a=l[i].hand.indexOf(w);a>-1&&l[i].hand.splice(a,1)})};if(l[i].tokens[v]=!0,v==="SECRET")h(d),l[i].faceDownCards.push(d[0]),await ee(l,x,N,`${r.name} placed a Secret Plan.`);else if(v==="SABOTAGE")h(d),l[i].sabotagedCards||(l[i].sabotagedCards=[]),l[i].sabotagedCards.push(...d),await ee(l,x,N,`${r.name} Sabotaged (Discarded 2 cards).`);else if(v==="GIFT"){h(d);const m={type:"GIFT",initiatorId:n.uid,targetId:l[y].id,cards:d};await ee(l,x,N,`${r.name} offers a Gift (Choose 1 of 3).`,"interaction",m)}else if(v==="TRADE"){if(le!=="TRADE_SPLIT"){ne("TRADE_SPLIT");return}const m=L;if(m.length!==2){alert("Piles must be 2 and 2.");return}const w=m.map(k=>b[k]),o=S.filter(k=>!m.includes(k)).map(k=>b[k]);h(d);const C={type:"TRADE",initiatorId:n.uid,targetId:l[y].id,pile1:w,pile2:o};await ee(l,x,N,`${r.name} proposes a Trade (Pick a pile).`,"interaction",C)}},xe=async r=>{if(!t.pendingInteraction)return;const{type:s,initiatorId:l,targetId:i,cards:y,pile1:x,pile2:N}=t.pendingInteraction;if(n.uid!==i)return;let b=JSON.parse(JSON.stringify(t.players)),d=JSON.parse(JSON.stringify(t.kings)),h=[...t.deck];const m=b.find(I=>I.id===i),w=b.find(I=>I.id===l);let a="";if(s==="GIFT"){const I=y[r],B=y.filter((M,nt)=>nt!==r);Y(d,I,m.color),B.forEach(M=>Y(d,M,w.color)),a=`${m.name} chose ${z[I].item}. ${w.name} kept the rest.`}else if(s==="TRADE"){const I=r===0?x:N,B=r===0?N:x;I.forEach(M=>Y(d,M,m.color)),B.forEach(M=>Y(d,M,w.color)),a=`${m.name} picked a pile of ${I.length} items.`}const o=l;let C=b.find(I=>I.id!==o).id;if(b.every(I=>Object.values(I.tokens).every(B=>B===!0)))await ze(b,d);else{if(h.length>0){const I=h.pop(),B=b.findIndex(M=>M.id===C);b[B].hand.push(I)}await G(R(T,"artifacts",O,"public","data","rooms",g),{players:b,kings:d,deck:h,pendingInteraction:null,phase:"turn",turnPlayerId:C,logs:te(F(a,"success"))})}},ze=async(r,s)=>{let l=[];l.push(F("ðŸ”” Round End! Revealing Secret Plans...","neutral"));const i={};r.forEach(a=>{i[a.id]=[...a.faceDownCards],a.faceDownCards.forEach(o=>{Y(s,o,a.color)}),a.faceDownCards=[]});let y=0,x=0,N=0,b=0;const d=r.find(a=>a.color==="red"),h=r.find(a=>a.color==="blue");Object.keys(s).forEach(a=>{const o=s[a],C=o.redItems.length,k=o.blueItems.length;C>k?(o.owner!=="red"&&l.push(F(`${d.name} conquered ${o.name}!`,"danger")),o.owner="red"):k>C&&(o.owner!=="blue"&&l.push(F(`${h.name} conquered ${o.name}!`,"blue")),o.owner="blue"),o.owner==="red"&&(y++,N+=o.val),o.owner==="blue"&&(x++,b+=o.val)});let m=null,w=null;y>=4||N>=11?(m=d.id,w=y>=4?"controlled 4 Kingdoms":"scored 11 Victory Points"):(x>=4||b>=11)&&(m=h.id,w=x>=4?"controlled 4 Kingdoms":"scored 11 Victory Points"),m&&l.push(F("ðŸ† Game Over!","success")),await G(R(T,"artifacts",O,"public","data","rooms",g),{status:m?"finished":"round_end",winnerId:m,winReason:w,kings:s,players:r,roundReveal:i,pendingInteraction:null,phase:"resolution",readyForNextRound:{},logs:te(...l)})};if(!n)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-yellow-500 animate-pulse",children:"Reclaiming throne..."});if(g&&!t&&!ae)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(W,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(Ue,{size:48,className:"text-yellow-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(p==="splash")return e.jsx(Gt,{onStart:Qe});if(p==="menu")return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(W,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-yellow-800 rounded-lg 
			font-bold shadow-md hover:text-yellow-400 transition-colors w-fit animate-pulse`,children:[e.jsx(yt,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),de&&e.jsx(ge,{onClose:()=>V(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(U,{size:64,className:"text-yellow-500 mx-auto mb-4 animate-bounce drop-shadow-[0_0_15px_rgba(234,179,8,0.5)]"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-linear-to-b from-yellow-300 to-yellow-600 font-serif tracking-widest drop-shadow-md",children:"EMPEROR"}),e.jsx("p",{className:"text-gray-400 tracking-[0.3em] uppercase mt-2",children:"Rule the Seven Kingdoms"})]}),e.jsxs("div",{className:"bg-gray-900/80 backdrop-blur border border-gray-700 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10 animate-in slide-in-from-bottom-10 duration-700 delay-100",children:[ae&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-2 mb-4 rounded text-center text-sm border border-red-800",children:ae}),e.jsx("input",{className:"w-full bg-black/50 border border-gray-600 p-3 rounded mb-4 text-white placeholder-gray-500 focus:border-yellow-500 outline-none transition-colors",placeholder:"Your Name, My Liege",value:D,onChange:r=>Ze(r.target.value)}),e.jsxs("button",{onClick:et,disabled:ve,className:"w-full bg-linear-to-r from-yellow-700 to-yellow-600 hover:from-yellow-600 hover:to-yellow-500 p-4 rounded font-bold mb-4 flex items-center justify-center gap-2 border border-yellow-500/30 shadow-[0_0_15px_rgba(234,179,8,0.2)] transition-all",children:[e.jsx(U,{size:20})," Establish Kingdom"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx("input",{className:"w-full sm:flex-1 bg-black/50 border border-gray-600 p-3 rounded text-white placeholder-gray-500 uppercase font-mono tracking-wider focus:border-yellow-500 outline-none",placeholder:"ROOM CODE",value:$,onChange:r=>P(r.target.value.toUpperCase())}),e.jsx("button",{onClick:tt,disabled:ve,className:"w-full sm:w-auto bg-gray-800 hover:bg-gray-700 border border-gray-600 px-6 py-3 rounded font-bold transition-colors",children:"Join"})]}),e.jsxs("button",{onClick:()=>V(!0),className:"w-full text-sm text-gray-400 hover:text-white flex items-center justify-center gap-2 py-2",children:[e.jsx(De,{size:16})," Imperial Decree"]})]})]});if(p==="lobby"&&t){const r=t.hostId===n.uid;return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-6 relative",children:[e.jsx(W,{}),e.jsx(Be,{}),de&&e.jsx(ge,{onClose:()=>V(!1)}),Se&&e.jsx(Ke,{onConfirm:Re,onCancel:()=>H(!1),isHost:r}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-gray-800/90 p-8 rounded-2xl border border-gray-700 shadow-2xl mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-yellow-500 font-bold uppercase",children:"Throne Room"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:g}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:at,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:ke?e.jsx(Ge,{size:16,className:"text-green-500"}):e.jsx(jt,{size:16})}),ke&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-yellow-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(J,{size:16})," ",t.players.length,"/2"]}),e.jsx("button",{onClick:()=>H(!0),className:"p-2 bg-red-900/50 hover:bg-red-900 rounded text-red-300",title:"Leave Room",children:e.jsx(Me,{size:16})})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[t.players.map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-4 rounded border border-gray-700",children:[e.jsxs("span",{className:`font-bold ${s.color==="red"?"text-red-500":"text-blue-500"} flex items-center gap-2`,children:[s.id===t.hostId&&e.jsx(U,{size:14,className:"text-yellow-500"})," ",s.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.id===n.uid&&e.jsx("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded",children:"You"}),r&&s.id!==n.uid&&e.jsx("button",{onClick:()=>st(s.id),className:"p-2 hover:bg-red-900/50 rounded text-red-400",title:"Kick Player",children:e.jsx(X,{size:16})})]})]},s.id)),t.players.length<2&&e.jsx("div",{className:"text-center text-gray-500 animate-pulse italic",children:"Waiting for challenger..."})]}),e.jsx("div",{className:"flex flex-col gap-3",children:t.hostId===n.uid?e.jsx("button",{onClick:()=>Te(!1),disabled:t.players.length<2,className:`w-full py-4 rounded-xl font-bold text-lg shadow-lg transition-all ${t.players.length<2?"bg-gray-700 cursor-not-allowed text-gray-500":"bg-green-700 hover:bg-green-600 text-white shadow-green-900/30"}`,children:"Begin Campaign"}):e.jsx("div",{className:"text-center text-yellow-500/80 font-serif mb-2",children:"Waiting for Host to start..."})})]}),e.jsx(pe,{})]})}if(p==="game"&&t){const r=t.players.find(a=>a.id===n.uid),s=t.players.find(a=>a.id!==n.uid),l=t.hostId===n.uid;if(!s)return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(W,{}),e.jsxs("div",{className:"bg-gray-800 p-8 rounded-xl border border-red-700 shadow-2xl relative z-10 max-w-md",children:[e.jsx(Fe,{size:64,className:"text-red-500 mb-4 mx-auto"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Opponent has fled the battlefield!"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"The empire is yours by default, though it is a hollow victory."}),e.jsx("button",{onClick:()=>{j(""),se(null),c("menu"),localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name")},className:"bg-yellow-600 hover:bg-yellow-500 text-black px-6 py-3 rounded font-bold w-full",children:"Return to Menu"})]})]});const i=t.turnPlayerId===n.uid&&t.phase==="turn",y=t.phase==="interaction"&&t.pendingInteraction?.targetId===n.uid&&t.status==="playing",x=t.status==="round_end"||t.status==="finished",N=[...r.hand].sort((a,o)=>z[o].val-z[a].val),b=a=>{L.includes(a)?oe(L.filter(o=>o!==a)):L.length<2&&oe([...L,a])},d=t.readyForNextRound?.[n.uid],h=t.readyForNextRound?.[s.id],m=y||i&&!x;let w="";if(y)t.pendingInteraction.type==="GIFT"&&(w="Gift Received: Pick 1 Card from top right"),t.pendingInteraction.type==="TRADE"&&(w="Trade Offered: Pick 1 Pile from top right");else if(i&&!x)if(v){const a=E[v];v==="TRADE"&&le==="TRADE_SPLIT"?w="Split your cards into two piles":w=`${a.name}: Select ${a.reqCards} card${a.reqCards>1?"s":""}`}else w="Your Turn: Select an Action Token";return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col overflow-hidden relative font-sans select-none",children:[e.jsx(W,{}),de&&e.jsx(ge,{onClose:()=>V(!1)}),ce&&e.jsx(Dt,{logs:t.logs,onClose:()=>Ce(!1)}),Se&&e.jsx(Ke,{onConfirm:Re,onCancel:()=>H(!1),isHost:l,onReturnToLobby:rt}),e.jsxs("div",{className:"h-14 bg-gray-900/80 border-b border-gray-800 flex items-center justify-between px-4 z-20 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"font-serif text-yellow-500 font-bold tracking-wider hidden md:block",children:"EMPEROR"}),e.jsxs("div",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:["Round ",t.round]})]}),e.jsxs("div",{className:"flex gap-2",children:[x&&(t.winnerId?e.jsxs("button",{onClick:()=>Q(!0),className:"px-4 py-1.5 bg-yellow-600 hover:bg-yellow-500 rounded text-sm font-bold animate-pulse shadow-lg shadow-yellow-900/50 flex items-center gap-2",children:[e.jsx(he,{size:16})," Show Results"]}):e.jsxs("button",{onClick:Ee,className:`px-4 py-1.5 rounded text-sm font-bold flex items-center gap-2 transition-all ${d?"bg-green-700 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[d?e.jsx(Le,{size:16}):e.jsx(fe,{size:16}),d?h?"Starting...":"Waiting...":"Next Round"]})),e.jsx("button",{onClick:()=>Ce(!ce),className:`p-2 rounded-full ${ce?"bg-yellow-900 text-yellow-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(Ve,{size:18})}),e.jsx("button",{onClick:()=>V(!0),className:"p-2 hover:bg-gray-800 rounded text-gray-400",children:e.jsx(De,{size:18})}),e.jsx("button",{onClick:()=>H(!0),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:e.jsx(Me,{size:18})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between p-2 md:p-4 relative z-10 max-w-6xl mx-auto w-full h-full",children:[e.jsxs("div",{className:"flex flex-row justify-between items-start mb-2 shrink-0 gap-2 h-24 md:h-auto",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-[45%] md:w-[40%]",children:[e.jsxs("div",{className:`flex items-center gap-2 font-bold ${s.color==="red"?"text-red-500":"text-blue-500"} text-sm md:text-base truncate`,children:[e.jsx(J,{size:16})," ",s.name,t.turnPlayerId===s.id&&!y&&!x&&e.jsx("span",{className:"text-[10px] md:text-xs bg-yellow-500 text-black px-1 rounded animate-pulse ml-2",children:"Thinking..."}),t.phase==="interaction"&&t.pendingInteraction.targetId===s.id&&e.jsx("span",{className:"text-[10px] md:text-xs bg-orange-500 text-white px-1 rounded animate-bounce ml-2",children:"Deciding..."})]}),e.jsx("div",{className:"flex gap-1 overflow-hidden",children:s.hand.map((a,o)=>e.jsx("div",{className:"w-4 h-6 md:w-5 md:h-8 bg-gray-800 border border-gray-600 rounded"},o))}),e.jsx("div",{className:"flex gap-1 mt-1 opacity-70",children:Object.keys(E).map(a=>{const o=E[a].icon,C=s.tokens[a];return e.jsx("div",{className:`p-1 rounded-full border ${C?"border-gray-700 bg-gray-800":"border-gray-600 bg-gray-900"}`,children:e.jsx(o,{size:10,className:C?"text-gray-600":E[a].color})},a)})}),e.jsxs("div",{className:"flex gap-2 mt-1 items-center overflow-x-auto no-scrollbar",children:[s.faceDownCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2",children:[e.jsx("span",{className:"text-[9px] text-gray-500 uppercase mr-1 whitespace-nowrap",children:e.jsx(Z,{size:10})}),s.faceDownCards.map((a,o)=>e.jsx(_,{tiny:!0,faceDown:!0},`secret-${o}`))]}),s.sabotagedCards&&s.sabotagedCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2",children:[e.jsx("span",{className:"text-[9px] text-gray-500 uppercase mr-1 whitespace-nowrap",children:e.jsx(X,{size:10})}),s.sabotagedCards.map((a,o)=>e.jsx(_,{typeId:a,tiny:!0},`discard-${o}`))]})]})]}),e.jsx("div",{className:"flex-1 flex justify-end h-full",children:y?e.jsxs("div",{className:"bg-gray-800/90 border border-orange-500 rounded-lg p-2 shadow-lg flex flex-col items-center justify-center w-full max-w-sm animate-in slide-in-from-right-4 fade-in h-full overflow-y-auto no-scrollbar",children:[t.pendingInteraction.type==="GIFT"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-[10px] md:text-xs font-bold text-white flex items-center gap-1 mb-1",children:[e.jsx(we,{size:12})," Gift! Keep 1:"]}),e.jsx("div",{className:"flex justify-center gap-2",children:t.pendingInteraction.cards.map((a,o)=>e.jsx("div",{className:"hover:scale-105 transition-transform cursor-pointer",onClick:()=>xe(o),children:e.jsx(_,{typeId:a,small:!0})},o))})]}),t.pendingInteraction.type==="TRADE"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-[10px] md:text-xs font-bold text-white flex items-center gap-1 mb-1",children:[e.jsx(je,{size:12})," Trade! Pick Pile:"]}),e.jsxs("div",{className:"flex justify-center gap-2 items-center",children:[e.jsx("button",{onClick:()=>xe(0),className:"bg-gray-700 p-1 rounded border border-gray-600 hover:border-yellow-400 flex gap-1 items-center",children:t.pendingInteraction.pile1.map((a,o)=>e.jsx(_,{typeId:a,tiny:!0},o))}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:"OR"}),e.jsx("button",{onClick:()=>xe(1),className:"bg-gray-700 p-1 rounded border border-gray-600 hover:border-yellow-400 flex gap-1 items-center",children:t.pendingInteraction.pile2.map((a,o)=>e.jsx(_,{typeId:a,tiny:!0},o))})]})]})]}):e.jsx("div",{className:"w-full h-full"})})]}),e.jsx("div",{className:"flex justify-center mb-2 shrink-0",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 px-4 py-1 rounded-full text-xs font-mono text-gray-400 shadow-lg flex items-center gap-2",children:[e.jsx(vt,{size:14})," Deck: ",t.deck.length]})}),e.jsx("div",{className:"flex-1 flex flex-col justify-center min-h-0",children:e.jsx("div",{className:`
                w-full justify-items-center gap-1 md:gap-3
                grid grid-cols-7 md:grid-cols-7
            `,children:Object.keys(z).map((a,o)=>e.jsx("div",{className:`w-full ${o>=4?"md:col-auto":""}`,children:e.jsx(At,{id:a,data:t.kings[a],myColor:r.color})},a))})}),e.jsx("div",{className:"h-8 flex items-center justify-center my-2 shrink-0 relative",children:!y&&e.jsx("div",{className:"w-full max-w-md text-center text-sm text-gray-400 bg-gray-900/50 p-1 rounded backdrop-blur-sm flex justify-center items-center gap-2",children:t.logs.slice(-1).map((a,o)=>e.jsxs("span",{className:`flex items-center gap-2 ${a.type==="danger"?"text-red-400":a.type==="blue"?"text-blue-400":a.type==="success"?"text-green-400":"text-gray-300"}`,children:[(a.type==="danger"||a.type==="blue")&&e.jsx(J,{size:14}),a.text]},o))})}),m&&e.jsx("div",{className:"flex justify-center mb-1 animate-bounce",children:e.jsxs("div",{className:"bg-yellow-500 text-black text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-yellow-300 flex items-center gap-2",children:[e.jsx(Fe,{size:12})," ",w]})}),e.jsxs("div",{className:`bg-gray-900/90 p-3 md:p-4 rounded-t-xl md:rounded-xl border-t-2 border-gray-700 transition-all shrink-0 ${i?"shadow-[0_0_20px_rgba(234,179,8,0.1)] border-yellow-600/50":"grayscale opacity-80"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 -mt-1",children:[e.jsxs("div",{className:`flex items-center gap-2 font-bold ${r.color==="red"?"text-red-500":"text-blue-500"} text-sm md:text-base`,children:[e.jsx(J,{size:16})," ",r.name]}),i&&!x&&e.jsx("span",{className:"bg-green-600 text-white text-[10px] md:text-xs font-bold px-3 py-0.5 rounded-full shadow-lg animate-bounce border border-green-400 tracking-wider",children:"YOUR TURN"})]}),le==="TRADE_SPLIT"?e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"flex gap-4 p-4 bg-black/40 rounded-xl",children:S.map((a,o)=>{const C=N[a],k=L.includes(a);return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(_,{typeId:C,onClick:()=>b(a),selected:k}),e.jsx("div",{className:`text-xs font-bold px-2 py-1 rounded ${k?"bg-blue-600":"bg-red-600"}`,children:k?"Pile 1":"Pile 2"})]},o)})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>{ne(null),q([]),re(null)},className:"px-6 py-2 bg-gray-700 rounded hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{onClick:_e,disabled:L.length!==2,className:"px-6 py-2 bg-yellow-600 rounded font-bold hover:bg-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Trade Split"})]})]}):e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 flex justify-center px-2 w-full",children:e.jsx("div",{className:"flex items-end -space-x-5 md:-space-x-10 hover:-space-x-3 transition-all duration-300 py-4",children:N.map((a,o)=>e.jsx("div",{className:`
                            shrink-0 relative transition-all duration-200
                            ${S.includes(o)?"z-20 -translate-y-4":"hover:z-10 hover:-translate-y-2"}
                          `,children:e.jsx(_,{typeId:a,onClick:()=>i&&lt(a,o),selected:S.includes(o),disabled:!i})},o))})}),e.jsxs("div",{className:"flex gap-2 items-center shrink-0 min-w-[80px] overflow-x-auto no-scrollbar",children:[r.faceDownCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2 shrink-0",children:[e.jsx("span",{className:"text-[9px] text-gray-500 uppercase mr-1 whitespace-nowrap",children:e.jsx(Z,{size:10})}),r.faceDownCards.map((a,o)=>e.jsx("div",{className:"opacity-80 hover:opacity-100 transition-opacity shrink-0",children:e.jsx(_,{typeId:a,tiny:!0},o)},`my-secret-${o}`))]}),r.sabotagedCards&&r.sabotagedCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2 shrink-0",children:[e.jsx(X,{size:10,className:"text-gray-500"}),r.sabotagedCards.map((a,o)=>e.jsx(_,{typeId:a,tiny:!0},`my-discard-${o}`))]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px] shrink-0 w-full md:w-auto",children:[e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.keys(E).map(a=>e.jsx(Pt,{type:a,used:r.tokens[a],active:v===a,disabled:!i,onClick:()=>{i&&!r.tokens[a]&&(re(a),q([]))}},a))}),v&&i&&e.jsxs("div",{className:"bg-black/40 p-2 rounded text-xs text-center animate-in slide-in-from-right-4 fade-in",children:[e.jsx("div",{className:"text-yellow-500 font-bold mb-1",children:E[v].name}),e.jsx("div",{className:"text-gray-400 mb-2",children:E[v].desc}),e.jsxs("button",{onClick:_e,disabled:S.length!==E[v].reqCards,className:"w-full bg-yellow-700 hover:bg-yellow-600 disabled:bg-gray-700 disabled:text-gray-500 text-white py-2 rounded font-bold transition-colors",children:["Execute (",S.length,"/",E[v].reqCards,")"]})]})]})]})})]})]}),x&&Xe&&t.roundReveal&&e.jsx("div",{className:"fixed inset-0 bg-black/95 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-purple-500 rounded-2xl p-8 max-w-2xl w-full text-center shadow-2xl animate-in zoom-in-90",children:[e.jsxs("h2",{className:"text-2xl font-serif text-purple-400 mb-6 flex items-center justify-center gap-2",children:[e.jsx(Z,{})," Secret Plans Revealed!"]}),e.jsx("div",{className:"flex flex-col md:flex-row justify-around gap-8 mb-8",children:Object.keys(t.roundReveal).map(a=>{const o=t.players.find(k=>k.id===a)?.name,C=t.roundReveal[a];return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"font-bold text-gray-300 mb-2",children:[o," revealed:"]}),e.jsx("div",{className:"flex gap-2",children:C.length>0?C.map((k,I)=>e.jsx(_,{typeId:k,small:!0},I)):e.jsx("div",{className:"text-gray-600 italic",children:"No plans"})})]},a)})}),e.jsxs("button",{onClick:()=>ie(!1),className:"px-8 py-3 bg-purple-700 hover:bg-purple-600 text-white rounded-lg font-bold flex items-center justify-center gap-2 mx-auto",children:[e.jsx(Nt,{size:20})," Inspect Battlefield"]})]})}),x&&Je&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:`bg-gray-900 border rounded-2xl p-8 max-w-lg w-full text-center shadow-[0_0_50px_rgba(0,0,0,0.5)] ${t.winnerId?"border-yellow-500 shadow-yellow-500/20":"border-gray-600"}`,children:[t.winnerId?e.jsxs(e.Fragment,{children:[e.jsx(he,{size:64,className:"text-yellow-500 mx-auto mb-4 animate-bounce"}),e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Kingdoms United!"}),e.jsxs("p",{className:"text-xl text-gray-300 mb-2",children:[t.players.find(a=>a.id===t.winnerId).name," ","is the new Emperor!"]}),e.jsx("p",{className:"text-sm text-yellow-500/80 mb-8 uppercase tracking-widest border-t border-b border-yellow-900/50 py-2",children:t.winReason})]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{size:64,className:"text-red-500 mx-auto mb-4"}),e.jsxs("h2",{className:"text-3xl font-bold text-white mb-2",children:["Round ",t.round," Complete"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6 text-left bg-black/30 p-4 rounded",children:[e.jsxs("div",{className:"text-red-500 font-bold text-center",children:[e.jsx("div",{className:"text-2xl",children:Object.values(t.kings).filter(a=>a.owner==="red").length}),e.jsx("div",{className:"text-xs uppercase text-gray-500",children:"Red Kingdoms"})]}),e.jsxs("div",{className:"text-blue-500 font-bold text-center",children:[e.jsx("div",{className:"text-2xl",children:Object.values(t.kings).filter(a=>a.owner==="blue").length}),e.jsx("div",{className:"text-xs uppercase text-gray-500",children:"Blue Kingdoms"})]})]})]}),e.jsx("div",{className:"flex flex-col gap-3",children:t.winnerId?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Ee,className:`w-full py-3 rounded-lg font-bold transition-all flex items-center justify-center gap-2 ${d?"bg-green-700 hover:bg-green-600 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:[d?e.jsx(Le,{size:20}):e.jsx(fe,{size:20}),d?h?"Starting New Game...":"Waiting for Opponent":"Ready for Rematch"]}),e.jsx("button",{onClick:()=>H(!0),className:"w-full bg-transparent border border-red-900 text-red-400 hover:bg-red-900/20 px-8 py-3 rounded-lg font-bold",children:"Exit Room"})]}):e.jsx("button",{onClick:()=>Q(!1),className:"w-full bg-gray-700 hover:bg-gray-600 text-white px-8 py-3 rounded-lg font-bold",children:"Close & Prepare"})})]})}),e.jsx("div",{className:"bg-gray-950 pb-1 pt-1 z-50",children:e.jsx(pe,{})})]})}return null}ft.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(Mt,{})}));
