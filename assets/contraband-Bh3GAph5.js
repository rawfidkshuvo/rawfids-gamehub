import{c as ae,i as Ft,g as Ht,a as Yt,r as v,e as Wt,o as ot,d as T,j as e,H as Ve,S as ct,u as W,R as dt,n as Ut,s as qt,h as Vt,p as xt,q as le,t as Kt,X as we,m as Xt}from"./x-vdu6PxPT.js";import{L as Zt,S as Qt,B as Ke,C as Ge,a as Jt,b as Xe,P as es}from"./step-back-D7uqsBfy.js";import{P as be,C as ts}from"./package-CrRclCzi.js";import{S as gt}from"./shield-check-D0f25w0J.js";import{U as De}from"./user-hi-jrCL7.js";import{C as ve}from"./crown-DhFWzZA3.js";import{S as xe}from"./siren-Jq38sc8Q.js";import{H as mt}from"./handshake-Oe-COxTK.js";import{B as tt}from"./bomb-Br6wsIsa.js";import{S as jt}from"./skull--JE29QMg.js";import{C as $e}from"./coins-FTQ8_pUL.js";import{H as Nt}from"./history-r3RmdCN7.js";import{S as fe}from"./shopping-bag-DZipewoa.js";import{F as yt}from"./file-text-D_zMkP4d.js";import{B as ge}from"./briefcase-ClWMkL6D.js";import{E as vt}from"./eye-ByZgRM3i.js";import{G as wt}from"./ghost-Ddz50Svz.js";import{L as Ze}from"./lock-CXckOrBe.js";import{U as Fe}from"./utensils-CuQPaDLA.js";import{F as ss}from"./flame-DcN39Idu.js";import{C as as}from"./cpu-cTepKb_S.js";import{Z as ns}from"./zap-BEeOHqdt.js";import{I as rs}from"./info-D-_2aBr4.js";import{C as ls}from"./clock-DzIrWG2A.js";import{R as is}from"./rotate-ccw-B8nxxfV1.js";import{H as os}from"./house-BdFnrmDF.js";const cs=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],zt=ae("box",cs);const ds=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xs=ae("calendar",ds);const ms=[["path",{d:"M4 20a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1z",key:"mqzwx6"}],["path",{d:"m6.7 18-1-1C4.35 15.682 3 14.09 3 12a5 5 0 0 1 4.95-5c1.584 0 2.7.455 4.05 1.818C13.35 7.455 14.466 7 16.05 7A5 5 0 0 1 21 12c0 2.082-1.359 3.673-2.7 5l-1 1",key:"1gdt1g"}],["path",{d:"M10 4h4",key:"1xpv9s"}],["path",{d:"M12 2v6.818",key:"b17a49"}]],ps=ae("chess-king",ms);const hs=[["path",{d:"M4 9a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h4a1 1 0 0 1 1 1v4a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-4a1 1 0 0 1 1-1h4a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-4a1 1 0 0 1-1-1V4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4a1 1 0 0 1-1 1z",key:"1xbrqy"}]],He=ae("cross",hs);const us=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],kt=ae("flag",us);const bs=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],fs=ae("octagon-alert",bs);const gs=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],It=ae("scan",gs);const js=[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]],Ye=ae("shirt",js);const Ns=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}]],ys=ae("sparkle",Ns);const vs=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ws=ae("trash",vs);const zs=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ks=ae("trending-up",zs),Is="/rawfids-gamehub/assets/contraband_cover-CfnmcVqE.png",Ss={apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},St=Ft(Ss),We=Ht(St),_=Yt(St),P=typeof __app_id<"u"?__app_id:"contraband-game",Es="12",Te=500,Qe=500,Z={DIPLOMAT:{id:"DIPLOMAT",name:"Diplomat",desc:"Pay 50% less fines.",icon:kt,color:"text-blue-400"},YAKUZA:{id:"YAKUZA",name:"Yakuza",desc:"+20% value for Contraband.",icon:wt,color:"text-purple-400"},SNITCH:{id:"SNITCH",name:"Snitch",desc:"Earn $100 whenever another player is fined.",icon:vt,color:"text-yellow-400"},MERCHANT:{id:"MERCHANT",name:"Merchant",desc:"+20% value for Legal Goods.",icon:ge,color:"text-emerald-400"}},ie={NORMAL:{id:"NORMAL",name:"Market Stable",desc:"Business as usual.",multiplier:1,target:null},WAR:{id:"WAR",name:"War Zone",desc:"Weapons value x2.",multiplier:2,target:["WEAPON_1","WEAPON_2"]},PANDEMIC:{id:"PANDEMIC",name:"Pandemic",desc:"Meds & Rations value x2.",multiplier:2,target:["MEDS","FOOD","ROYAL_2_FOOD","ROYAL_3_FOOD","ROYAL_2_MEDS","ROYAL_3_MEDS"]},INDUSTRIAL_REV:{id:"INDUSTRIAL_REV",name:"Industrial Boom",desc:"Uniforms & Machinery value x2.",multiplier:2,target:["TEXTILE","PARTS","ROYAL_2_TEXTILE","ROYAL_3_TEXTILE","ROYAL_2_PARTS"]},RECESSION:{id:"RECESSION",name:"Market Recession",desc:"Contraband value -20%.",multiplier:.8,target:"ALL_ILLEGAL"},DEFLATION:{id:"DEFLATION",name:"Deflation",desc:"Legal Goods value -20%.",multiplier:.8,target:"ALL_LEGAL"},CRACKDOWN:{id:"CRACKDOWN",name:"Police Crackdown",desc:"All Fines Double.",multiplier:2,target:"ALL_FINES"},FREE_TRADE:{id:"FREE_TRADE",name:"Free Trade",desc:"All Fines Halved.",multiplier:.5,target:"ALL_FINES"}},he={POCKETS:{id:"POCKETS",name:"Deep Pockets",desc:"Hand Size +1 (Immediate Draw)",cost:300,icon:ge},EXPANDED:{id:"EXPANDED",name:"Crate Extension",desc:"Load up to 5 cards",cost:500,icon:zt},CONCEAL:{id:"CONCEAL",name:"Hidden Compartment",desc:"One highest value illegal item is safe per inspection",cost:400,icon:Ze},SCANNER:{id:"SCANNER",name:"X-Ray Scanner",desc:"As Inspector, reveal 1 random card per crate",cost:400,icon:It}},w={FOOD:{id:"FOOD",name:"Rations",val:200,penalty:200,type:"LEGAL",icon:Fe,color:"text-green-200",kingBonus:1e3,queenBonus:600},MEDS:{id:"MEDS",name:"Medkits",val:300,penalty:200,type:"LEGAL",icon:He,color:"text-green-300",kingBonus:1500,queenBonus:900},TEXTILE:{id:"TEXTILE",name:"Uniforms",val:300,penalty:200,type:"LEGAL",icon:Ye,color:"text-green-400",kingBonus:1500,queenBonus:900},PARTS:{id:"PARTS",name:"Machinery",val:400,penalty:200,type:"LEGAL",icon:Ve,color:"text-green-500",kingBonus:2e3,queenBonus:1200},WEAPON_1:{id:"WEAPON_1",name:"Laser Gun",val:600,penalty:400,type:"ILLEGAL",icon:ys,color:"text-red-200"},WEAPON_2:{id:"WEAPON_2",name:"Plasma Rifle",val:700,penalty:400,type:"ILLEGAL",icon:ns,color:"text-red-300"},CHIP:{id:"CHIP",name:"Neural Chip",val:800,penalty:400,type:"ILLEGAL",icon:as,color:"text-red-400"},SPICE:{id:"SPICE",name:"Red Dust",val:900,penalty:400,type:"ILLEGAL",icon:ss,color:"text-red-500"},ROYAL_2_FOOD:{id:"ROYAL_2_FOOD",name:"Ambrosia",val:400,penalty:300,type:"ILLEGAL",icon:Fe,color:"text-cyan-200",legalType:"FOOD",legalCount:2},ROYAL_2_MEDS:{id:"ROYAL_2_MEDS",name:"Panacea Vial",val:600,penalty:400,type:"ILLEGAL",icon:He,color:"text-cyan-300",legalType:"MEDS",legalCount:2},ROYAL_2_TEXTILE:{id:"ROYAL_2_TEXTILE",name:"Neo-Silk",val:600,penalty:400,type:"ILLEGAL",icon:Ye,color:"text-cyan-400",legalType:"TEXTILE",legalCount:2},ROYAL_2_PARTS:{id:"ROYAL_2_PARTS",name:"Quantum Gear",val:800,penalty:400,type:"ILLEGAL",icon:Ve,color:"text-cyan-500",legalType:"PARTS",legalCount:2},ROYAL_3_FOOD:{id:"ROYAL_3_FOOD",name:"Nectar of Gods",val:600,penalty:400,type:"ILLEGAL",icon:Fe,color:"text-yellow-200",legalType:"FOOD",legalCount:3},ROYAL_3_MEDS:{id:"ROYAL_3_MEDS",name:"Phoenix Serum",val:900,penalty:400,type:"ILLEGAL",icon:He,color:"text-yellow-300",legalType:"MEDS",legalCount:3},ROYAL_3_TEXTILE:{id:"ROYAL_3_TEXTILE",name:"Astral Velvet",val:900,penalty:400,type:"ILLEGAL",icon:Ye,color:"text-yellow-400",legalType:"TEXTILE",legalCount:3},TRAP:{id:"TRAP",name:"Booby Trap",val:0,penalty:0,type:"TRAP",icon:tt,color:"text-orange-400",desc:"If opened: Inspector pays $200"}},Ue=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(be,{size:12,className:"text-emerald-400"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-emerald-400 uppercase",children:"CONTRABAND"})]}),pt=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(be,{size:20,className:"text-emerald-400"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-emerald-400 uppercase",children:"CONTRABAND"})]}),Cs=(a,x="SHORT")=>{let r=[];const n=x==="LONG"&&a>4?1.5:1,c={MEDS:8*a*n,FOOD:6*a*n,PARTS:6*a*n,TEXTILE:4*a*n,WEAPON_1:4*a*n,WEAPON_2:4*a*n,CHIP:2*a*n,SPICE:2*a*n,ROYAL_2_MEDS:2*n,ROYAL_2_FOOD:2*n,ROYAL_2_TEXTILE:2*n,ROYAL_2_PARTS:2*n,ROYAL_3_MEDS:2*n,ROYAL_3_FOOD:2*n,ROYAL_3_TEXTILE:2*n};Object.entries(c).forEach(([u,A])=>{for(let B=0;B<A;B++)r.push(u)});for(let u=0;u<a;u++)r.push("TRAP");return r},Je=a=>{let x=a.length,r;for(;x!==0;)r=Math.floor(Math.random()*x),x--,[a[x],a[r]]=[a[r],a[x]];return a},qe=(a,x)=>{if(a.length===0)return null;let r=[],n=null;const c=x.includes("TRAP");for(;a.length>0;){let u=a.pop();if(u==="TRAP"&&c)r.push(u);else{n=u;break}}return r.length>0&&a.unshift(...r),n},ht=a=>{const x=Object.keys(Z),r=[...x];for(;r.length<a.length;)r.push(...x);const n=Je(r);return a.map((c,u)=>({...c,role:Z[n[u]].id}))},F=(a,x,r)=>{const n=a[x]||{income:0,expense:0,transactions:[],role:"",isInspector:!1,marketItems:[],roleBonus:0,eventImpact:0},c=r.transaction?[...n.transactions||[],r.transaction]:n.transactions||[],u=r.marketItem?[...n.marketItems||[],r.marketItem]:n.marketItems||[];return{...a,[x]:{...n,...r,income:(n.income||0)+(r.income||0),expense:(n.expense||0)+(r.expense||0),roleBonus:(n.roleBonus||0)+(r.roleBonus||0),eventImpact:(n.eventImpact||0)+(r.eventImpact||0),transactions:c,marketItems:u}}},_e=({isShaking:a})=>e.jsxs("div",{className:`absolute inset-0 overflow-hidden pointer-events-none z-0 ${a?"animate-shake bg-red-900/20":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:[...Array(20)].map((x,r)=>{const n=Object.keys(w),c=w[n[r%n.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(c,{size:32})},r)})}),e.jsx("style",{children:`
      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
      }
      .animate-float { animation: float infinite ease-in-out; }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
      .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    `})]}),As=({typeId:a,size:x=12})=>{const r=w[a];return r?e.jsx(r.icon,{size:x,className:r.color}):null},ut=({players:a,roundData:x,isFinal:r})=>{const[n,c]=v.useState(r?"FINAL":Math.max(0,x.length-1)),u=r?["FINAL","STASH",...x.map((s,S)=>`ROUND ${S+1}`)]:[],A=()=>{const s=[...a].sort((S,H)=>H.finalScore-S.finalScore);return e.jsx("div",{className:"flex flex-row gap-4 p-6 bg-zinc-900/50 overflow-x-auto pb-8 snap-x",children:s.map((S,H)=>{const l=[],N=[],L=[],U=[],b=[],E={};return S.stash.forEach(g=>{E[g]=(E[g]||0)+1}),Object.entries(E).forEach(([g,J])=>{const D=w[g];if(!D)return;const ne={...D,qty:J};D.id.startsWith("ROYAL_")&&N.push(ne),D.id.startsWith("ROYAL_2")?L.push(ne):D.id.startsWith("ROYAL_3")?U.push(ne):D.type==="ILLEGAL"?b.push(ne):D.type==="LEGAL"&&l.push(ne)}),e.jsxs("div",{className:`flex flex-col w-[320px] shrink-0 bg-zinc-800 rounded-xl border snap-center ${H===0?"border-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.1)]":"border-zinc-700"} overflow-hidden`,children:[e.jsxs("div",{className:"p-3 bg-black/20 w-full flex flex-row justify-between items-center border-b border-zinc-700",children:[e.jsx("div",{children:e.jsx("div",{className:"font-bold text-md text-white",children:S.name})}),H===0&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500 text-[10px] font-bold uppercase tracking-wider bg-yellow-900/20 px-2 py-1 rounded border border-yellow-500/20",children:[e.jsx(ve,{size:10})," Winner"]})]}),e.jsxs("div",{className:"flex-1 p-3 flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-widest border-b border-zinc-700 pb-1",children:"Exports Manifest"}),l.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-emerald-500 font-bold uppercase mb-1 block",children:"Legal Goods"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:l.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-emerald-900/20 px-1.5 py-0.5 rounded border border-emerald-500/20 text-[10px] text-emerald-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id))})]}),N.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-yellow-500 font-bold uppercase mb-1 block",children:"Royal Goods"}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[U.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-yellow-900/20 px-1.5 py-0.5 rounded border border-yellow-500/20 text-[10px] text-yellow-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id)),L.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-cyan-900/20 px-1.5 py-0.5 rounded border border-cyan-500/20 text-[10px] text-cyan-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id))]})]}),b.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-red-500 font-bold uppercase mb-1 block",children:"Contraband"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:b.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-red-900/20 px-1.5 py-0.5 rounded border border-red-500/20 text-[10px] text-red-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id))})]}),l.length===0&&N.length===0&&b.length===0&&e.jsx("div",{className:"text-zinc-600 italic text-xs",children:"No goods exported."})]}),e.jsxs("div",{className:"bg-black/20 -mx-3 -mb-3 p-3 border-t border-zinc-700 mt-auto",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-2",children:"Titles & Honors"}),S.kqDetails&&S.kqDetails.length>0?e.jsx("div",{className:"space-y-1 mb-3",children:S.kqDetails.map((g,J)=>{const D=g.includes("King");return e.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded ${D?"bg-yellow-500/10":"bg-pink-500/10"}`,children:[D?e.jsx(ve,{size:12,className:"text-yellow-400"}):e.jsx(ps,{size:12,className:"text-pink-400"}),e.jsx("span",{className:`text-[10px] font-bold ${D?"text-yellow-200":"text-pink-200"}`,children:g})]},J)})}):e.jsx("div",{className:"text-zinc-600 italic text-[10px] mb-3",children:"No titles awarded."}),e.jsxs("div",{className:"flex justify-between items-center border-t border-zinc-700 pt-2",children:[e.jsx("span",{className:"text-[10px] text-zinc-500 uppercase",children:"Bonus Payout"}),e.jsxs("span",{className:`font-mono font-bold ${S.kqIncome>0?"text-yellow-400 text-sm":"text-zinc-600 text-xs"}`,children:["+$",S.kqIncome]})]})]})]})]},S.id)})})},B=(s,S)=>{let H=[];if(S)H=a.map(l=>{let N=0,L=[],U=0,b=[],E=0,g=[],J=0,D=[];const ne=l.kqIncome||0,ze=l.kqDetails||[],je=l.stash||[];x.forEach((ee,oe)=>{const G=ee.stats[l.id];if(G){G.roleBonus>0&&(N+=G.roleBonus,L.push(`R${oe+1} (${Z[G.role]?.name}): +$${G.roleBonus}`)),G.eventImpact&&G.eventImpact!==0&&(U+=G.eventImpact,b.push(`R${oe+1} (${ee.event?.name}): ${G.eventImpact>0?"+":""}$${G.eventImpact}`)),G.marketItems&&G.marketItems.length>0&&G.marketItems.forEach(te=>{const R=he[te];R&&(J+=R.cost,D.push(`R${oe+1}: ${R.name} (-$${R.cost})`))});const Se=["Fine Paid","Fine Collected","Bribe Paid","Bribe Accepted","Bribe Returned","Trap Exploded","Trap Reward","Wrongful Search","Clean Bonus"];G.transactions&&G.transactions.forEach(te=>{if(Se.includes(te.label)&&(E+=te.amount,Math.abs(te.amount)>0)){let R=te.label;R==="Fine Paid"&&(R="Fined"),R==="Fine Collected"&&(R="Fine Coll."),R==="Trap Exploded"&&(R="Trap Hit"),R==="Wrongful Search"&&(R="Clean"),g.push(`R${oe+1}: ${R} (${te.amount>0?"+":""}${te.amount})`)}})}});const ke=je.reduce((ee,oe)=>ee+(w[oe]?.val||0),0),Ie=Math.floor(l.coins-Qe+ne);return{id:l.id,name:l.name,role:l.role,cash:l.coins,stashVal:ke,bonus:Math.floor(N),bonusDetails:L,eventBonus:U,eventDetails:b,inspectionNet:E,inspectionDetails:g,marketCost:J,marketDetails:D,kqIncome:ne,kqDetails:ze,loan:-Qe,total:Ie,isWinner:!1}}),H.sort((l,N)=>N.total-l.total),H.length>0&&(H[0].isWinner=!0);else{typeof n=="string"&&parseInt(n.split(" ")[1])-1;const l=Array.isArray(x)?x[n==="FINAL"||n==="STASH"?0:typeof n=="number"?n:parseInt(n.split(" ")[1])-1]:null,N=l?l.stats:null,L=l?l.event:null;if(!N)return e.jsx("div",{className:"p-12 text-center text-zinc-500 italic",children:"No Data Available"});H=Object.keys(N).map(U=>{const b=N[U],E=a.find(g=>g.id===U)?.name||"Unknown";return{id:U,name:E,role:b.role,isInspector:b.isInspector,marketItems:b.marketItems||[],roleBonus:b.roleBonus||0,eventImpact:b.eventImpact||0,transactions:b.transactions||[],income:b.income,expense:b.expense,net:b.income-b.expense,activeEvent:L}})}return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-zinc-900/50 text-xs uppercase text-zinc-500 font-bold tracking-wider",children:[e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Agent"}),S?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right",children:"Cash"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-emerald-300",children:"Stash"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-purple-400",children:"Insp. Impact"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-orange-400",children:"Black Market"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-yellow-400",children:"Role Bonus"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-blue-400",children:"Event Impact"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-yellow-200",children:"King/Queen"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-red-400",children:"Loan"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-white",children:"Final Score"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Event Impact"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Market"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Role Bonus"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 w-1/3",children:"Activity Log"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right",children:"Net Change"})]})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-800 text-sm",children:H.map((l,N)=>{const L=Z[l.role]?.icon,U=Z[l.role]?.color;return S?e.jsxs("tr",{className:`group hover:bg-zinc-800/30 transition-colors ${l.isWinner?"bg-emerald-900/10":""}`,children:[e.jsx("td",{className:"px-6 py-4 align-top",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex items-center justify-center w-6 h-6 rounded-full font-bold text-[10px] ${l.isWinner?"bg-yellow-500 text-black":"bg-zinc-800 text-zinc-500"}`,children:N+1}),e.jsx("span",{className:`font-medium ${l.isWinner?"text-white":"text-zinc-400"}`,children:l.name}),l.isWinner&&e.jsx(ve,{size:14,className:"text-yellow-500"})]})}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-zinc-400 align-top",children:["$",l.cash]}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-emerald-300 align-top",children:["$",l.stashVal]}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.inspectionNet>0?"text-purple-400":l.inspectionNet<0?"text-red-400":"text-zinc-600"}`,children:[l.inspectionNet>0?"+":"",l.inspectionNet]}),l.inspectionDetails.map((b,E)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},E))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.marketCost>0?"text-orange-400":"text-zinc-600"}`,children:["-$",l.marketCost]}),l.marketDetails.map((b,E)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},E))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"font-mono text-yellow-400",children:["+",l.bonus]}),l.bonusDetails.map((b,E)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},E))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.eventBonus>0?"text-blue-400":l.eventBonus<0?"text-red-400":"text-zinc-600"}`,children:[l.eventBonus>0?"+":"",l.eventBonus]}),l.eventDetails.map((b,E)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},E))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.kqIncome>0?"text-yellow-200":"text-zinc-600"}`,children:[l.kqIncome>0?"+":"",l.kqIncome]}),l.kqDetails.map((b,E)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},E))]})}),e.jsx("td",{className:"px-6 py-4 text-right font-mono text-red-400 align-top",children:l.loan}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono font-bold text-white text-lg align-top",children:["$",l.total]})]},l.id):e.jsxs("tr",{className:"group hover:bg-zinc-800/30",children:[e.jsxs("td",{className:"px-6 py-4 align-top",children:[e.jsx("div",{className:"font-medium text-white mb-1",children:l.name}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-zinc-500 mb-2",children:[l.isInspector?e.jsx(xe,{size:12,className:"text-red-500"}):e.jsx(L,{size:12,className:U??"text-zinc-400"}),l.isInspector?"Inspector":Z[l.role]?.name]})]}),e.jsxs("td",{className:"px-6 py-4 align-top",children:[l.activeEvent&&e.jsx("div",{className:"text-xs text-zinc-400 mb-1",children:e.jsx("div",{className:"font-bold text-zinc-300",children:l.activeEvent.name})}),l.eventImpact!==0?e.jsxs("span",{className:`font-mono text-xs font-bold px-1.5 py-0.5 rounded ${l.eventImpact>0?"text-emerald-400 bg-emerald-900/20":"text-red-400 bg-red-900/20"}`,children:[l.eventImpact>0?"+":"",l.eventImpact]}):e.jsx("span",{className:"text-zinc-600 text-xs",children:"-"})]}),e.jsx("td",{className:"px-6 py-4 align-top",children:l.marketItems.length>0?e.jsx("div",{className:"flex flex-col gap-1",children:l.marketItems.map((b,E)=>{const g=he[b];return e.jsxs("div",{className:"text-xs text-zinc-400 flex items-center gap-1",children:[e.jsx(fe,{size:10})," ",g?.name," ",e.jsxs("span",{className:"text-red-400",children:["-$",g?.cost]})]},E)})}):e.jsx("span",{className:"text-zinc-600 italic text-xs",children:"-"})}),e.jsx("td",{className:"px-6 py-4 align-top",children:l.roleBonus>0?e.jsxs("span",{className:"text-yellow-400 font-mono text-xs",children:["+$",l.roleBonus]}):e.jsx("span",{className:"text-zinc-600 text-xs",children:"-"})}),e.jsx("td",{className:"px-6 py-4 align-top",children:e.jsx("div",{className:"space-y-2",children:l.transactions.length===0?e.jsx("span",{className:"text-zinc-600 italic text-xs",children:"No activity."}):l.transactions.map((b,E)=>e.jsxs("div",{className:"flex flex-col text-xs border-b border-zinc-800 pb-1 last:border-0",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{className:"text-zinc-300 font-bold",children:b.label}),e.jsxs("span",{className:`font-mono ${b.amount>=0?"text-emerald-400":"text-red-400"}`,children:[b.amount>=0?"+":"",b.amount]})]}),b.items&&b.items.length>0&&e.jsx("div",{className:"flex gap-1 mt-1 flex-wrap",children:b.items.map((g,J)=>e.jsx("div",{className:"bg-black/40 p-0.5 rounded border border-zinc-700",title:w[g]?.name,children:e.jsx(As,{typeId:g,size:10})},J))}),b.detail&&e.jsx("div",{className:"text-[10px] text-zinc-500 mt-0.5",children:b.detail})]},E))})}),e.jsx("td",{className:"px-6 py-4 text-right font-mono font-bold align-top",children:e.jsxs("span",{className:l.net>=0?"text-emerald-400":"text-red-400",children:[l.net>=0?"+":"",l.net]})})]},l.id)})})]})})};return e.jsxs("div",{className:"w-full max-w-5xl bg-zinc-900 rounded-xl border border-zinc-700 overflow-hidden shadow-2xl mb-6 animate-in fade-in slide-in-from-bottom-10 duration-700",children:[e.jsx("div",{className:"bg-zinc-950 px-6 py-4 border-b border-zinc-800 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-900/30 rounded-lg border border-emerald-500/20",children:e.jsx(yt,{className:"text-emerald-500",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Mission Report"}),e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wider",children:r?"Final Operation Audit":"Round Summary"})]})]})}),r&&e.jsx("div",{className:"flex border-b border-zinc-800 bg-zinc-900/50 overflow-x-auto",children:u.map(s=>e.jsx("button",{onClick:()=>c(s),className:`px-6 py-3 text-sm font-bold transition-colors whitespace-nowrap ${n===s?"text-emerald-400 border-b-2 border-emerald-500 bg-emerald-900/10":"text-zinc-500 hover:text-zinc-300"}`,children:s},s))}),r&&n==="STASH"?A():B(x,r&&n==="FINAL")]})},Ls=({stash:a,onClose:x})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-160 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-700 p-6 max-w-lg w-full shadow-2xl flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-zinc-800 pb-2",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(ge,{className:"text-emerald-500"})," Stash (",a.length,")"]}),e.jsx("button",{onClick:x,className:"p-1 hover:bg-zinc-800 rounded text-zinc-400",children:e.jsx(we,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto grid grid-cols-4 gap-2",children:a.length===0?e.jsx("div",{className:"col-span-4 text-center text-zinc-500 py-8 italic",children:"Your stash is empty."}):a.map((r,n)=>{const c=w[r];if(!c)return null;const u=c.type==="ILLEGAL";return e.jsxs("div",{className:`p-2 rounded border flex flex-col items-center gap-1 ${u?"bg-red-900/10 border-red-900/30":"bg-emerald-900/10 border-emerald-900/30"}`,children:[e.jsx(c.icon,{size:24,className:c.color}),e.jsx("span",{className:`text-[10px] font-bold ${c.color}`,children:c.name}),e.jsxs("span",{className:"text-[9px] text-zinc-500",children:["$",c.val]})]},n)})}),e.jsxs("div",{className:"mt-4 pt-2 border-t border-zinc-800 text-center text-xs text-zinc-500",children:["Total Base Value: $",a.reduce((r,n)=>r+(w[n]?.val||0),0)]})]})}),Rs=({player:a,onClose:x})=>{if(!a)return null;const r=a.stash||[],n=r.filter(u=>w[u]?.type==="LEGAL").length,c=r.length-n;return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-160 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-700 p-6 max-w-lg w-full shadow-2xl flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-zinc-800 pb-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(De,{size:20,className:"text-zinc-400"}),a.name,"'s Cargo"]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-1",children:["Visible:"," ",e.jsxs("span",{className:"text-emerald-400",children:[n," Legal"]})," â€¢ Suspicious:"," ",e.jsxs("span",{className:"text-red-400",children:[c," Unknown"]})]})]}),e.jsx("button",{onClick:x,className:"p-1 hover:bg-zinc-800 rounded text-zinc-400",children:e.jsx(we,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:r.length===0?e.jsx("div",{className:"text-center text-zinc-500 py-12 italic border-2 border-dashed border-zinc-800 rounded-xl",children:"Cargo Hold Empty"}):e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2",children:r.map((u,A)=>{const B=w[u],s=B&&B.type==="LEGAL";return e.jsx("div",{className:"flex justify-center",children:e.jsx(et,{typeId:u,small:!0,faceDown:!s})},A)})})}),e.jsx("div",{className:"mt-4 pt-3 border-t border-zinc-800 text-center",children:e.jsx("div",{className:"text-xs text-zinc-600 uppercase tracking-widest",children:"Official Public Record"})})]})})},et=({typeId:a,small:x,selected:r,onClick:n,faceDown:c})=>{const u=w[a];if(!u)return null;const A=u.icon,B=u.type==="ILLEGAL",s=u.type==="TRAP",S=a.startsWith("ROYAL_");return c?e.jsx("div",{className:`
        relative shrink-0 rounded-xl border-2 border-zinc-700 bg-zinc-800 
        flex flex-col items-center justify-center shadow-lg
        ${x?"w-10 h-14":"w-20 h-32"}
      `,children:e.jsx("div",{className:"opacity-20",children:e.jsx(be,{size:x?16:32})})}):e.jsxs("div",{onClick:n,className:`
        relative shrink-0 rounded-xl border-2 flex flex-col items-center justify-between shadow-lg transition-all 
        ${r?"ring-4 ring-yellow-400 -translate-y-2 z-10 scale-105":"hover:-translate-y-1"}
        ${s?"bg-orange-950/50 border-orange-600/50":S?"bg-purple-950/50 border-purple-500/50":B?"bg-red-950/30 border-red-900/50":"bg-emerald-950/30 border-emerald-900/50"}
        ${x?"w-12 h-16 p-1":"w-24 h-36 md:w-32 md:h-44 p-2 md:p-3"}
        ${n?"cursor-pointer":""}
      `,children:[e.jsxs("div",{className:"w-full flex justify-between items-start",children:[e.jsx("span",{className:`font-black ${x?"text-[8px]":"text-xs"} text-zinc-500`,children:s?"TRAP":S?"ROYAL":B?"!!":"OK"}),e.jsx(A,{size:x?10:16,className:u.color})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(A,{size:x?16:32,className:`${u.color} drop-shadow-md`}),!x&&e.jsx("span",{className:`text-[10px] uppercase font-bold text-center leading-tight ${u.color}`,children:u.name})]}),!x&&e.jsx("div",{className:"w-full bg-black/40 rounded p-1 text-[8px] text-zinc-400 text-center leading-tight",children:s?"Inspector pays fine":e.jsxs(e.Fragment,{children:["val: ",u.val," ",e.jsx("br",{})," fine: ",u.penalty]})})]})},Os=a=>{const x=["MEDS","FOOD","PARTS","TEXTILE"],r={};return a.forEach(n=>{r[n.id]={income:0,details:[]}}),x.forEach(n=>{const c=a.map(N=>{let L=0;return(N.stash||[]).forEach(U=>{const b=w[U];b&&(b.id===n&&(L+=1),b.legalType===n&&(L+=b.legalCount||0))}),{id:N.id,count:L,name:N.name}});if(c.sort((N,L)=>L.count-N.count),c.length===0)return;const u=c[0].count;if(u===0)return;const A=c.filter(N=>N.count===u),B=c.filter(N=>N.count<u&&N.count>0),s=B.length>0?B[0].count:0,S=B.filter(N=>N.count===s),H=w[n]?.kingBonus||0,l=w[n]?.queenBonus||0;A.forEach(N=>{r[N.id].income+=H,r[N.id].details.push(`King of ${w[n]?.name} (+${H})`)}),A.length===1&&S.length>0&&S.forEach(N=>{r[N.id].income+=l,r[N.id].details.push(`Queen of ${w[n]?.name} (+${l})`)})}),r},bt=({onConfirm:a,onCancel:x,isHost:r,onLobby:n})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-700 p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:r?"Disband Operation?":"Abandon Cargo?"}),e.jsx("p",{className:"text-zinc-400 mb-6 text-sm",children:r?"You are the Host. Leaving will close the checkpoint and kick all players.":"Leaving now will forfeit your progress."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[r&&n&&e.jsxs("button",{onClick:n,className:"bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded font-bold transition-colors flex items-center justify-center gap-2",children:[e.jsx(os,{size:18})," Return Everyone to Lobby"]}),e.jsxs("button",{onClick:a,className:"bg-red-900/80 hover:bg-red-800 text-red-200 py-3 rounded font-bold transition-colors flex items-center justify-center gap-2 border border-red-900",children:[e.jsx(Xe,{size:18})," ",r?"Destroy Room & Exit":"Leave Game"]}),e.jsx("button",{onClick:x,className:"text-zinc-500 hover:text-white py-2 text-sm",children:"Cancel"})]})]})}),Ts=({type:a,message:x,subtext:r,icon:n})=>e.jsx("div",{className:"fixed inset-0 z-160 flex items-center justify-center pointer-events-none p-4",children:e.jsxs("div",{className:`
      flex flex-col items-center justify-center p-8 md:p-12 rounded-3xl border-4 shadow-[0_0_50px_rgba(0,0,0,0.8)] 
      transform transition-all animate-in fade-in zoom-in slide-in-from-bottom-5 duration-300 backdrop-blur-xl
      ${a==="success"?"bg-emerald-900/90 border-emerald-500 text-emerald-100":""}
      ${a==="danger"?"bg-red-900/90 border-red-500 text-red-100":""}
      ${a==="neutral"?"bg-zinc-800/90 border-zinc-500 text-zinc-100":""}
      ${a==="bribe"?"bg-yellow-900/90 border-yellow-500 text-yellow-100":""}
    `,children:[n&&e.jsx("div",{className:"mb-4 p-4 bg-black/30 rounded-full border-2 border-white/20 shadow-xl",children:e.jsx(n,{size:48,className:"animate-bounce"})}),e.jsx("h2",{className:"text-4xl md:text-6xl font-black uppercase tracking-widest text-center drop-shadow-lg mb-2",children:x}),r&&e.jsx("p",{className:"text-xl md:text-2xl font-bold opacity-90 tracking-wide text-center",children:r})]})}),_s=({isOpen:a,onClose:x,player:r,onBuy:n})=>a?e.jsx("div",{className:"fixed inset-0 bg-black/90 z-100 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-2xl w-full max-w-2xl max-h-[80vh] flex flex-col border border-yellow-600/30 shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-zinc-950 border-b border-zinc-800 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-yellow-500 flex items-center gap-2",children:[e.jsx(fe,{})," Black Market"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-white font-mono flex items-center gap-1 bg-zinc-800 px-3 py-1 rounded-full",children:[e.jsx($e,{size:14,className:"text-yellow-500"})," $",r.coins]}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-zinc-800 rounded-full",children:e.jsx(we,{className:"text-zinc-400"})})]})]}),e.jsx("div",{className:"p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(he).map(c=>{const u=r.upgrades?.includes(c.id),A=r.coins>=c.cost;return e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700 flex flex-col justify-between group hover:border-yellow-500/50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"p-2 bg-black/50 rounded-lg text-yellow-500",children:e.jsx(c.icon,{size:24})}),e.jsxs("span",{className:"text-sm font-mono text-zinc-400",children:["$",c.cost]})]}),e.jsx("h3",{className:"font-bold text-lg text-white mb-1",children:c.name}),e.jsx("p",{className:"text-xs text-zinc-400 mb-4 h-8",children:c.desc}),e.jsx("button",{onClick:()=>n(c),disabled:u||!A,className:`w-full py-2 rounded font-bold text-sm transition-all
                    ${u?"bg-zinc-700 text-zinc-500 cursor-default":A?"bg-yellow-600 hover:bg-yellow-500 text-black shadow-lg shadow-yellow-900/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed"}`,children:u?"OWNED":A?"BUY":"TOO POOR"})]},c.id)})})]})}):null,Ds=({logs:a,onClose:x})=>e.jsx("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-gray-900/95 border border-gray-700 rounded-xl z-155 overflow-y-auto p-2 shadow-2xl",children:e.jsxs("div",{className:"bg-zinc-900 w-full md:max-w-md h-full md:h-[70vh] rounded-none md:rounded-xl flex flex-col border-none md:border border-zinc-700 shadow-2xl",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-800 flex justify-between items-center bg-zinc-950",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx(Nt,{size:18,className:"text-emerald-500"})," Operation Logs"]}),e.jsx("button",{onClick:x,className:"p-2 bg-zinc-800 rounded-full hover:bg-zinc-700",children:e.jsx(we,{className:"text-zinc-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...a].reverse().map((r,n)=>e.jsxs("div",{className:`text-xs md:text-sm p-3 rounded border-l-2 ${r.type==="danger"?"bg-red-900/10 border-red-500 text-red-300":r.type==="success"?"bg-green-900/10 border-green-500 text-green-300":r.type==="bribe"?"bg-yellow-900/10 border-yellow-500 text-yellow-300":"bg-zinc-800/50 border-zinc-600 text-zinc-400"}`,children:[e.jsxs("span",{className:"opacity-50 mr-2 font-mono",children:["[",new Date(parseInt(r.id)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),"]"]}),r.text]},n))})]})}),ft=({onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black/95 z-150 flex items-center justify-center p-0 md:p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 md:rounded-2xl w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] overflow-hidden border-none md:border border-emerald-500/30 flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-zinc-800 flex justify-between items-center bg-zinc-950",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2 tracking-wider",children:[e.jsx(Ke,{className:"text-emerald-500"})," Smuggler's Guide"]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-zinc-800 rounded-full text-zinc-400",children:e.jsx(we,{})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-zinc-300 space-y-8 scrollbar-thin scrollbar-thumb-zinc-700",children:[e.jsxs("section",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-3xl font-black text-emerald-400 uppercase tracking-widest",children:"The Goal"}),e.jsx("p",{className:"text-lg text-zinc-400",children:"Amass the biggest fortune. Money is earned by smuggling goods and collecting fines. The player with the highest total value (Cash + Stash Bonus) when the deck runs out wins."})]}),e.jsxs("section",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700",children:[e.jsxs("h4",{className:"font-bold text-yellow-500 mb-2 flex items-center gap-2",children:[e.jsx(fe,{size:16})," 1. The Market"]}),e.jsx("p",{className:"text-sm",children:"Buy illegal upgrades from the Black Market. Deep pockets, crate extensions, and scanners can turn the tide."})]}),e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700",children:[e.jsxs("h4",{className:"font-bold text-emerald-500 mb-2 flex items-center gap-2",children:[e.jsx(be,{size:16})," 2. Load & Bluff"]}),e.jsxs("p",{className:"text-sm",children:["Pack up to 3 cards. You must declare a legal good type. You can lie. You can also attach a cash ",e.jsx("strong",{children:"Bribe"})," to tempt the Inspector."]})]}),e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700",children:[e.jsxs("h4",{className:"font-bold text-red-500 mb-2 flex items-center gap-2",children:[e.jsx(xe,{size:16})," 3. Inspection"]}),e.jsxs("p",{className:"text-sm",children:["The Inspector chooses to ",e.jsx("strong",{children:"PASS"})," or"," ",e.jsx("strong",{children:"OPEN"}),". If passed, you sell goods immediately. If opened and caught lying, you pay a fine!"]})]})]}),e.jsxs("section",{className:"bg-zinc-800/30 p-5 rounded-xl border border-zinc-700/50",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(gt,{className:"text-emerald-500"})," Inspection Mechanics"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-sm",children:[e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-400 font-bold min-w-[60px]",children:"PASS:"})," ","Smuggler keeps goods & earns full value immediately."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-yellow-400 font-bold min-w-[60px]",children:"BRIBE:"})," ","If Inspector accepts bribe, crate passes. Inspector keeps bribe."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-orange-400 font-bold min-w-[60px]",children:"TRAP:"})," ","If opened crate has a"," ",e.jsx("span",{className:"text-orange-500 font-bold",children:"Booby Trap"}),", Inspector pays $200 fine!"]})]}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-red-400 font-bold min-w-[60px]",children:"BUSTED:"})," ","If opened & lying (or contraband): Smuggler pays fine. Illegal goods seized."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-400 font-bold min-w-[60px]",children:"CLEAN:"})," ","If opened & telling truth: Inspector pays fine to Smuggler for wasting time."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Player Roles"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-blue-400 mb-1",children:[e.jsx(kt,{size:16})," Diplomat"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"Pays 50% less fines when caught."})]}),e.jsxs("div",{className:"p-3 bg-purple-900/20 border border-purple-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-purple-400 mb-1",children:[e.jsx(wt,{size:16})," Yakuza"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"+20% immediate value for Illegal goods."})]}),e.jsxs("div",{className:"p-3 bg-emerald-900/20 border border-emerald-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-emerald-400 mb-1",children:[e.jsx(ge,{size:16})," Merchant"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"+20% immediate value for Legal goods."})]}),e.jsxs("div",{className:"p-3 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-yellow-400 mb-1",children:[e.jsx(vt,{size:16})," Snitch"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"Get $100 whenever someone else is fined."})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(fe,{className:"text-yellow-500"})," Black Market Items"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.values(he).map(x=>e.jsxs("div",{className:"p-3 bg-zinc-800/50 border border-yellow-600/20 rounded-lg flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-yellow-500",children:[e.jsx(x.icon,{size:16})," ",x.name]}),e.jsxs("span",{className:"text-xs font-mono text-zinc-300 bg-black/40 px-2 py-0.5 rounded border border-zinc-700",children:["$",x.cost]})]}),e.jsx("div",{className:"text-xs text-zinc-400",children:x.desc})]},x.id))})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Global Events"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(tt,{size:16,className:"text-red-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"War Zone:"})," Weapons and Machinery sell for 2x value."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(jt,{size:16,className:"text-purple-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Pandemic:"})," Meds and Foods sell for 2x value."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(xe,{size:16,className:"text-blue-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Crackdown:"})," All fines are doubled."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(ks,{size:16,className:"text-green-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Free Trade:"})," All fines are halved."]})]})]})]})]})]})}),$s=({onStart:a})=>{const[x,r]=v.useState(!1),[n,c]=v.useState(!1),[u,A]=v.useState(!1);return v.useEffect(()=>{A(!0);const B=localStorage.getItem("contraband_roomId");r(!!B);const s=setTimeout(()=>{c(!0)},2e3);return()=>clearTimeout(s)},[]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-black flex flex-col items-center justify-end pb-20 md:justify-center md:pb-0 font-sans overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e.jsx("div",{className:`w-full h-full bg-cover bg-center transition-transform duration-[2000ms] ease-out ${u?"scale-100":"scale-130"}`,style:{backgroundImage:`url(${Is})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40"})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-8 animate-in fade-in slide-in-from-bottom-10 duration-1000",children:e.jsx("div",{className:`transform transition-all duration-1000 ease-out ${n?"translate-y-0 opacity-100":"translate-y-20 opacity-0"}`,children:e.jsxs("button",{onClick:a,className:"group relative px-12 py-5 bg-emerald-600/20 hover:bg-emerald-600/40 border border-emerald-500/50 hover:border-emerald-400 text-emerald-300 font-black text-2xl tracking-widest rounded-none transform transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.4)] backdrop-blur-md overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-emerald-400/10 to-transparent translate-y-[-100%] animate-[scan_2s_infinite_linear]"}),e.jsx("span",{className:"relative z-10 flex items-center gap-3 animate-pulse",children:x?e.jsxs(e.Fragment,{children:[e.jsx(is,{className:"animate-spin-slow"})," RESUME"]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{})," PLAY"]})})]})})}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(200%); }
        }
      `})]})};function Ms(){const[a,x]=v.useState(null),[r,n]=v.useState("splash"),[c,u]=v.useState(""),[A,B]=v.useState(""),[s,S]=v.useState(null),[H,l]=v.useState(!1),[N,L]=v.useState(""),[U,b]=v.useState(!1),[E,g]=v.useState(!1),[J,D]=v.useState(!1),[ne,ze]=v.useState(!1),[je,ke]=v.useState(!1),[Ie,ee]=v.useState(!1),[oe,G]=v.useState(!1),[Se,te]=v.useState(null),[R,st]=v.useState(null),[re,Me]=v.useState([]),[at,Et]=v.useState("FOOD"),[ue,Ee]=v.useState(0),[Pe,Ct]=v.useState(0),[ce,At]=v.useState(()=>localStorage.getItem("gameHub_playerName")||"");v.useEffect(()=>{ce&&localStorage.setItem("gameHub_playerName",ce)},[ce]),v.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await Ut(We,__initial_auth_token):await qt(We))();const i=Wt(We,x);return()=>i()},[]);const Lt=()=>{const o=localStorage.getItem("contraband_roomId");o&&(l(!0),u(o)),n("menu")};v.useEffect(()=>{if(!c||!a)return;const o=ot(T(_,"artifacts",P,"public","data","rooms",c),i=>{if(i.exists()){const h=i.data();if(!h.players?.some(t=>t.id===a.uid)){u(""),n("menu"),localStorage.removeItem("contraband_roomId"),L("Connection Lost or Room Closed.");return}S(h),h.status==="lobby"?n("lobby"):n("game"),h.feedbackTrigger&&h.feedbackTrigger.id!==s?.feedbackTrigger?.id&&(!h.feedbackTrigger.visibleTo||h.feedbackTrigger.visibleTo===a.uid)&&(st(h.feedbackTrigger),setTimeout(()=>st(null),3e3))}else u(""),n("menu"),localStorage.removeItem("contraband_roomId"),L("Room Closed.")});return()=>o()},[c,a,s?.feedbackTrigger?.id]);const f=s?.players.find(o=>o.id===a?.uid)||{},Ce=s?.players[s?.inspectorIndex]?.id===a?.uid,Ne=s?.hostId===a?.uid,q=s?.marketEvent?ie[s.marketEvent.id]:ie.NORMAL,Ae=s?.inspectorOrder?.length||s?.players.length||0;v.useEffect(()=>{f.loadedCrate&&f.loadedCrate.bribe!==void 0&&Ee(f.loadedCrate.bribe)},[f.loadedCrate]),v.useEffect(()=>{const o=ot(T(_,"game_hub_settings","config"),i=>{i.exists()&&i.data()[Es]?.maintenance?g(!0):g(!1)});return()=>o()},[]);const Rt=async()=>{if(!ce.trim())return L("Codename required.");l(!0);const o="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let i="";for(let t=0;t<6;t++)i+=o.charAt(Math.floor(Math.random()*o.length));const h={roomId:i,hostId:a.uid,gameLength:"SHORT",status:"lobby",players:[{id:a.uid,name:ce,coins:Te,hand:[],stash:[],upgrades:[],role:null,loadedCrate:null,ready:!1}],deck:[],inspectorIndex:0,turnState:"IDLE",marketEvent:ie.NORMAL,logs:[],currentRound:1,inspectorOrder:[],roundHistory:[],currentRoundStats:{}};await Vt(T(_,"artifacts",P,"public","data","rooms",i),h),localStorage.setItem("contraband_roomId",i),u(i),l(!1)},Ot=async()=>{if(!A||!ce)return L("Missing Info.");l(!0);try{const o=T(_,"artifacts",P,"public","data","rooms",A),i=await xt(o);if(!i.exists())throw new Error("Room not found.");if(i.data().status!=="lobby")throw new Error("Game in progress.");if(i.data().players.length>=6)throw new Error("Full.");const h={id:a.uid,name:ce,coins:Te,hand:[],stash:[],upgrades:[],role:null,loadedCrate:null,ready:!1};await W(o,{players:le(h)}),localStorage.setItem("contraband_roomId",A),u(A)}catch(o){L(o.message)}l(!1)},nt=async()=>{if(!c)return;const o=T(_,"artifacts",P,"public","data","rooms",c);try{const i=await xt(o);if(i.exists()){const h=i.data();if(h.hostId===a.uid)await Kt(o);else{const t=h.players.filter(d=>d.id!==a.uid);await W(o,{players:t})}}}catch(i){console.error(i)}localStorage.removeItem("contraband_roomId"),u(""),n("menu"),ee(!1)},Tt=async o=>{if(!Ne||!c)return;const i=s.players.filter(h=>h.id!==o);await W(T(_,"artifacts",P,"public","data","rooms",c),{players:i})},_t=()=>{const o=s.roomId,i=()=>{b(!0),setTimeout(()=>b(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",Ge)};try{navigator.clipboard.writeText(o),i()}catch{const t=document.createElement("textarea");t.value=o,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),i()}},rt=async()=>{const o=s.players.map(i=>({...i,coins:Te,hand:[],stash:[],upgrades:[],role:null,loadedCrate:null,ready:!1}));await W(T(_,"artifacts",P,"public","data","rooms",c),{status:"lobby",players:o,logs:[],deck:[],turnState:"IDLE",winner:null,feedbackTrigger:null,marketEvent:ie.NORMAL,currentRound:1,inspectorOrder:[],roundHistory:[],currentRoundStats:{}}),ee(!1)},lt=async()=>{if(s.players.length<3)return L("Need 3+ Players.");const o=Je(Cs(s.players.length,s.gameLength));let i=s.players.map((p,V)=>V);s.gameLength==="LONG"&&(i=[...i,...i]),i=Je(i);const h=i[0],t=s.players[h].id,d={};let I=ht(s.players);I[h].role=null,I=I.map(p=>{const V=[];for(let m=0;m<6;m++){const $=qe(o,V);$&&V.push($)}return d[p.id]={role:p.role,isInspector:p.id===t,income:0,expense:0,transactions:[]},{...p,hand:V,coins:Te,stash:[],upgrades:[],loadedCrate:null,ready:!1}}),await W(T(_,"artifacts",P,"public","data","rooms",c),{status:"playing",players:I,deck:o,inspectorOrder:i,inspectorIndex:h,currentRound:1,currentRoundStats:d,roundHistory:[],turnState:"SHOPPING",marketEvent:ie.NORMAL,logs:[{id:Date.now().toString(),text:"Market Open. Roles Assigned.",type:"neutral"}]})},Be=async()=>{const o=s.players.map(i=>i.id===a.uid?{...i,ready:!i.ready}:i);if(s.status==="playing"&&s.turnState==="SHOPPING"&&o.every(i=>i.ready)){o.forEach(i=>i.ready=!1),await W(T(_,"artifacts",P,"public","data","rooms",c),{players:o,turnState:"LOADING",logs:le({id:Date.now().toString(),text:"Loading Phase Begun.",type:"neutral"})});return}if(s.status==="playing"&&s.turnState==="ROUND_SUMMARY"&&o.every(i=>i.ready)){await Pt();return}await W(T(_,"artifacts",P,"public","data","rooms",c),{players:o})},Dt=async o=>{if(f.coins<o.cost)return;let i=[...s.deck],h=F(s.currentRoundStats,a.uid,{expense:o.cost,marketItem:o.id});const t=s.players.map(d=>{if(d.id===a.uid){let I=[...d.hand];if(o.id==="POCKETS"&&i.length>0){const p=qe(i,I);p&&I.push(p)}return{...d,hand:I,coins:d.coins-o.cost,upgrades:[...d.upgrades||[],o.id]}}return d});await W(T(_,"artifacts",P,"public","data","rooms",c),{players:t,deck:i,currentRoundStats:h})},$t=async()=>{if(Date.now()-Pe<2e3)return;const o=parseInt(ue);if(isNaN(o)||o<0)return;const i=f.loadedCrate?.bribe||0,h=o-i;if(f.coins-h<0)return;Ct(Date.now());const t=s.players.map(d=>d.id===a.uid?{...d,coins:d.coins-h,loadedCrate:{...d.loadedCrate,bribe:o}}:d);await W(T(_,"artifacts",P,"public","data","rooms",c),{players:t})},Mt=async()=>{const o=f.upgrades?.includes("EXPANDED")?5:4;if(re.length===0||re.length>o)return;const i=Math.max(0,parseInt(ue)||0);if(i>0&&i>f.coins)return;const h=s.players.findIndex(m=>m.id===a.uid),t=[...s.players],d=[...t[h].hand],I=[];[...re].sort((m,$)=>$-m).forEach(m=>{I.push(d[m]),d.splice(m,1)}),t[h].hand=d,t[h].coins-=i,t[h].loadedCrate={cards:I,declaration:at,bribe:i};const p=t[s.inspectorIndex].id,V=t.every(m=>m.id===p||m.loadedCrate!==null);let Q={players:t};V&&(Q.turnState="INSPECTING",Q.logs=le({id:Date.now().toString(),text:"Inspection Phase.",type:"neutral"})),await W(T(_,"artifacts",P,"public","data","rooms",c),Q),Me([]),Ee(0)},Le=async(o,i)=>{const h=s.players[s.inspectorIndex],t=[...s.players],d=t.findIndex(j=>j.id===o),I=t.findIndex(j=>j.id===h.id),p=t[d];if(!p.loadedCrate)return;h.upgrades?.includes("SCANNER");const V=p.upgrades?.includes("CONCEAL"),Q=t.filter(j=>j.role==="SNITCH"&&j.id!==p.id);let m={...s.currentRoundStats};const $=j=>{let k=0,M=0;return j.forEach(K=>{const C=w[K];if(!C)return;let y=C.val,z=y;const O=Array.isArray(q.target)?q.target.includes(K):q.target===K,de=q.target==="ALL_ILLEGAL"&&C.type==="ILLEGAL"||q.target==="ALL_LEGAL"&&C.type==="LEGAL";(O||de)&&(z=Math.floor(y*q.multiplier)),k+=z,M+=z-y}),{total:k,impact:M}},se=(j,k)=>{let M=j.reduce((z,O)=>z+w[O].penalty,0),K=0;k&&p.role==="DIPLOMAT"&&(K=M*.5,M*=.5);let C=M;q.id==="CRACKDOWN"&&(C*=2),q.id==="FREE_TRADE"&&(C*=.5);const y=M-C;return{finalFine:C,roleSavings:K,eventImpact:y}},X=(j,k)=>{const M=t[j];let K=0;if(M.role==="MERCHANT"){const y=k.filter(z=>w[z].type==="LEGAL").reduce((z,O)=>z+(w[O].val||0),0);K=Math.floor(y*.2)}else if(M.role==="YAKUZA"){const y=k.filter(z=>w[z].type==="ILLEGAL").reduce((z,O)=>z+(w[O].val||0),0);K=Math.floor(y*.2)}K>0&&(t[j].coins+=K,t[j].coins=Math.floor(t[j].coins),m=F(m,M.id,{income:K,roleBonus:K,transaction:{label:`${Z[M.role].name} Bonus`,amount:K,detail:"Role ability triggered"}}))};if(i==="PEEK"){if(p.loadedCrate.scanned)return;const j=p.loadedCrate.cards[Math.floor(Math.random()*p.loadedCrate.cards.length)],k=[...t];k[d].loadedCrate={...k[d].loadedCrate,scanned:!0},await W(T(_,"artifacts",P,"public","data","rooms",c),{players:k,logs:le({id:Date.now().toString(),text:`Inspector used scanner in ${p.name}'s crate!`,type:"neutral"}),feedbackTrigger:{id:Date.now(),type:"neutral",message:"SCAN RESULT",subtext:`Found: ${w[j].name}`,visibleTo:h.id}});return}let Y=[],me=null;if(i==="PASS"||i==="ACCEPT_BRIBE"){const j=p.loadedCrate.bribe||0;i==="ACCEPT_BRIBE"&&j>0?(t[I].coins+=j,Y.push({id:Date.now().toString(),text:`Inspector accepted $${j} bribe from ${p.name}.`,type:"bribe"}),m=F(m,h.id,{income:j,transaction:{label:"Bribe Accepted",amount:j,detail:`From ${p.name}`}}),m=F(m,p.id,{expense:j,transaction:{label:"Bribe Paid",amount:-j,detail:`To ${h.name}`}})):(t[d].coins+=j,Y.push({id:Date.now().toString(),text:`Inspector passed ${p.name}.`,type:"success"}),m=F(m,h.id,{transaction:{label:"Pass Decision",amount:0,detail:`Passed ${p.name}`}}),j>0&&(m=F(m,p.id,{income:j,transaction:{label:"Bribe Returned",amount:j}})));const{total:k,impact:M}=$(p.loadedCrate.cards);t[d].coins+=k,m=F(m,p.id,{income:k,eventImpact:M,transaction:{label:"Goods Sold",amount:k,items:p.loadedCrate.cards,detail:M!==0?`Event Impact: ${M>0?"+":""}$${M}`:""}}),t[d].stash.push(...p.loadedCrate.cards),X(d,p.loadedCrate.cards)}else if(i==="OPEN"){const j=p.loadedCrate.bribe||0;t[d].coins+=j,j>0&&(m=F(m,p.id,{income:j,transaction:{label:"Bribe Returned",amount:j}}));const k=p.loadedCrate.cards,M=p.loadedCrate.declaration;if(k.includes("TRAP")){t[I].coins-=200,t[d].coins+=200,m=F(m,h.id,{expense:200,transaction:{label:"Trap Exploded",amount:-200,detail:"Booby Trap triggered"}}),m=F(m,p.id,{income:200,transaction:{label:"Trap Reward",amount:200,detail:"Inspector triggered trap"}});const C=k.filter(O=>O!=="TRAP"),{total:y,impact:z}=$(C);t[d].coins+=y,m=F(m,p.id,{income:y,eventImpact:z,transaction:{label:"Survivors Sold",amount:y,items:C,detail:z!==0?`Event Impact: ${z>0?"+":""}$${z}`:""}}),t[d].stash.push(...C),X(d,C),Y.push({id:Date.now().toString(),text:"BOOM! Booby Trap! Inspector pays $200.",type:"danger"}),me={id:Date.now(),type:"danger",message:"BOOBY TRAP!",subtext:"Inspector blown up."}}else{let C=k.filter(y=>w[y].type==="ILLEGAL"||y!==M);if(V&&C.length>0&&(C.sort((y,z)=>w[y].val-w[z].val),C.pop(),Y.push({id:Date.now().toString(),text:`${p.name}'s Hidden Compartment saved an item!`,type:"neutral"})),C.length===0){const{finalFine:y,eventImpact:z}=se(k,!1);t[I].coins-=y,t[d].coins+=y,m=F(m,h.id,{expense:y,transaction:{label:"Wrongful Search",amount:-y,detail:"Paid compensation"}}),m=F(m,p.id,{income:y,eventImpact:z,transaction:{label:"Clean Bonus",amount:y,detail:"Compensation received"}});const{total:O,impact:de}=$(k);t[d].coins+=O,m=F(m,p.id,{income:O,eventImpact:de,transaction:{label:"Goods Sold",amount:O,items:k,detail:de!==0?`Event Impact: ${de>0?"+":""}$${de}`:""}}),t[d].stash.push(...k),X(d,k),Y.push({id:Date.now().toString(),text:`CLEAN! Inspector pays $${y} fine.`,type:"danger"}),me={id:Date.now(),type:"danger",message:"CLEAN",subtext:"Inspector pays fine."}}else{let y=[],z=[];k.forEach(pe=>{if(C.includes(pe)){y.push(pe);const ye=C.indexOf(pe);ye>-1&&C.splice(ye,1)}else z.push(pe)});const{finalFine:O,roleSavings:de,eventImpact:Bt}=se(y,!0);t[d].coins-=O,t[I].coins+=O,m=F(m,p.id,{expense:O,roleBonus:de,eventImpact:Bt,transaction:{label:"Fine Paid",amount:-O,detail:`Seized: ${y.length} items`}}),m=F(m,h.id,{income:O,transaction:{label:"Fine Collected",amount:O,items:y}});const{total:Re,impact:Oe}=$(z);t[d].coins+=Re,Re>0&&(m=F(m,p.id,{income:Re,eventImpact:Oe,transaction:{label:"Kept Goods Sold",amount:Re,items:z,detail:Oe!==0?`Event Impact: ${Oe>0?"+":""}$${Oe}`:""}})),t[d].stash.push(...z),X(d,z),Q.forEach(pe=>{const ye=t.findIndex(Gt=>Gt.id===pe.id);ye>-1&&(t[ye].coins+=100,m=F(m,pe.id,{income:100,roleBonus:100,transaction:{label:"Snitch Reward",amount:100,detail:`${p.name} busted`}}))}),Y.push({id:Date.now().toString(),text:`BUSTED! ${p.name} pays $${O}. ${y.length} items seized.`,type:"success"}),me={id:Date.now(),type:"success",message:"BUSTED",subtext:"Contraband Seized!"}}}}if(t[d].loadedCrate=null,t.filter(j=>j.id!==h.id&&j.loadedCrate!==null).length===0){const j={stats:m,event:q||ie.NORMAL};await W(T(_,"artifacts",P,"public","data","rooms",c),{players:t,logs:le(...Y),currentRoundStats:m,roundHistory:le(j),turnState:"ROUND_SUMMARY",feedbackTrigger:me})}else await W(T(_,"artifacts",P,"public","data","rooms",c),{players:t,logs:le(...Y),currentRoundStats:m,feedbackTrigger:me})},Pt=async()=>{const o=s.currentRound+1;if(o>Ae){const $=Os(s.players),se=s.players.map(X=>{const Y=$[X.id],me=X.stash.reduce((j,k)=>j+(w[k]?.val||0),0),it=Math.floor(X.coins+me-Qe+Y.income);return{...X,finalScore:it,kqDetails:Y.details,kqIncome:Y.income,ready:!1}}).sort((X,Y)=>Y.finalScore-X.finalScore);await W(T(_,"artifacts",P,"public","data","rooms",c),{players:se,status:"finished",turnState:"IDLE",winner:se[0].name,feedbackTrigger:{id:Date.now(),type:"success",message:"GAME OVER",subtext:`${se[0].name} wins!`}});return}let i=s.inspectorOrder[o-1],h=[...s.deck];const t=Object.keys(ie),d=t[Math.floor(Math.random()*t.length)],I=ie[d];let p=ht(s.players);p[i].role=null;const V=p[i].id,Q={};p.forEach($=>{Q[$.id]={role:$.role,isInspector:$.id===V,income:0,expense:0,transactions:[],marketItems:[],roleBonus:0}});const m=p.map($=>{const se=[...$.hand],X=$.upgrades?.includes("POCKETS")?7:6;for(;se.length<X&&h.length>0;){const Y=qe(h,se);Y&&se.push(Y)}return{...$,hand:se,loadedCrate:null,ready:!1}});await W(T(_,"artifacts",P,"public","data","rooms",c),{players:m,deck:h,inspectorIndex:i,currentRound:o,currentRoundStats:Q,roundHistory:le({stats:s.currentRoundStats,event:s.marketEvent||ie.NORMAL}),turnState:"SHOPPING",marketEvent:I,logs:le({id:Date.now().toString(),text:`Round ${o} Started. Event: ${I.name}`,type:"neutral"})})};if(E)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(pt,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(Ve,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"Border crossing closed. Inspections are paused."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(ct,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(ct,{size:16})]})})})}),e.jsx(Ue,{})]});if(!a)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-green-500 animate-pulse",children:"Moving Shipments..."});if(c&&!s&&!N)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(_e,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(Zt,{size:48,className:"text-green-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(r==="splash")return e.jsx($s,{onStart:Lt});if(r==="menu")return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(_e,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-emerald-800 rounded-lg 
			font-bold shadow-md hover:text-emerald-400 transition-colors w-fit animate-pulse`,children:[e.jsx(Qt,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),J&&e.jsx(ft,{onClose:()=>D(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(be,{size:64,className:"text-emerald-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-linear-to-b from-emerald-400 to-green-700 tracking-widest",children:"CONTRABAND"}),e.jsx("p",{className:"text-white-400/60 tracking-[0.3em] uppercase mt-2",children:"Black Market Edition"})]}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur border border-emerald-500/30 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10",children:[N&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-2 mb-4 rounded text-center text-sm",children:N}),e.jsx("input",{className:"w-full bg-black/50 border border-zinc-600 p-3 rounded mb-4 text-white placeholder-zinc-500 focus:border-emerald-500 outline-none",placeholder:"Alias",value:ce,onChange:o=>At(o.target.value)}),e.jsxs("button",{onClick:Rt,disabled:H,className:"w-full bg-emerald-700 hover:bg-emerald-600 p-4 rounded font-bold mb-4 flex items-center justify-center gap-2 transition-all",children:[e.jsx(gt,{size:20})," Create Syndicate"]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{className:"flex-1 min-w-0 bg-black/50 border border-zinc-600 p-3 rounded text-white placeholder-zinc-500 uppercase tracking-wider",placeholder:"CODE",value:A,onChange:o=>B(o.target.value.toUpperCase())}),e.jsx("button",{onClick:Ot,disabled:H,className:"bg-zinc-800 hover:bg-zinc-700 px-6 rounded font-bold shrink-0",children:"Join"})]}),e.jsxs("button",{onClick:()=>D(!0),className:"w-full text-center text-zinc-500 hover:text-white text-sm mt-2 flex items-center justify-center gap-2",children:[e.jsx(Ke,{size:14})," Smuggler's Guide"]})]}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Sheriff of Nottingham. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),". Visit"," ",e.jsx("a",{href:"/rawfids-gamehub/",rel:"noopener noreferrer",className:"text-emerald-500 underline hover:text-emerald-600",children:"GAMEHUB"})," ","for more games."]})]});if(r==="lobby"&&s)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col items-center justify-center p-6 relative",children:[e.jsx(_e,{}),e.jsx(pt,{}),Ie&&e.jsx(bt,{isHost:Ne,onConfirm:nt,onCancel:()=>ee(!1)}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-zinc-900/90 backdrop-blur p-8 rounded-2xl border border-emerald-900/50 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-green-500 font-bold uppercase",children:"Station:"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:s.roomId}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:_t,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:U?e.jsx(Ge,{size:16,className:"text-green-500"}):e.jsx(Jt,{size:16})}),U&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-green-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsx("button",{onClick:()=>ee(!0),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:e.jsx(Xe,{size:16})})]}),e.jsx("div",{className:"space-y-2 mb-8",children:s.players.map(o=>e.jsxs("div",{className:"flex items-center justify-between bg-zinc-800/50 p-3 rounded border border-zinc-700/50",children:[e.jsxs("span",{className:"font-bold flex items-center gap-2",children:[e.jsx(De,{size:14,className:o.id===a.uid?"text-emerald-500":"text-zinc-500"}),o.name," ",o.id===s.hostId&&e.jsx(ve,{size:14,className:"text-yellow-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-zinc-500 text-xs",children:"Waiting"}),s.hostId===a.uid&&o.id!==a.uid&&e.jsx("button",{onClick:()=>Tt(o.id),className:"p-1.5 bg-zinc-700 hover:bg-red-900/50 text-zinc-400 hover:text-red-400 rounded transition-colors",title:"Kick Player",children:e.jsx(ws,{size:12})})]})]},o.id))}),s.hostId===a.uid&&e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs("div",{className:"bg-zinc-800 p-1 rounded-lg flex items-center",children:[e.jsx("button",{onClick:()=>W(T(_,"artifacts",P,"public","data","rooms",c),{gameLength:"SHORT"}),className:`px-4 py-2 rounded text-xs font-bold transition-all ${s.gameLength==="SHORT"?"bg-emerald-600 text-white":"text-zinc-500 hover:text-zinc-300"}`,children:"SHORT (1x)"}),e.jsx("button",{onClick:()=>W(T(_,"artifacts",P,"public","data","rooms",c),{gameLength:"LONG"}),className:`px-4 py-2 rounded text-xs font-bold transition-all ${s.gameLength==="LONG"?"bg-emerald-600 text-white":"text-zinc-500 hover:text-zinc-300"}`,children:"LONG (2x)"})]})}),e.jsxs("div",{className:"text-center text-xs text-zinc-500 mb-4 uppercase tracking-widest",children:["Game Length: ",s.gameLength||"SHORT"]}),s.hostId===a.uid&&e.jsx("button",{onClick:lt,disabled:s.players.length<3,className:"w-full py-4 bg-emerald-700 hover:bg-emerald-600 rounded-xl font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:s.players.length<3?"Need 3+ Players":"Start Smuggling"})]}),e.jsx(Ue,{})]});if(r==="game"&&s){const o=s.players[s.inspectorIndex],i=s.players.filter(t=>t.id!==s.hostId).every(t=>t.ready),h=f.ready||s.turnState!=="SHOPPING";return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col relative overflow-hidden font-sans",children:[e.jsx(_e,{}),R&&e.jsx(Ts,{type:R.type,message:R.message,subtext:R.subtext,icon:R.type==="danger"?xe:R.type==="bribe"?mt:fs}),J&&e.jsx(ft,{onClose:()=>D(!1)}),je&&e.jsx(Ds,{logs:s.logs,onClose:()=>ke(!1)}),Ie&&e.jsx(bt,{isHost:Ne,onLobby:rt,onConfirm:nt,onCancel:()=>ee(!1)}),oe&&e.jsx(Ls,{stash:f.stash||[],onClose:()=>G(!1)}),Se&&e.jsx(Rs,{player:s.players.find(t=>t.id===Se),onClose:()=>te(null)}),e.jsx(_s,{isOpen:ne,onClose:()=>ze(!1),player:f,onBuy:Dt}),e.jsxs("div",{className:"h-16 bg-zinc-900/90 border-b border-zinc-800 flex items-center justify-between px-4 z-50 backdrop-blur-md sticky top-0 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden md:flex flex-col",children:[e.jsx("span",{className:"text-xs text-zinc-500 uppercase tracking-widest",children:"Event"}),e.jsxs("span",{className:"text-sm font-bold text-yellow-500 flex items-center gap-1",children:[q.id==="WAR"&&e.jsx(tt,{size:14}),q.id==="PANDEMIC"&&e.jsx(jt,{size:14}),q.id==="CRACKDOWN"&&e.jsx(xe,{size:14}),q.name]})]}),e.jsxs("div",{className:"bg-black/40 px-3 py-1 rounded-full border border-zinc-700 flex items-center gap-2",children:[e.jsx($e,{size:14,className:"text-yellow-500"}),e.jsxs("span",{className:"font-mono font-bold",children:["$",f.coins]})]}),e.jsxs("div",{className:"text-xs text-zinc-500 bg-black/50 px-2 py-1 rounded border border-zinc-800 flex items-center gap-1",children:[e.jsx(xs,{size:14}),e.jsxs("span",{children:[s.currentRound,"/",Ae]})]}),e.jsxs("div",{className:"text-xs text-zinc-500 bg-black/50 px-2 py-1 rounded border border-zinc-800 flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-3 bg-zinc-600 rounded-sm"}),s.deck.length]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ke(!je),className:`p-2 rounded-full ${je?"bg-green-900 text-green-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(Nt,{size:20})}),e.jsx("button",{onClick:()=>D(!0),className:"p-2 hover:bg-zinc-800 rounded text-zinc-400",children:e.jsx(Ke,{size:20})}),e.jsx("button",{onClick:()=>ee(!0),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:e.jsx(Xe,{size:20})})]})]}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col items-center relative z-10 max-w-6xl mx-auto w-full gap-6",children:[e.jsx("div",{className:"flex items-center justify-center gap-4",children:e.jsxs("div",{className:`px-6 py-2 rounded-full border flex items-center gap-2 shadow-lg ${s.turnState==="INSPECTING"?"bg-red-900/30 border-red-500 text-red-200":"bg-emerald-900/30 border-emerald-500 text-emerald-200"}`,children:[s.turnState==="SHOPPING"?e.jsx(fe,{size:18}):s.turnState==="LOADING"?e.jsx(be,{size:18}):s.turnState==="ROUND_SUMMARY"?e.jsx(yt,{size:18}):e.jsx(xe,{size:18}),e.jsx("span",{className:"font-bold tracking-wide",children:s.turnState==="SHOPPING"?"MARKET PHASE":s.turnState==="LOADING"?"LOAD CRATES":s.turnState==="ROUND_SUMMARY"?"ROUND REPORT":`INSPECTOR: ${o.name}`})]})}),e.jsx("div",{className:`flex gap-3 justify-center flex-wrap w-full transition-opacity duration-500 ${s.status==="finished"?"opacity-20 pointer-events-none":"opacity-100"}`,children:s.players.map(t=>{if(t.id===a.uid)return null;const d=t.id===o.id;let I=De,p="text-zinc-500",V="Player";return d?(I=xe,p="text-red-500 animate-pulse",V="Inspector"):t.role&&(I=Z[t.role].icon,p=Z[t.role].color,V=Z[t.role].name),e.jsxs("div",{className:`relative bg-zinc-900/90 p-3 rounded-xl border-2 w-32 transition-all flex flex-col items-center ${d?"border-red-500 shadow-[0_0_16px_rgba(239,68,68,0.3)]":"border-zinc-700 shadow-[0_0_16px_rgba(34,197,94,0.3)]"} ${t.loadedCrate?"bg-zinc-800":""}`,children:[e.jsxs("div",{className:"relative flex flex-col items-center pt-4",children:[e.jsxs("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 flex items-center gap-1 opacity-70 text-[9px]",children:[e.jsx(I,{size:12,className:p}),e.jsx("span",{className:"uppercase animate-pulse tracking-tight",children:V})]}),e.jsx(De,{size:24,className:d?"text-red-500":"text-zinc-600"}),e.jsx("span",{className:`font-bold text-xs truncate w-full text-center mt-1 ${d?"text-red-200":"text-zinc-400"}`,children:t.name}),e.jsx("button",{onClick:()=>te(t.id),className:"mt-auto pt-2 w-full",children:e.jsxs("div",{className:"w-full py-1.5 bg-zinc-800 hover:bg-zinc-700 border border-zinc-600 rounded text-[10px] text-zinc-400 hover:text-white transition-colors flex items-center justify-center gap-1 uppercase font-bold tracking-wider",children:[e.jsx(ge,{size:10})," View Stash"]})})]}),t.upgrades&&t.upgrades.length>0&&e.jsx("div",{className:"flex gap-1 justify-center mt-1 flex-wrap",children:t.upgrades.map(Q=>{const m=he[Q];return m?e.jsx("div",{className:"p-0.5 bg-zinc-800 rounded border border-zinc-600 text-yellow-500",title:m.name,children:e.jsx(m.icon,{size:10})},Q):null})}),t.loadedCrate?e.jsxs("div",{className:"mt-2 w-full bg-black/40 rounded p-2 text-center border border-zinc-600",children:[e.jsx("div",{className:"flex justify-center items-center gap-1 mb-1",children:e.jsxs("div",{className:"bg-zinc-700 text-zinc-300 text-[9px] px-1.5 py-0.5 rounded flex items-center gap-1",children:[e.jsx(zt,{size:8})," ",t.loadedCrate.cards.length]})}),e.jsxs("div",{className:"text-[10px] text-zinc-500 uppercase flex justify-center items-center gap-1",children:[w[t.loadedCrate.declaration].name," ",t.loadedCrate.bribe>0&&e.jsx($e,{size:10,className:"text-yellow-500"})]}),Ce&&f.id===o.id&&s.turnState==="INSPECTING"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[e.jsx("button",{onClick:()=>Le(t.id,"PASS"),className:"bg-emerald-700 hover:bg-emerald-600 text-[8px] py-2 rounded text-white font-bold",children:"PASS"}),e.jsx("button",{onClick:()=>Le(t.id,"OPEN"),className:"bg-red-700 hover:bg-red-600 text-[8px] py-2 rounded text-white font-bold",children:"OPEN"}),t.loadedCrate.bribe>0&&e.jsxs("button",{onClick:()=>Le(t.id,"ACCEPT_BRIBE"),className:"col-span-2 bg-yellow-600 hover:bg-yellow-500 text-[9px] py-1 rounded text-black font-bold flex items-center justify-center gap-1",children:["Take $",t.loadedCrate.bribe," Bribe"]}),f.upgrades?.includes("SCANNER")&&!t.loadedCrate.scanned&&e.jsxs("button",{onClick:()=>Le(t.id,"PEEK"),className:"col-span-2 bg-blue-600 hover:bg-blue-500 text-[9px] py-1 rounded text-white font-bold flex items-center justify-center gap-1",children:[e.jsx(It,{size:10})," SCAN"]})]})]}):!d&&e.jsx("div",{className:"mt-2 text-[9px] text-zinc-600 animate-pulse",children:t.ready?"Ready":"Thinking..."})]},t.id)})}),e.jsx("div",{className:`w-full max-w-4xl bg-zinc-900/95 p-4 md:p-6 rounded-t-3xl border-t border-emerald-500/30 backdrop-blur-md mt-auto shadow-[0_-10px_40px_rgba(0,0,0,0.5)] z-20 transition-opacity duration-500 ${s.status==="finished"?"opacity-20 pointer-events-none":"opacity-100"}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2 min-w-[140px]",children:[Ce?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-bold text-lg text-white flex items-center gap-2",children:[e.jsx(xe,{size:18,className:"text-red-500 animate-pulse"}),f.name]}),e.jsx("div",{className:"text-xs text-red-300 font-bold",children:"You are the Inspector. Check crates!"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-bold text-lg text-white flex items-center gap-2",children:[f.role&&dt.createElement(Z[f.role].icon,{size:18,className:Z[f.role].color}),f.name]}),e.jsx("div",{className:"text-xs text-zinc-500",children:Z[f.role]?.desc})]}),e.jsxs("div",{className:"mt-2 border-t border-zinc-700 pt-2",children:[e.jsxs("div",{className:"text-[10px] text-zinc-500 uppercase font-bold mb-1 flex items-center gap-1",children:[e.jsx(rs,{size:10})," Event Active"]}),e.jsx("div",{className:"text-sm font-bold text-yellow-500",children:q.name}),e.jsx("div",{className:"text-[10px] text-zinc-400 leading-tight",children:q.desc})]}),e.jsx("div",{className:"mt-2 flex gap-1 flex-wrap",children:f.upgrades?.map(t=>{const d=he[t].icon;return e.jsx("div",{className:"p-1 bg-zinc-800 rounded border border-zinc-700 text-yellow-500",title:he[t].name,children:e.jsx(d,{size:12})},t)})}),e.jsxs("button",{onClick:()=>G(!0),className:"mt-2 w-full py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-xs text-zinc-300 border border-zinc-600 flex items-center justify-center gap-2 transition-colors",children:[e.jsx(ge,{size:12})," View Stash (",f.stash.length,")"]}),s.turnState==="SHOPPING"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>!h&&ze(!0),disabled:h,className:`mt-2 w-full py-2 rounded text-xs border flex items-center justify-center gap-2 transition-colors ${h?"bg-zinc-800 text-zinc-600 border-zinc-700 cursor-not-allowed":"bg-yellow-900/20 hover:bg-yellow-900/30 text-yellow-500 border-yellow-500/50"}`,children:[e.jsx(fe,{size:12})," Open Black Market"]}),e.jsx("button",{onClick:Be,disabled:f.ready,className:`mt-2 py-2 px-4 rounded font-bold transition-all ${f.ready?"bg-green-600/50 text-white/50 cursor-not-allowed":"bg-zinc-700 text-zinc-300 hover:bg-zinc-600"}`,children:f.ready?"READY":"MARKET DONE"})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto min-h-[160px]",children:Ce?null:f.loadedCrate?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center w-full min-w-0",children:[e.jsx("div",{className:"w-full overflow-x-auto no-scrollbar",children:e.jsx("div",{className:"flex gap-2 w-max mx-auto px-4 py-4 grayscale-[0.3] scale-90 origin-bottom",children:f.loadedCrate.cards.map((t,d)=>e.jsxs("div",{className:"relative group shrink-0 transition-transform hover:-translate-y-2",children:[e.jsx(et,{typeId:t,small:!1}),e.jsx("div",{className:"absolute inset-0 bg-black/20 rounded-xl flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ze,{className:"text-white/80 drop-shadow-md"})})]},d))})}),e.jsxs("div",{className:"flex items-center gap-3 bg-zinc-900/80 px-4 py-2 rounded-full border border-emerald-500/30 text-xs shadow-xl backdrop-blur-md whitespace-nowrap z-20",children:[e.jsxs("span",{className:"flex items-center gap-1 text-emerald-400 font-bold",children:[e.jsx(Ze,{size:12})," LOCKED"]}),e.jsx("div",{className:"w-px h-3 bg-zinc-700"}),e.jsxs("span",{className:"text-zinc-400",children:["Declared:"," ",e.jsx("strong",{className:"text-white",children:w[f.loadedCrate.declaration]?.name})]}),f.loadedCrate.bribe>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-3 bg-zinc-700"}),e.jsxs("span",{className:"flex items-center gap-1 text-yellow-500 font-mono",children:[e.jsx($e,{size:12})," $",f.loadedCrate.bribe]})]})]})]}):s.turnState==="LOADING"?e.jsx("div",{className:"flex gap-2 pb-2",children:f.hand.map((t,d)=>e.jsx(et,{typeId:t,selected:re.includes(d),onClick:()=>{re.includes(d)?Me(re.filter(I=>I!==d)):re.length<(f.upgrades?.includes("EXPANDED")?5:4)&&Me([...re,d])}},d))}):e.jsx("div",{className:"h-full flex items-center justify-center text-zinc-600 italic",children:"Market Phase - Check Shop"})}),!Ce&&s.turnState!=="SHOPPING"&&e.jsxs("div",{className:"min-w-[200px] flex flex-col gap-3",children:[!f.loadedCrate&&s.turnState==="LOADING"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-zinc-800 p-2 rounded-xl border border-zinc-700",children:[e.jsx("label",{className:"text-[10px] text-zinc-500 uppercase font-bold mb-1 block",children:"Declare As"}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:["FOOD","MEDS","TEXTILE","PARTS"].map(t=>e.jsx("button",{onClick:()=>Et(t),className:`p-2 rounded flex items-center justify-center ${at===t?"bg-emerald-600 text-white":"bg-zinc-700 text-zinc-400"}`,children:dt.createElement(w[t].icon,{size:16})},t))})]}),e.jsxs("div",{className:"bg-zinc-800 p-2 rounded-xl border border-zinc-700 flex items-center gap-2",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase font-bold w-12",children:"Bribe"}),e.jsx("input",{type:"range",min:"0",max:Math.max(0,Math.min(f.coins,1e4)),step:"10",value:ue,onChange:t=>Ee(t.target.value),className:"flex-1 accent-yellow-500 h-2 bg-zinc-700 rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"text-xs font-mono text-yellow-500 w-10 text-right",children:["$",ue]})]}),e.jsx("button",{onClick:Mt,disabled:re.length===0,className:"w-full py-3 bg-linear-to-r from-emerald-600 to-green-500 hover:from-emerald-500 hover:to-green-400 disabled:opacity-50 text-white font-bold rounded-xl shadow-lg",children:"LOAD CRATE"})]}),f.loadedCrate&&e.jsxs("div",{className:"bg-zinc-800/80 p-3 rounded-xl border border-yellow-500/30 animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"text-xs font-bold text-white flex items-center gap-2",children:[e.jsx(mt,{size:14,className:"text-yellow-500"})," ","Negotiation"]}),e.jsx("div",{className:"text-[10px] text-zinc-400 uppercase tracking-wider",children:"Active"})]}),e.jsxs("div",{className:"bg-zinc-900 p-2 rounded-lg border border-zinc-700 flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase font-bold w-8",children:"Offer"}),e.jsx("input",{type:"range",min:"0",max:Math.min(1e4,f.coins+(f.loadedCrate?.bribe||0)),step:"10",value:ue,onChange:t=>Ee(t.target.value),className:"flex-1 accent-yellow-500 h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"text-xs font-mono text-yellow-500 w-10 text-right",children:["$",ue]})]}),e.jsx("button",{onClick:$t,disabled:Date.now()-Pe<2e3,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-500 disabled:bg-zinc-700 disabled:text-zinc-500 text-black font-bold rounded-lg text-xs shadow-lg shadow-yellow-900/20 transition-colors flex items-center justify-center gap-2",children:Date.now()-Pe<2e3?e.jsxs(e.Fragment,{children:[e.jsx(ls,{size:12,className:"animate-spin"})," WAIT"]}):"UPDATE OFFER"})]})]})]})}),s.status==="finished"&&e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"w-full max-w-4xl bg-zinc-900 border border-emerald-500/50 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsx("div",{className:"p-6 bg-zinc-950 border-b border-zinc-800 text-center",children:e.jsxs("h2",{className:"text-4xl font-bold text-emerald-400 drop-shadow-md",children:[s.winner," Wins!"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(ut,{players:s.players,roundData:s.roundHistory,isFinal:!0})}),e.jsx("div",{className:"p-6 bg-zinc-950 border-t border-zinc-800 flex justify-center gap-4",children:Ne?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:lt,disabled:!i,className:`px-6 py-3 rounded-xl font-bold text-white shadow-lg transition-all ${i?"bg-emerald-600 hover:bg-emerald-500":"bg-zinc-800 text-zinc-600 cursor-not-allowed"}`,children:"New Game"}),e.jsx("button",{onClick:rt,disabled:!i,className:`px-6 py-3 rounded-xl font-bold text-white transition-all ${i?"bg-zinc-700 hover:bg-zinc-600":"bg-zinc-800 text-zinc-600 cursor-not-allowed"}`,children:"Return Team to Lobby"})]}):e.jsx("button",{onClick:Be,className:`px-8 py-3 rounded-xl font-bold transition-all ${f.ready?"bg-green-600 text-white":"bg-zinc-700 hover:bg-zinc-600 text-white"}`,children:f.ready?"Ready! Waiting for Host...":"Ready for Next Round"})}),Ne&&!i&&e.jsx("div",{className:"pb-4 text-center text-xs text-zinc-500 animate-pulse",children:"Waiting for squad..."})]})}),s.turnState==="ROUND_SUMMARY"&&e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"w-full max-w-4xl bg-zinc-900 border border-zinc-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 bg-zinc-950 border-b border-zinc-800 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Round ",s.currentRound," Complete"]}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-widest",children:s.currentRound>=Ae?"Game Sequence Complete":"Next Event Loading..."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(ut,{players:s.players,roundData:s.roundHistory,isFinal:!1})}),e.jsx("div",{className:"p-6 bg-zinc-950 border-t border-zinc-800 flex justify-center",children:e.jsx("button",{onClick:Be,className:`px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2 ${f.ready?"bg-green-600 text-white shadow-green-900/20":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-900/20"}`,children:f.ready?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{size:20})," Waiting for others..."]}):e.jsx(e.Fragment,{children:s.currentRound>=Ae?e.jsxs(e.Fragment,{children:["Show Final Results ",e.jsx(ve,{size:20})]}):e.jsxs(e.Fragment,{children:["Start Round ",s.currentRound+1," ",e.jsx(ts,{size:20})]})})})}),e.jsx("div",{className:"pb-4 bg-zinc-950 flex justify-center gap-2",children:s.players.map(t=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${t.ready?"bg-green-500":"bg-zinc-700"}`,title:t.name},t.id))})]})})]}),e.jsx(Ue,{})]})}return null}Xt.createRoot(document.getElementById("root")).render(e.jsx(v.StrictMode,{children:e.jsx(Ms,{})}));
