import{i as $e,g as De,a as Oe,r as c,e as Ae,d as g,o as me,j as e,H as Ue,S as xe,u as v,q as B,X as ge,n as Ke,s as We,h as Ye,p as O,t as Ve,m as qe}from"./x-vdu6PxPT.js";import{F as Xe}from"./footprints-B3mhdmGG.js";import{S as Je}from"./skull--JE29QMg.js";import{S as Qe}from"./shield-YRjbg8Vk.js";import{C as je}from"./crown-DhFWzZA3.js";import{L as Ze,S as et,B as ue,C as A,a as tt,b as Y,P as ye}from"./step-back-D7uqsBfy.js";import{S as z}from"./siren-Jq38sc8Q.js";import{S as st}from"./settings-BLesBdFP.js";import{B as U}from"./bot-DG0ASA9H.js";import{U as ve}from"./user-hi-jrCL7.js";import{T as at}from"./trash-2-CC3Hg-Aa.js";import{T as V}from"./trophy-CV5zFLFQ.js";import{C as rt}from"./circle-question-mark-CAkoQTil.js";import{R as Ne}from"./rotate-ccw-B8nxxfV1.js";import{H as lt}from"./house-BdFnrmDF.js";const ot="/rawfids-gamehub/assets/police_cover-6RLeQeNG.png",nt={apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},we=$e(nt),K=De(we),j=Oe(we),y=typeof __app_id<"u"?__app_id:"police-hunt-game",it="3",S={KING:{name:"King",points:10,icon:je,color:"bg-yellow-600",textColor:"text-yellow-400",desc:"The ruler. Always scores high (10 pts)."},POLICE:{name:"Police",points:8,icon:Qe,color:"bg-blue-600",textColor:"text-blue-400",desc:"The enforcer. Must find the criminal to score (8 pts)."},ROBBER:{name:"Robber",points:6,icon:Je,color:"bg-red-600",textColor:"text-red-500",desc:"The heavy criminal. Scores 6 pts if not caught."},THIEF:{name:"Thief",points:4,icon:Xe,color:"bg-red-600",textColor:"text-red-300",desc:"The petty criminal. Scores 4 pts if not caught."}},ct=["Terminator","RoboCop","Wall-E","R2-D2","Jarvis","Ultron","Hal-9000","GLaDOS"],dt=r=>{let x=r.length,f;for(;x!==0;)f=Math.floor(Math.random()*x),x--,[r[x],r[f]]=[r[f],r[x]];return r},M=({isShaking:r})=>e.jsxs("div",{className:`absolute inset-0 overflow-hidden pointer-events-none z-0 ${r?"animate-shake bg-red-900/20":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:[...Array(20)].map((x,f)=>{const m=Object.keys(S),p=S[m[f%m.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(p,{size:32})},f)})}),e.jsx("style",{children:`
      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
      }
      .animate-float { animation: float infinite ease-in-out; }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
      .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    `})]}),W=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(z,{size:12,className:"text-red-500"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-blue-500 uppercase",children:"POLICE HUNT"})]}),fe=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(z,{size:22,className:"text-red-500"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-blue-500 uppercase",children:"POLICE HUNT"})]}),he=({onConfirmLeave:r,onConfirmLobby:x,onCancel:f,isHost:m,inGame:p})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Depart Station?"}),e.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:p?"Leaving now will end the hunt for everyone!":"Leaving the lobby will disconnect you."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:f,className:"bg-slate-700 hover:bg-slate-600 text-white py-3 rounded font-bold transition-colors",children:"Stay (Cancel)"}),p&&m&&e.jsxs("button",{onClick:x,className:"py-3 rounded font-bold transition-colors flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-500 text-white",children:[e.jsx(lt,{size:18})," Return Squad to Lobby"]}),e.jsxs("button",{onClick:r,className:"bg-red-600 hover:bg-red-500 text-white py-3 rounded font-bold transition-colors flex items-center justify-center gap-2",children:[e.jsx(Y,{size:18})," Leave Game"]})]})]})}),be=({onClose:r})=>e.jsx("div",{className:"fixed inset-0 bg-black/95 z-100 flex items-center justify-center p-0 md:p-4 backdrop-blur-md animate-in fade-in",children:e.jsxs("div",{className:"bg-slate-800 md:rounded-2xl w-full max-w-4xl h-full md:h-auto max-h-[90vh] overflow-hidden border-none md:border border-slate-600 shadow-2xl flex flex-col relative",children:[e.jsxs("div",{className:"p-4 md:p-6 border-b border-slate-700 flex justify-between items-center bg-slate-900/50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-black text-transparent bg-clip-text bg-linear-to-r from-red-700 to-blue-600 uppercase tracking-widest",children:"Game Rules"}),e.jsx("span",{className:"text-slate-400 text-xs md:text-sm font-bold tracking-wide",children:"Deduction & Deception"})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-slate-700 rounded-full text-slate-400 hover:text-white transition-colors",children:e.jsx(ge,{size:24})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-8 space-y-8 text-slate-300",children:[e.jsxs("div",{className:"bg-slate-700/50 p-6 rounded-xl border border-slate-600",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(V,{className:"text-yellow-500",size:24})," The Objective"]}),e.jsxs("p",{className:"text-slate-300 leading-relaxed",children:["The goal is to accumulate the highest score after a set number of rounds. Roles are shuffled every round.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"The Twist:"})," The"," ",e.jsx("span",{className:"text-blue-400 font-bold",children:"Police"})," must find the correct criminal. If they succeed, they score points. If they fail, the criminal escapes with the loot!"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(ve,{className:"text-purple-400",size:24})," The Roles"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(S).map(x=>e.jsxs("div",{className:"flex items-start gap-4 bg-slate-700/30 p-4 rounded-xl border border-slate-600",children:[e.jsx("div",{className:"p-3 rounded-xl bg-slate-800 border border-slate-700 shadow-lg",children:e.jsx(x.icon,{className:x.textColor,size:28})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("h4",{className:`font-black text-lg ${x.textColor}`,children:x.name}),e.jsxs("span",{className:"bg-slate-900 px-2 py-0.5 rounded text-xs font-bold text-slate-400",children:[x.points," Pts"]})]}),e.jsx("p",{className:"text-sm text-slate-400 leading-tight",children:x.desc})]})]},x.name))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"text-blue-400",size:24})," How It Works"]}),e.jsxs("div",{className:"space-y-4 text-sm md:text-base border-l-2 border-slate-600 pl-4",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block mb-1",children:"1. Assignment"}),"Each player is secretly assigned a role: King, Police, Robber, or Thief."]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block mb-1",children:"2. The Hunt"}),"The ",e.jsx("span",{className:"text-blue-400 font-bold",children:"Police"}),' must reveal themselves and guess who holds a specific criminal card (e.g., "Find the Robber").']}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block mb-1",children:"3. Scoring"}),e.jsxs("ul",{className:"list-disc pl-5 mt-1 space-y-1 text-slate-400",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-yellow-400",children:"King:"})," Always gets"," ",e.jsx("strong",{children:"10 pts"}),"."]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-blue-400",children:"Police:"})," Gets"," ",e.jsx("strong",{children:"8 pts"})," if they guess correctly."," ",e.jsx("strong",{children:"0 pts"})," if wrong."]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-red-400",children:"Criminals:"})," Get points (6 or 4) only if the Police guesses ",e.jsx("strong",{children:"WRONG"}),". If caught, they get ",e.jsx("strong",{children:"0 pts"}),"."]})]})]})]})]})]}),e.jsx("div",{className:"p-4 md:p-6 bg-slate-900 border-t border-slate-700 text-center",children:e.jsx("button",{onClick:r,className:"w-full md:w-auto bg-blue-600 hover:bg-blue-500 text-white px-12 py-3 rounded-xl font-bold text-lg shadow-lg transition-all",children:"Let's Play!"})})]})}),pe=({type:r="gold"})=>{const[x,f]=c.useState([]);return c.useEffect(()=>{const m=r==="gold"?["#FFD700","#FFA500","#FFFF00","#B8860B"]:["#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF"],p=50,C=[];for(let d=0;d<p;d++)C.push({id:d,x:Math.random()*100,y:-10,color:m[Math.floor(Math.random()*m.length)],delay:Math.random()*.5,duration:1+Math.random()*2,left:Math.random()*100});f(C)},[r]),e.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50 overflow-hidden",children:[x.map(m=>e.jsx("div",{className:"absolute w-2 h-2 rounded-full opacity-80 animate-fall",style:{left:`${m.left}%`,backgroundColor:m.color,animationDuration:`${m.duration}s`,animationDelay:`${m.delay}s`,top:"-10px"}},m.id)),e.jsx("style",{children:`
        @keyframes fall {
          0% { transform: translateY(0) rotate(0deg); opacity: 1; }
          100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        .animate-fall {
          animation-name: fall;
          animation-timing-function: linear;
          animation-fill-mode: forwards;
        }
      `})]})},mt=({onStart:r})=>{const[x,f]=c.useState(!1),[m,p]=c.useState(!1),[C,d]=c.useState(!1);return c.useEffect(()=>{d(!0);const I=localStorage.getItem("police_room_id");f(!!I);const t=setTimeout(()=>{p(!0)},2e3);return()=>clearTimeout(t)},[]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-black flex flex-col items-center justify-end pb-20 md:justify-center md:pb-0 font-sans overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e.jsx("div",{className:`w-full h-full bg-cover bg-center transition-transform duration-[2000ms] ease-out ${C?"scale-100":"scale-130"}`,style:{backgroundImage:`url(${ot})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40"})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-8 animate-in fade-in slide-in-from-bottom-10 duration-1000",children:e.jsx("div",{className:`transform transition-all duration-1000 ease-out ${m?"translate-y-0 opacity-100":"translate-y-20 opacity-0"}`,children:e.jsxs("button",{onClick:r,className:"group relative px-12 py-5 bg-red-600/20 hover:bg-red-600/40 border border-red-500/50 hover:border-red-400 text-red-300 font-black text-2xl tracking-widest rounded-none transform transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.4)] backdrop-blur-md overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-red-400/10 to-transparent translate-y-[-100%] animate-[scan_2s_infinite_linear]"}),e.jsx("span",{className:"relative z-10 flex items-center gap-3 animate-pulse",children:x?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"animate-spin-slow"})," RESUME"]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{})," PLAY"]})})]})})}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(200%); }
        }
      `})]})};function xt(){const[r,x]=c.useState(null),[f,m]=c.useState("splash"),[p,C]=c.useState(""),[d,I]=c.useState(""),[t,Se]=c.useState(null),[H,E]=c.useState(""),[q,T]=c.useState(!1),[Re,L]=c.useState(!1),[X,G]=c.useState(!1),[Ie,J]=c.useState(!1),[Q,Z]=c.useState(!1),[ee,te]=c.useState(25),[$,se]=c.useState(""),[ae,k]=c.useState(!1),[ke,re]=c.useState(!1),[Ce,le]=c.useState(!1),[oe,F]=c.useState(!1),[w,Ee]=c.useState(()=>localStorage.getItem("gameHub_playerName")||"");c.useEffect(()=>{w&&localStorage.setItem("gameHub_playerName",w)},[w]),c.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await Ke(K,__initial_auth_token):await We(K))();const a=Ae(K,o=>x(o));return()=>a()},[]);const Pe=()=>{const s=localStorage.getItem("police_room_id");s&&(T(!0),I(s)),m("menu")};if(c.useEffect(()=>{if(!d||!r)return;const s=g(j,"artifacts",y,"public","data","rooms",d),a=me(s,o=>{if(o.exists()){const n=o.data();if(Se({id:o.id,...n}),!n.players.some(b=>b.id===r.uid)){I(null),m("menu"),E("You were removed from the Station."),localStorage.removeItem("police_room_id"),localStorage.removeItem("police_player_name");return}n.status==="playing"||n.status==="finished"?m("game"):(m("lobby"),L(!1))}else I(null),m("menu"),E("The Station has been closed! (Room Deleted)"),localStorage.removeItem("police_room_id"),localStorage.removeItem("police_player_name")});return()=>a()},[d,r]),c.useEffect(()=>{if(!t||!r)return;const s=t.players.find(n=>n.id===r.uid);if(!s)return;const a=t.gameInstanceId||"default",o=`${t.id}-${a}-${t.currentRound}`;if(t.turnState==="GUESSING"&&s.currentRole==="KING"){const n=`king-${o}`;sessionStorage.getItem(n)||(le(!0),setTimeout(()=>le(!1),3e3),sessionStorage.setItem(n,"true"))}if(t.turnState==="RESULT"){const n=`result-${o}`;if(!sessionStorage.getItem(n)){sessionStorage.setItem(n,"true");const i=t.roundHistory[t.roundHistory.length-1];if(!i)return;const b=i.winner==="Police",P=s.currentRole==="POLICE",l=s.currentRole===i.target;b?P?(re(!0),setTimeout(()=>re(!1),4e3)):l&&(F(!0),setTimeout(()=>F(!1),500)):P&&(F(!0),setTimeout(()=>F(!1),500))}}t.status==="finished"&&L(!0)},[t,r]),c.useEffect(()=>{if(!(!t||!r||t.hostId!==r.uid)){if(t.turnState==="GUESSING"){const s=t.players.find(a=>a.currentRole==="POLICE");if(s&&s.isBot){const a=setTimeout(()=>{const o=t.players.filter(i=>i.id!==s.id&&i.currentRole!=="KING"),n=o[Math.floor(Math.random()*o.length)];n&&ce(n.id)},2500);return()=>clearTimeout(a)}}if(t.turnState==="RESULT"){const s=t.players.filter(o=>!o.isBot);(t.readyPlayers?.length||0)>=s.length&&s.length>0&&setTimeout(()=>ie(),500)}}},[t?.turnState,t?.readyPlayers?.length]),c.useEffect(()=>{const s=me(g(j,"game_hub_settings","config"),a=>{a.exists()&&(a.data()[it]?.maintenance?J(!0):J(!1))});return()=>s()},[]),Ie)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(fe,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(Ue,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"All units return to HQ. Shift change in progress."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(xe,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(xe,{size:16})]})})})}),e.jsx(W,{})]});const _e=async()=>{if(!r||!w.trim())return E("Enter nickname.");T(!0);const s="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let a="";for(let i=0;i<6;i++)a+=s.charAt(Math.floor(Math.random()*s.length));const o=g(j,"artifacts",y,"public","data","rooms",a),n={hostId:r.uid,gameInstanceId:Date.now(),maxPlayers:4,maxRounds:25,currentRound:0,status:"lobby",players:[{id:r.uid,name:w,isBot:!1,totalScore:0,currentRole:null,roundScore:0}],roundHistory:[],readyPlayers:[],gameReadyPlayers:[],turnState:"IDLE",roundTarget:null};try{await Ye(o,n),localStorage.setItem("police_room_id",a),localStorage.setItem("police_player_name",w),I(a),te(25)}catch{E("Failed to create room.")}T(!1)},Te=async()=>{if(!r||!p||!w.trim())return E("Enter details.");T(!0);const s=g(j,"artifacts",y,"public","data","rooms",p);try{const a=await O(s);if(!a.exists())throw new Error("Room not found.");const o=a.data();if(o.players.length>=4&&!o.players.some(i=>i.id===r.uid))throw new Error("Room full.");o.players.find(i=>i.id===r.uid)||await v(s,{players:B({id:r.uid,name:w,isBot:!1,totalScore:0,currentRole:null,roundScore:0})}),localStorage.setItem("police_room_id",p),localStorage.setItem("police_player_name",w),I(p)}catch(a){E(a.message)}T(!1)},D=async()=>{if(!(!d||!r)){try{const s=g(j,"artifacts",y,"public","data","rooms",d),a=await O(s);if(a.exists()){const o=a.data();if(o.hostId===r.uid)await Ve(s);else if(o.status==="lobby"){const i=o.players.filter(b=>b.id!==r.uid);await v(s,{players:i})}else await ze(s,o)}}catch(s){console.error(s)}localStorage.removeItem("police_room_id"),localStorage.removeItem("police_player_name"),I(null),m("menu"),k(!1)}},ze=async(s,a)=>{await v(s,{status:"finished",players:a.players.filter(o=>o.id!==r.uid)})},Le=async s=>{if(!(!d||!r))try{const a=g(j,"artifacts",y,"public","data","rooms",d),o=await O(a);if(o.exists()){const i=o.data().players.filter(b=>b.id!==s);await v(a,{players:i})}}catch(a){console.error(a)}},Ge=()=>{const s=d,a=()=>{Z(!0),setTimeout(()=>Z(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",A)};try{navigator.clipboard.writeText(s),a()}catch{const n=document.createElement("textarea");n.value=s,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),a()}},ne=async()=>{if(!t||t.hostId!==r.uid)return;const s=t.players.map(a=>({...a,totalScore:0,currentRole:null,roundScore:0}));await v(g(j,"artifacts",y,"public","data","rooms",d),{gameInstanceId:Date.now(),currentRound:0,status:"lobby",players:s,roundHistory:[],readyPlayers:[],gameReadyPlayers:[],turnState:"IDLE"}),k(!1)},Fe=async()=>{if(!d||!r||t.hostId!==r.uid)return;const s=parseInt(ee);if(s<5||s>200||isNaN(s)){se("Min 5, Max 200 rounds.");return}se(""),await v(g(j,"artifacts",y,"public","data","rooms",d),{maxRounds:s})},Be=async()=>{const s=g(j,"artifacts",y,"public","data","rooms",d);t.readyPlayers?.includes(r.uid)||await v(s,{readyPlayers:B(r.uid)})},ie=async()=>{if(t.currentRound>=t.maxRounds){await v(g(j,"artifacts",y,"public","data","rooms",d),{status:"finished"});return}const s=dt(["KING","POLICE","ROBBER","THIEF"]),a=t.currentRound+1,o=a%2!==0?"THIEF":"ROBBER",n=t.players.map((i,b)=>({...i,currentRole:s[b],roundScore:0}));await v(g(j,"artifacts",y,"public","data","rooms",d),{status:"playing",currentRound:a,turnState:"GUESSING",roundTarget:o,players:n,readyPlayers:[],lastRoundResult:null})},ce=async s=>{const a=t.players.find(l=>l.id===s),o=t.roundTarget;let n=[...t.players],i="",b=!1;a.currentRole===o?(b=!0,i={type:"success",title:"SUCCESS!",body:`Police caught the ${S[o].name}, ${a.name}.`},n=n.map(l=>{let u=0;return l.currentRole==="KING"?u=10:l.currentRole==="POLICE"?u=8:l.currentRole===o?u=0:u=S[l.currentRole].points,{...l,roundScore:u,totalScore:l.totalScore+u}})):(b=!1,S[a.currentRole].name,i={type:"fail",title:"FAILED!",body:`Police wrongly accused ${a.name} as ${S[o].name}`},n=n.map(l=>{let u=0;return l.currentRole==="KING"?u=10:l.currentRole==="POLICE"?u=0:u=S[l.currentRole].points,{...l,roundScore:u,totalScore:l.totalScore+u}}));const P={round:t.currentRound,target:t.roundTarget,winner:b?"Police":"Criminals",scores:n.map(l=>({name:l.name,role:l.currentRole,score:l.roundScore}))};await v(g(j,"artifacts",y,"public","data","rooms",d),{players:n,turnState:"RESULT",lastRoundResult:i,roundHistory:B(P)})},Me=async()=>{const s=t.players.map(a=>({...a,totalScore:0,currentRole:null,roundScore:0}));await v(g(j,"artifacts",y,"public","data","rooms",d),{gameInstanceId:Date.now(),currentRound:0,status:"lobby",players:s,roundHistory:[],readyPlayers:[],gameReadyPlayers:[],turnState:"IDLE"})},He=async()=>{const s=`bot-${Date.now()}`,a=t.players.map(i=>i.name),o=ct.filter(i=>!a.includes(i)),n=o.length>0?o[0]:`Bot ${t.players.length+1}`;await v(g(j,"artifacts",y,"public","data","rooms",d),{players:B({id:s,name:n,isBot:!0,totalScore:0,currentRole:null,roundScore:0})})};if(!r)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-blue-500 animate-pulse",children:"Siren wailing..."});if(d&&!t&&!H)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(M,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(Ze,{size:48,className:"text-blue-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(f==="splash")return e.jsx(mt,{onStart:Pe});if(f==="menu")return e.jsxs("div",{className:"min-h-screen bg-slate-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(M,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-blue-800 rounded-lg 
			font-bold shadow-md hover:text-blue-400 transition-colors w-fit animate-pulse`,children:[e.jsx(et,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),X&&e.jsx(be,{onClose:()=>G(!1)}),e.jsxs("div",{className:"z-10 mb-10 text-center",children:[e.jsx(z,{size:64,className:"text-red-700 mx-auto mb-4 animate-bounce drop-shadow-[0_0_15px_rgba(59,130,246,0.5)]"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-linear-to-b from-red-700 to-blue-600 font-serif tracking-widest drop-shadow-md",children:"POLICE HUNT"}),e.jsx("p",{className:"text-slate-400 tracking-[0.3em] uppercase mt-2 font-bold",children:"The Heist"})]}),e.jsxs("div",{className:"max-w-md w-full bg-slate-800/90 backdrop-blur border border-slate-600 p-8 rounded-2xl shadow-2xl z-10 animate-in slide-in-from-bottom-10 duration-700 delay-100",children:[H&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-3 rounded mb-4 text-sm text-center border border-red-800",children:H}),e.jsx("input",{className:"w-full bg-slate-900 border border-slate-600 p-3 rounded mb-4 text-white placeholder-slate-500 focus:border-blue-500 outline-none transition-colors",placeholder:"Your Nickname",value:w,onChange:s=>Ee(s.target.value)}),e.jsxs("button",{onClick:_e,disabled:q,className:"w-full bg-linear-to-r from-yellow-600 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 p-4 rounded-xl font-bold mb-4 flex items-center justify-center gap-2 border border-yellow-500/30 shadow-[0_0_15px_rgba(234,179,8,0.2)] transition-all text-black",children:[e.jsx(z,{size:20})," Generate Crime Scene"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx("input",{className:"w-full sm:flex-1 bg-slate-900 border border-slate-600 p-3 rounded text-white placeholder-slate-500 uppercase font-mono tracking-wider focus:border-blue-500 outline-none",placeholder:"ROOM CODE",value:p,onChange:s=>C(s.target.value.toUpperCase())}),e.jsx("button",{onClick:Te,disabled:q,className:"w-full sm:w-auto bg-blue-700 hover:bg-blue-600 border border-blue-500 px-6 py-3 rounded font-bold transition-colors shadow-lg",children:"Join"})]}),e.jsxs("button",{onClick:()=>G(!0),className:"w-full mt-4 text-sm text-slate-400 hover:text-white flex items-center justify-center gap-2 py-2 transition-colors",children:[e.jsx(ue,{size:16})," Penal Codes"]})]}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Chor, Dakaat, Babu, Police. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),". Visit"," ",e.jsx("a",{href:"/rawfids-gamehub/",rel:"noopener noreferrer",className:"text-blue-500 underline hover:text-blue-600",children:"GAMEHUB"})," ","for more games."]})]});if(f==="lobby"&&t){const s=t.hostId===r.uid;return e.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4 flex flex-col items-center relative overflow-hidden",children:[e.jsx(M,{}),e.jsx(fe,{}),ae&&e.jsx(he,{onConfirmLeave:D,onConfirmLobby:()=>{ne(),k(!1)},onCancel:()=>k(!1),isHost:s,inGame:!1}),e.jsxs("div",{className:"w-full max-w-lg z-10 bg-slate-800/90 p-8 rounded-2xl border border-slate-700 shadow-2xl mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-slate-700 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-blue-500 font-bold uppercase",children:"Station"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:t.id}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:Ge,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:Q?e.jsx(A,{size:16,className:"text-green-500"}):e.jsx(tt,{size:16})}),Q&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-blue-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsx("button",{onClick:()=>k(!0),className:"bg-slate-700 p-2 rounded hover:bg-red-900/50 text-red-500 transition-colors",title:"Leave Room",children:e.jsx(Y,{size:20})})]}),e.jsx("div",{className:"bg-slate-900/50 rounded-xl p-4 mb-6 border border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 font-bold uppercase text-xs tracking-wider",children:[e.jsx(st,{size:16})," Rounds"]}),t.hostId===r.uid?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("input",{type:"number",className:"bg-slate-800 text-center w-20 p-2 rounded border border-slate-600 focus:border-yellow-500 outline-none font-bold",value:ee,onChange:a=>te(a.target.value),onBlur:Fe,min:"5",max:"200"}),$&&e.jsx("span",{className:"text-red-400 text-[10px] mt-1",children:$})]}):e.jsx("div",{className:"font-black text-2xl text-yellow-500",children:t.maxRounds})]})}),e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-6 mb-6 border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between mb-4 text-xs font-bold text-slate-500 uppercase",children:[e.jsx("span",{children:"Squad"}),e.jsxs("span",{children:[t.players.length," / 4"]})]}),t.players.map(a=>e.jsxs("div",{className:"flex items-center justify-between bg-slate-800 p-3 rounded mb-2 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${a.isBot?"bg-purple-600":"bg-slate-600"}`,children:a.isBot?e.jsx(U,{size:16}):e.jsx(ve,{size:16})}),e.jsxs("span",{className:a.id===r.uid?"text-yellow-400 font-bold":"text-white",children:[a.name," ",a.id===t.hostId&&"ðŸ‘‘"]})]}),t.hostId===r.uid&&a.id!==r.uid&&e.jsx("button",{onClick:()=>Le(a.id),className:"p-2 hover:bg-red-900/50 rounded text-red-400 transition-colors",title:"Kick Player",children:e.jsx(at,{size:16})})]},a.id))]}),t.hostId===r.uid?e.jsxs(e.Fragment,{children:[t.players.length<4&&e.jsxs("button",{onClick:He,className:"w-full py-3 mb-4 rounded-xl border-2 border-dashed border-slate-600 text-slate-400 hover:bg-slate-800 flex items-center justify-center gap-2",children:[e.jsx(U,{size:18})," Add AI Bot"]}),e.jsxs("button",{onClick:ie,disabled:t.players.length!==4||!!$,className:"w-full bg-green-600 hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed py-4 rounded-xl font-bold text-lg shadow-lg flex items-center justify-center gap-2",children:[e.jsx(ye,{size:20})," Start Game"]})]}):e.jsx("div",{className:"text-center text-slate-400 animate-pulse italic",children:"Waiting for Captain to start..."})]}),e.jsx(W,{})]})}if(f==="game"&&t){const s=t.players.find(l=>l.id===r.uid);if(!s)return null;const a=t.players.find(l=>l.currentRole==="POLICE"),o=s.currentRole==="POLICE",n=t.readyPlayers?.includes(r.uid),i=t.players.filter(l=>!l.isBot).length,b=t.readyPlayers?.length||0,P=t.hostId===r.uid;return e.jsxs("div",{className:`min-h-screen bg-slate-950 text-white flex flex-col relative overflow-hidden transition-transform duration-100 font-sans ${oe?"translate-x-1":""}`,children:[e.jsx(M,{}),oe&&e.jsx("div",{className:"absolute inset-0 bg-red-500/20 z-40 pointer-events-none"}),ke&&e.jsx(pe,{type:"colorful"}),Ce&&e.jsx(pe,{type:"gold"}),ae&&e.jsx(he,{onCancel:()=>k(!1),onConfirmLeave:D,onConfirmLobby:()=>{ne(),k(!1)},isHost:P,inGame:!0}),X&&e.jsx(be,{onClose:()=>G(!1)}),e.jsxs("div",{className:"bg-slate-800/90 backdrop-blur-md p-3 flex justify-between items-center shadow-lg z-10 border-b border-slate-700",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 font-bold uppercase tracking-wide",children:"Round"}),e.jsxs("div",{className:"font-bold text-xl leading-none text-blue-400",children:[t.currentRound," ",e.jsxs("span",{className:"text-slate-500 text-sm",children:["/ ",t.maxRounds]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(!0),className:"bg-slate-700 p-2 rounded hover:bg-slate-600 text-slate-300",title:"Game Rules",children:e.jsx(ue,{size:20})}),e.jsx("button",{onClick:()=>L(!0),className:"bg-slate-700 p-2 rounded hover:bg-slate-600 text-slate-300",title:"Scoreboard",children:e.jsx(V,{size:20})}),e.jsx("button",{onClick:()=>k(!0),className:"bg-slate-700 p-2 rounded hover:bg-red-900/50 hover:text-red-400 transition-colors text-slate-300",title:"Leave Game",children:e.jsx(Y,{size:20})})]})]}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col items-center justify-center gap-6 z-10",children:[e.jsx("div",{className:"text-center mb-4 w-full max-w-md",children:t.status==="finished"?e.jsx("div",{className:"text-3xl font-bold text-yellow-400 animate-bounce",children:"GAME OVER"}):t.turnState==="GUESSING"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-slate-400 text-sm uppercase tracking-widest mb-1",children:"Mission"}),e.jsxs("div",{className:"text-2xl font-bold mb-2",children:["Find"," ",e.jsx("span",{className:t.roundTarget==="THIEF"?"text-red-300":"text-red-500",children:t.roundTarget})]}),e.jsx("div",{className:"text-sm bg-slate-800/80 p-2 rounded-lg border border-slate-700 animate-pulse text-blue-300 backdrop-blur-sm",children:o?"Click a player to guess!":`${a?.name} is investigating...`})]}):e.jsxs("div",{className:"bg-slate-800/90 backdrop-blur px-6 py-4 rounded-xl border border-slate-600 shadow-xl w-full",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-lg font-bold mb-1 text-center ${t.lastRoundResult.type==="success"?"text-green-500":"text-red-500"}`,children:t.lastRoundResult.title}),e.jsx("br",{}),t.lastRoundResult.body]}),t.status!=="finished"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("button",{onClick:Be,disabled:n,className:`w-full py-3 rounded-lg font-bold transition-all ${n?"bg-slate-600 text-slate-400":"bg-green-600 hover:bg-green-500 text-white shadow-lg hover:scale-105"}`,children:n?"Waiting for others...":"Ready for Next Round"}),e.jsxs("div",{className:"text-xs text-center mt-2 text-slate-500",children:[b,"/",i," Players Ready"]})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 w-full max-w-md",children:t.players.map(l=>{let u=l.currentRole,N=!0;(t.turnState==="RESULT"||t.status==="finished"||u==="KING"||u==="POLICE"||l.id===r.uid)&&(N=!1);const R=u?S[u]:null,h=o&&t.turnState==="GUESSING"&&N,_=l.id===r.uid;return e.jsxs("div",{onClick:()=>h?ce(l.id):null,className:`
                                relative p-4 rounded-xl border-2 flex flex-col items-center justify-center aspect-3/4 transition-all backdrop-blur-sm bg-slate-800/80
                                ${_?"bg-slate-800/90 shadow-[0_0_20px_rgba(6,182,212,0.4)] border-green-400 ring-2 ring-cyan-400/30 transform scale-105 z-10":h?"cursor-pointer hover:scale-105 border-red-400 bg-red-900/20 shadow-[0_0_15px_rgba(248,113,113,0.5)]":"border-slate-700"}
                            `,children:[e.jsxs("div",{className:`font-bold text-sm mb-2 truncate w-full text-center flex items-center justify-center gap-1 ${_?"text-cyan-300":"text-white"}`,children:[l.isBot&&e.jsx(U,{size:12,className:"text-purple-400"}),l.name," ",_&&"(You)"]}),N?e.jsxs("div",{className:"flex-1 flex items-center justify-center",children:[e.jsx(rt,{size:48,className:"text-slate-600"}),e.jsx("div",{className:"absolute bottom-4 text-xs font-bold text-slate-500",children:"UNKNOWN"})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center animate-in fade-in zoom-in duration-300",children:[e.jsx(R.icon,{size:48,className:R.textColor}),e.jsx("div",{className:`mt-2 font-black uppercase ${R.textColor}`,children:R.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:[R.points," pts"]})]}),t.turnState==="RESULT"&&e.jsx("div",{className:`absolute -top-2 -right-2 w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs border-2 border-slate-900 shadow-lg ${l.roundScore>0?"bg-green-500":"bg-red-500"}`,children:l.roundScore}),t.turnState==="RESULT"&&t.readyPlayers?.includes(l.id)&&e.jsx("div",{className:"absolute bottom-2 right-2 text-green-500 bg-slate-900 rounded-full",children:e.jsx(A,{size:16})})]},l.id)})}),e.jsxs("div",{className:"mt-auto bg-slate-800/90 backdrop-blur w-full max-w-md p-4 rounded-xl border border-slate-700 flex justify-between items-center shadow-lg",children:[e.jsx("span",{className:"text-slate-400 text-sm font-bold uppercase",children:"My Score"}),e.jsx("span",{className:"text-3xl font-black text-yellow-500",children:s.totalScore})]})]}),Re&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-800 w-full max-w-2xl max-h-[85vh] rounded-2xl flex flex-col border border-slate-700 shadow-2xl relative",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(V,{className:"text-yellow-400"})," Scoreboard"]}),t.status!=="finished"&&e.jsx("button",{onClick:()=>L(!1),children:e.jsx(ge,{})})]}),(()=>{const l=[...t.players].sort((h,_)=>_.totalScore-h.totalScore),u=l[0]?.totalScore||0,N=l.filter(h=>h.totalScore===u),R=N.length>1;return e.jsxs(e.Fragment,{children:[t.status==="finished"&&e.jsxs("div",{className:"bg-linear-to-r from-yellow-600 to-yellow-800 p-4 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-yellow-200 uppercase tracking-widest",children:R?"Champions":"Champion"}),e.jsx("div",{className:"text-3xl font-black text-white drop-shadow-md",children:N.map(h=>h.name).join(" & ")})]}),e.jsxs("div",{className:"p-4 bg-slate-900/50",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs font-bold text-slate-500 uppercase mb-2 text-center",children:[e.jsx("div",{className:"text-left pl-2",children:"Player"}),e.jsx("div",{children:"Role"}),e.jsx("div",{children:"Last"}),e.jsx("div",{children:"Total"})]}),l.map((h,_)=>{const de=t.status==="finished"&&h.totalScore===u;return e.jsxs("div",{className:`grid grid-cols-4 gap-2 p-3 rounded mb-1 items-center text-center ${de?"bg-yellow-900/30 border border-yellow-500/50":"bg-slate-700"}`,children:[e.jsxs("div",{className:"text-left font-bold truncate flex items-center gap-1",children:[de&&e.jsx(je,{size:12,className:"text-yellow-400"})," ",h.name]}),e.jsx("div",{className:"text-xs opacity-70",children:h.currentRole?S[h.currentRole].name:"-"}),e.jsxs("div",{className:`font-bold ${h.roundScore>0?"text-green-400":"text-slate-500"}`,children:["+",h.roundScore]}),e.jsx("div",{className:"font-black text-yellow-400 text-lg",children:h.totalScore})]},h.id)})]})]})})(),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-2",children:"History"}),[...t.roundHistory||[]].reverse().map((l,u)=>e.jsxs("div",{className:"mb-2 text-sm border-b border-slate-700 pb-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-1",children:[e.jsxs("span",{children:["Round ",l.round," â€¢ Hunted ",l.target]}),e.jsxs("span",{className:l.winner==="Police"?"text-blue-400":"text-red-400",children:[l.winner," Won"]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:l.scores.map((N,R)=>e.jsxs("div",{className:"bg-slate-800 p-1 rounded text-center",children:[e.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:N.name}),e.jsxs("div",{className:`font-bold text-xs ${N.score>0?"text-green-400":"text-slate-600"}`,children:["+",N.score]})]},R))})]},u))]}),t.status==="finished"&&e.jsx("div",{className:"p-4 border-t border-slate-700 bg-slate-800 rounded-b-2xl",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[t.hostId===r.uid?e.jsxs("button",{onClick:Me,className:"w-full bg-green-600 hover:bg-green-500 py-3 rounded-xl font-bold flex items-center justify-center gap-2 text-lg shadow-lg",children:[e.jsx(Ne,{})," Play Again"]}):e.jsx("div",{className:"text-center text-slate-400 italic",children:"Waiting for Host to restart..."}),e.jsx("button",{onClick:D,className:"w-full bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold text-white border border-slate-500",children:"Exit to Menu"})]})})]})}),e.jsx(W,{})]})}return e.jsx("div",{className:"text-white text-center p-10",children:"Loading Game Resources..."})}qe.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(xt,{})}));
