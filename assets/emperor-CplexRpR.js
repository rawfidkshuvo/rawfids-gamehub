import{c as he,i as rt,g as at,a as lt,r as g,e as nt,o as $e,d as R,j as e,H as ot,S as Oe,q as te,u as D,n as it,s as dt,h as ct,p as Pe,t as mt,X as Be,m as xt}from"./x-vdu6PxPT.js";import{U as ut}from"./utensils-CuQPaDLA.js";import{C as U}from"./crown-DhFWzZA3.js";import{S as be}from"./sword-B_tdzrAl.js";import{G as pt}from"./gem-CsLWdnoM.js";import{L as gt,S as ft,B as Ae,C as De,a as ht,b as Ge}from"./step-back-DgPuYW0s.js";import{U as J}from"./user-hi-jrCL7.js";import{T as X}from"./trash-2-CC3Hg-Aa.js";import{T as Me}from"./triangle-alert-CO8fZ1I9.js";import{S as ye}from"./scale-CZFdUGY8.js";import{G as je}from"./gift-D4oExXx0.js";import{E as Q}from"./eye-off-D-xHY3rk.js";import{T as fe}from"./trophy-CV5zFLFQ.js";import{C as Fe}from"./check-CGP4nRzB.js";import{R as He}from"./rotate-ccw-B8nxxfV1.js";import{H as Ue}from"./history-r3RmdCN7.js";import{L as bt}from"./layers-DEJ-WQdn.js";import{E as yt}from"./eye-ByZgRM3i.js";import{H as jt}from"./house-BdFnrmDF.js";import{S as wt}from"./shield-YRjbg8Vk.js";const vt=[["path",{d:"M10 5V3",key:"1y54qe"}],["path",{d:"M14 5V3",key:"m6isi"}],["path",{d:"M15 21v-3a3 3 0 0 0-6 0v3",key:"lbp5hj"}],["path",{d:"M18 3v8",key:"2ollhf"}],["path",{d:"M18 5H6",key:"98imr9"}],["path",{d:"M22 11H2",key:"1lmjae"}],["path",{d:"M22 9v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9",key:"1rly83"}],["path",{d:"M6 3v8",key:"csox7g"}]],Nt=he("castle",vt);const kt=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],It=he("heart-pulse",kt);const Ct=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],St=he("scroll",Ct),Rt={apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},qe=rt(Rt),ue=at(qe),T=lt(qe),$=typeof __app_id<"u"?__app_id:"emperor-game",Tt="4",z={TREASURE:{id:"TREASURE",name:"The Merchant",val:5,icon:pt,color:"text-yellow-400",bg:"bg-gray-900",border:"border-yellow-500",item:"Treasure"},WEAPON:{id:"WEAPON",name:"The Warlord",val:4,icon:be,color:"text-red-500",bg:"bg-gray-900",border:"border-red-600",item:"Weapon"},ART:{id:"ART",name:"The Patron",val:3,icon:U,color:"text-purple-400",bg:"bg-gray-900",border:"border-purple-500",item:"Art"},CLOTH:{id:"CLOTH",name:"The Weaver",val:3,icon:St,color:"text-blue-400",bg:"bg-gray-900",border:"border-blue-500",item:"Cloth"},FOOD:{id:"FOOD",name:"The Glutton",val:2,icon:ut,color:"text-green-400",bg:"bg-gray-900",border:"border-green-500",item:"Food"},HOUSING:{id:"HOUSING",name:"The Architect",val:2,icon:Nt,color:"text-orange-400",bg:"bg-gray-900",border:"border-orange-500",item:"Housing"},HEALTH:{id:"HEALTH",name:"The Healer",val:2,icon:It,color:"text-pink-400",bg:"bg-gray-900",border:"border-pink-500",item:"Treatment"}},E={SECRET:{id:"SECRET",name:"Secret Plan",icon:Q,color:"text-blue-400",count:1,desc:"Place 1 card face down (revealed at round end).",reqCards:1},SABOTAGE:{id:"SABOTAGE",name:"Sabotage",icon:X,color:"text-red-400",count:1,desc:"Discard 2 cards permanently.",reqCards:2},GIFT:{id:"GIFT",name:"The Offering",icon:je,color:"text-purple-400",count:1,desc:"Offer 3 cards. Opponent picks 1, you keep 2.",reqCards:3},TRADE:{id:"TRADE",name:"The Divide",icon:ye,color:"text-green-400",count:1,desc:"Make two piles (2+2). Opponent picks one pile.",reqCards:4}},Et=n=>{let h=n.length,u;for(;h!==0;)u=Math.floor(Math.random()*h),h--,[n[h],n[u]]=[n[u],n[h]];return n},F=(n,h="neutral")=>({text:n,type:h,id:Date.now().toString()+Math.random().toString(36).substr(2,9)}),Y=({isShaking:n})=>e.jsxs("div",{className:`absolute inset-0 overflow-hidden pointer-events-none z-0 ${n?"animate-shake bg-red-900/20":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:[...Array(20)].map((h,u)=>{const x=Object.keys(z),p=z[x[u%x.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(p,{size:32})},u)})}),e.jsx("style",{children:`
      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
      }
      .animate-float { animation: float infinite ease-in-out; }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
      .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    `})]}),pe=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(U,{size:12,className:"text-yellow-500"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-yellow-500 uppercase",children:"EMPEROR"})]}),Le=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(U,{size:22,className:"text-yellow-500"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-yellow-500 uppercase",children:"EMPEROR"})]}),Ke=({onConfirm:n,onCancel:h,isHost:u,onReturnToLobby:x})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Abandon Kingdom?"}),e.jsx("p",{className:"text-gray-400 mb-6 text-sm",children:u&&x?"As Emperor (Host), you can return everyone to the Lobby or dissolve the room completely.":"Are you sure you want to leave? This will remove you from the room."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[u&&x&&e.jsxs("button",{onClick:x,className:"w-full bg-blue-600 hover:bg-blue-500 text-white py-3 rounded font-bold transition-colors flex items-center justify-center gap-2 border border-blue-400",children:[e.jsx(jt,{size:18})," Return Crew to Lobby"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:h,className:"bg-gray-700 hover:bg-gray-600 text-white py-3 rounded font-bold transition-colors",children:"Stay"}),e.jsx("button",{onClick:n,className:"bg-red-600 hover:bg-red-500 text-white py-3 rounded font-bold transition-colors",children:"Leave"})]})]})]})}),_=({typeId:n,onClick:h,selected:u,disabled:x,small:p,tiny:w,faceDown:A,isOpponent:G})=>{if(A)return e.jsx("div",{className:`
        ${w?"w-6 h-8 rounded-sm":p?"w-10 h-14 rounded":"w-16 h-24 md:w-20 md:h-32 rounded"} 
        bg-gray-800 border-2 border-gray-600 flex items-center justify-center shadow-lg transition-transform
        ${G?"":"hover:border-gray-400"}
      `,children:e.jsx("div",{className:"w-full h-full bg-[radial-gradient(ellipse_at_center,var(--tw-gradient-stops))] from-gray-700 to-gray-900 opacity-50 flex items-center justify-center",children:e.jsx("span",{className:`${w?"text-[10px]":"text-2xl"} text-gray-500 font-bold font-serif`,children:"?"})})});const t=z[n];return t?w?e.jsx("div",{className:`w-6 h-8 ${t.bg} border ${t.border} rounded-sm flex items-center justify-center shadow-sm`,children:e.jsx(t.icon,{className:`${t.color} w-3 h-3`})}):e.jsxs("button",{onClick:h,disabled:x,className:`
        relative rounded border-2 transition-all flex flex-col items-center justify-center shadow-lg
        ${p?"w-10 h-14 p-1":"w-16 h-24 md:w-24 md:h-36 p-1 md:p-2"}
        ${u?"ring-4 ring-yellow-400 -translate-y-2 z-10":"border-gray-600"}
        ${t.bg}
        ${x?"cursor-not-allowed brightness-75":"hover:scale-105 cursor-pointer hover:border-white"}
      `,children:[e.jsx("div",{className:`absolute top-0.5 left-1 md:top-1 md:left-1 text-[9px] md:text-[10px] font-bold ${t.color} leading-none`,children:t.val}),e.jsx("div",{className:`absolute bottom-0.5 right-1 md:bottom-1 md:right-1 text-[9px] md:text-[10px] font-bold ${t.color} leading-none rotate-180`,children:t.val}),e.jsx(t.icon,{className:`${t.color} ${p?"w-4 h-4":"w-6 h-6 md:w-10 md:h-10"}`}),!p&&e.jsx("span",{className:"font-bold text-[9px] md:text-xs mt-1 md:mt-2 text-gray-300 text-center leading-none truncate w-full",children:t.item})]}):null},_t=({type:n,used:h,onClick:u,active:x,disabled:p})=>{const w=E[n];return e.jsxs("button",{onClick:u,disabled:h||p,className:`
        relative p-2 md:p-3 rounded-full border-2 transition-all flex items-center justify-center group
        ${h?"bg-gray-800 border-gray-700 opacity-40 grayscale":"bg-gray-800 border-gray-500 hover:border-white hover:bg-gray-700"}
        ${x?"ring-2 md:ring-4 ring-yellow-400 scale-110 bg-gray-700":""}
      `,title:w.desc,children:[e.jsx(w.icon,{size:16,className:`${h?"text-gray-500":w.color} w-4 h-4 md:w-5 md:h-5`}),e.jsxs("div",{className:"absolute bottom-full mb-2 hidden md:group-hover:block w-32 bg-black text-white text-[10px] p-2 rounded z-50 pointer-events-none",children:[w.desc," (",w.reqCards," cards)"]})]})},zt=({id:n,data:h,myColor:u})=>{const x=z[n],p=h.owner,w=u==="red"?h.blueItems:h.redItems,A=u==="red"?h.redItems:h.blueItems;return e.jsxs("div",{className:"flex flex-col items-center gap-1 w-full",children:[e.jsx("div",{className:"flex flex-wrap justify-center gap-0.5 min-h-4 items-end w-full content-end",children:w.map((G,t)=>e.jsx(_,{typeId:G,tiny:!0},t))}),e.jsxs("div",{className:`
        relative w-full bg-gray-800 rounded-lg md:rounded-xl border-2 md:border-4 transition-all flex flex-col items-center justify-center z-10
        aspect-2/3 p-1
        ${p==="red"?"border-red-600 shadow-[0_0_10px_rgba(220,38,38,0.3)]":p==="blue"?"border-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.3)]":"border-gray-600"}
      `,children:[e.jsx("div",{className:`absolute top-1 left-1 font-bold text-[10px] md:text-lg ${x.color}`,children:x.val}),e.jsx("div",{className:`absolute bottom-1 right-1 font-bold text-[10px] md:text-lg ${x.color} rotate-180`,children:x.val}),p&&e.jsx("div",{className:`absolute -top-2 -right-2 md:-top-3 md:-right-3 rounded-full p-1 md:p-2 border-2 bg-gray-900 z-20 shadow-lg
            ${p==="red"?"border-red-500 bg-red-900/80 text-red-200":"border-blue-500 bg-blue-900/80 text-blue-200"}`,children:e.jsx(wt,{className:"w-3 h-3 md:w-5 md:h-5",fill:"currentColor"})}),e.jsx(x.icon,{className:`${x.color} w-5 h-5 md:w-10 md:h-10 mb-1 md:mb-2`}),e.jsx("span",{className:`${x.color} font-serif font-bold text-[8px] md:text-sm text-center leading-tight truncate w-full`,children:x.name.split(" ").pop()}),e.jsx("span",{className:"text-gray-500 text-[8px] md:text-[10px] mt-0.5 uppercase tracking-wide hidden md:block",children:x.item})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-0.5 min-h-8 items-start w-full",children:A.map((G,t)=>e.jsx(_,{typeId:G,tiny:!0},t))})]})},$t=({logs:n,onClose:h})=>e.jsx("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-gray-900/95 border border-gray-700 rounded-xl z-155 overflow-y-auto p-2 shadow-2xl",children:e.jsxs("div",{className:"bg-gray-800 w-full max-w-md h-[70vh] rounded-xl flex flex-col border border-gray-700 shadow-2xl animate-in zoom-in-95",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-xl",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx(Ue,{size:20})," Chronicles"]}),e.jsx("button",{onClick:h,className:"p-2 bg-gray-700 rounded-full hover:bg-gray-600",children:e.jsx(Be,{size:16,className:"text-gray-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...n].reverse().map((u,x)=>e.jsxs("div",{className:`text-sm p-3 rounded border-l-2 flex items-center gap-2 ${u.type==="danger"?"bg-red-900/20 border-red-500 text-red-200":u.type==="blue"?"bg-blue-900/20 border-blue-500 text-blue-200":u.type==="success"?"bg-green-900/20 border-green-500 text-green-200":"bg-gray-700/30 border-gray-500 text-gray-300"}`,children:[(u.type==="danger"||u.type==="blue")&&e.jsx(J,{size:14,className:"shrink-0"}),u.text]},x))})]})}),ge=({onClose:n})=>e.jsx("div",{className:"fixed inset-0 bg-black/95 z-100 flex items-center justify-center p-0 md:p-4",children:e.jsxs("div",{className:"bg-gray-900 md:rounded-2xl w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] overflow-hidden border-none md:border border-yellow-700 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-4 md:p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-serif text-yellow-500 uppercase tracking-widest",children:"Imperial Decree"}),e.jsx("span",{className:"text-gray-500 text-xs",children:"Rules of Engagement"})]}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-800 rounded-full text-gray-400",children:e.jsx(Be,{size:24})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 text-gray-300 scrollbar-thin scrollbar-thumb-gray-700",children:[e.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-3 flex items-center gap-3",children:[e.jsx(fe,{className:"text-yellow-500"})," The Goal"]}),e.jsxs("p",{children:["Conquer the Seven Kingdoms by having the most items in a kingdom at the end of a round.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{className:"text-white",children:"Victory Conditions:"}),e.jsxs("ul",{className:"list-disc ml-5 mt-2 space-y-1",children:[e.jsxs("li",{children:["Control ",e.jsx("span",{className:"text-yellow-400",children:"4 Kingdoms"})]}),e.jsxs("li",{children:["OR amass"," ",e.jsx("span",{className:"text-yellow-400",children:"11 Victory Points"})," (Sum of Kingdom Values)"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-3",children:[e.jsx(be,{className:"text-red-500"})," Action Tokens"]}),e.jsx("p",{className:"mb-4 text-sm text-gray-400",children:"You must use each token exactly once per round."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(Q,{className:"text-blue-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"Secret Plan (1 Card)"}),e.jsx("span",{className:"text-sm",children:"Place 1 card face down. It is revealed and added to your kingdoms at the end of the round."})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(X,{className:"text-red-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"Sabotage (2 Cards)"}),e.jsx("span",{className:"text-sm",children:"Discard 2 cards permanently from the game. Use this to deny items to your opponent."})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(je,{className:"text-purple-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"The Offering (3 Cards)"}),e.jsx("span",{className:"text-sm",children:"Select 3 cards. Your opponent picks 1 to keep. You keep the other 2."})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(ye,{className:"text-green-400 shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white block",children:"The Divide (4 Cards)"}),e.jsx("span",{className:"text-sm",children:"Split 4 cards into two piles (2+2). Your opponent chooses one pile to keep. You get the other."})]})]})]})]})]}),e.jsx("div",{className:"p-4 bg-gray-950 border-t border-gray-800 text-center",children:e.jsx("button",{onClick:n,className:"bg-yellow-700 hover:bg-yellow-600 text-white px-8 py-3 rounded-lg font-bold",children:"Close Guide"})})]})});function Ot(){const[n,h]=g.useState(null),[u,x]=g.useState("menu"),[p,w]=g.useState(""),[A,G]=g.useState(""),[t,se]=g.useState(null),[we,O]=g.useState(!1),[re,B]=g.useState(""),[Ve,ve]=g.useState(!1),[Ne,ke]=g.useState(!1),[v,ae]=g.useState(null),[S,q]=g.useState([]),[le,ne]=g.useState(null),[H,oe]=g.useState([]),[We,Z]=g.useState(!1),[Ye,ie]=g.useState(!1),[de,V]=g.useState(!1),[ce,Ie]=g.useState(!1),[Ce,L]=g.useState(!1),[P,Se]=g.useState(()=>localStorage.getItem("gameHub_playerName")||"");g.useEffect(()=>{P&&localStorage.setItem("gameHub_playerName",P)},[P]),g.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await it(ue,__initial_auth_token):await dt(ue))();const s=nt(ue,h);return()=>s()},[]),g.useEffect(()=>{if(n&&u==="menu"){const a=localStorage.getItem("emperor_room_id"),s=localStorage.getItem("emperor_player_name");a&&s&&(O(!0),Se(s),w(a))}},[n,u]),g.useEffect(()=>{if(!p||!n)return;const a=$e(R(T,"artifacts",$,"public","data","rooms",p),s=>{if(s.exists()){const l=s.data();if(!l.players.some(i=>i.id===n.uid)){w(""),x("menu"),B("You were removed from the room."),localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name"),O(!1);return}se(l),l.status==="playing"||l.status==="round_end"||l.status==="finished"?x("game"):x("lobby"),O(!1)}else w(""),x("menu"),B("The Kingdom has fallen (Room Closed)."),localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name"),O(!1)});return()=>a()},[p,n]),g.useEffect(()=>{if(t&&(t.status==="round_end"||t.status==="finished")&&t.hostId===n?.uid&&Object.keys(t.readyForNextRound||{}).length===2){const s=t.status==="finished";Te(!s)}},[t,n]);const me=g.useRef("");if(g.useEffect(()=>{t&&(me.current!=="round_end"&&me.current!=="finished"&&(t.status==="round_end"||t.status==="finished")&&(ie(!0),Z(!1)),me.current=t.status)},[t?.status]),g.useEffect(()=>{const a=$e(R(T,"game_hub_settings","config"),s=>{s.exists()&&(s.data()[Tt]?.maintenance?ve(!0):ve(!1))});return()=>a()},[]),Ve)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(Le,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(ot,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"The Emperor's court is currently closed for renovations."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(Oe,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(Oe,{size:16})]})})})}),e.jsx(pe,{})]});const Je=async()=>{if(!P)return B("Name required");O(!0);const a="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let s="";for(let i=0;i<6;i++)s+=a.charAt(Math.floor(Math.random()*a.length));const l={};Object.values(z).forEach(i=>{const{icon:y,...m}=i;l[i.id]={...m,owner:null,redItems:[],blueItems:[]}}),await ct(R(T,"artifacts",$,"public","data","rooms",s),{roomId:s,hostId:n.uid,status:"lobby",players:[{id:n.uid,name:P,color:"red",hand:[],tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1}],kings:l,deck:[],round:1,turnPlayerId:null,roundStarterId:null,phase:"lobby",pendingInteraction:null,logs:[],winnerId:null,roundReveal:null,readyForNextRound:{},winReason:null}),localStorage.setItem("emperor_room_id",s),localStorage.setItem("emperor_player_name",P),w(s),G(s),x("lobby"),O(!1)},Xe=async()=>{if(!A||!P)return B("Room ID and Name required");O(!0);const a=R(T,"artifacts",$,"public","data","rooms",A),s=await Pe(a);if(!s.exists()){B("Room not found"),O(!1);return}const l=s.data();if(l.players.length>=2&&!l.players.some(i=>i.id===n.uid)){B("Room full"),O(!1);return}if(!l.players.some(i=>i.id===n.uid)){const i=[...l.players,{id:n.uid,name:P,color:"blue",hand:[],tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1}];await D(a,{players:i})}localStorage.setItem("emperor_room_id",A),localStorage.setItem("emperor_player_name",P),w(A),O(!1)},Re=async()=>{if(!(!p||!n)){try{const a=R(T,"artifacts",$,"public","data","rooms",p),s=await Pe(a);if(s.exists()){const l=s.data();if(l.hostId===n.uid)await mt(a);else{const i=l.players.filter(y=>y.id!==n.uid);await D(a,{players:i})}}}catch(a){console.error("Error leaving room:",a)}localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name"),w(""),x("menu"),se(null),L(!1)}},Qe=async a=>{if(!t||t.hostId!==n.uid)return;const s=t.players.filter(l=>l.id!==a);await D(R(T,"artifacts",$,"public","data","rooms",p),{players:s})},Ze=()=>{const a=t.roomId,s=()=>{ke(!0),setTimeout(()=>ke(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",De)};try{navigator.clipboard.writeText(a),s()}catch{const i=document.createElement("textarea");i.value=a,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),s()}},et=async()=>{if(!t||t.hostId!==n.uid)return;const a=t.players.map(l=>({...l,hand:[],tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1})),s={...t.kings};Object.keys(s).forEach(l=>{s[l].redItems=[],s[l].blueItems=[],s[l].owner=null}),await D(R(T,"artifacts",$,"public","data","rooms",p),{status:"lobby",phase:"lobby",players:a,kings:s,deck:[],round:1,turnPlayerId:null,pendingInteraction:null,logs:[],winnerId:null,roundReveal:null,readyForNextRound:{},winReason:null}),L(!1)},Te=async(a=!1)=>{if(t.hostId!==n.uid)return;let s=[];Object.values(z).forEach(d=>{for(let f=0;f<d.val;f++)s.push(d.id)}),s=Et(s),s.pop();let l;if(a){const d=t.roundStarterId,f=t.players.find(c=>c.id!==d);l=f?f.id:t.players[0].id}else{const d=Math.floor(Math.random()*t.players.length);l=t.players[d].id}const i=t.players.map(d=>{const f=[];for(let c=0;c<6;c++)s.length>0&&f.push(s.pop());return{...d,hand:f,tokens:{SECRET:!1,SABOTAGE:!1,GIFT:!1,TRADE:!1},faceDownCards:[],sabotagedCards:[],ready:!1}}),y=i.findIndex(d=>d.id===l);y!==-1&&s.length>0&&i[y].hand.push(s.pop());const m={...t.kings};Object.keys(m).forEach(d=>{m[d].redItems=[],m[d].blueItems=[],a||(m[d].owner=null)});const N=i[y].name,b={status:"playing",kings:m,deck:s,players:i,round:a?t.round+1:1,turnPlayerId:l,roundStarterId:l,phase:"turn",pendingInteraction:null,winnerId:null,winReason:null,roundReveal:null,readyForNextRound:{}};a?b.logs=te(F(`âš”ï¸ Round ${t.round+1} Begins! ${N} draws and starts.`,"info")):b.logs=[F(`âš”ï¸ New Game! ${N} draws 1 card and starts.`,"info")],await D(R(T,"artifacts",$,"public","data","rooms",p),b),ie(!1),Z(!1)},Ee=async()=>{if(!t)return;const a=t.readyForNextRound?.[n.uid];await D(R(T,"artifacts",$,"public","data","rooms",p),{[`readyForNextRound.${n.uid}`]:!a})},ee=async(a,s,l,i,y="turn",m=null)=>{if(a.every(d=>Object.values(d.tokens).every(f=>f===!0))&&!m){await ze(a,s);return}let b=t.players.find(d=>d.id!==n.uid).id;if(m)b=m.targetId;else if(l.length>0){const d=l.pop(),f=a.findIndex(c=>c.id===b);a[f].hand.push(d)}await D(R(T,"artifacts",$,"public","data","rooms",p),{players:a,kings:s||t.kings,deck:l||t.deck,turnPlayerId:b,phase:y,pendingInteraction:m,logs:te(F(i,"neutral"))}),ae(null),q([]),oe([]),ne(null)},tt=(a,s)=>{if(S.includes(s))q(S.filter(l=>l!==s));else if(v){const l=E[v].reqCards;S.length<l&&q([...S,s])}},W=(a,s,l)=>{const i=a[s];l==="red"?i.redItems.push(s):i.blueItems.push(s)},_e=async()=>{if(!v||!n)return;const a=t.players.find(c=>c.id===n.uid),s=E[v].reqCards;if(S.length!==s){alert(`Select exactly ${s} cards.`);return}let l=JSON.parse(JSON.stringify(t.players)),i=l.findIndex(c=>c.id===n.uid),y=l.findIndex(c=>c.id!==n.uid),m=JSON.parse(JSON.stringify(t.kings)),N=[...t.deck];const b=[...a.hand].sort((c,j)=>z[j].val-z[c].val),d=S.map(c=>b[c]),f=c=>{c.forEach(j=>{const r=l[i].hand.indexOf(j);r>-1&&l[i].hand.splice(r,1)})};if(l[i].tokens[v]=!0,v==="SECRET")f(d),l[i].faceDownCards.push(d[0]),await ee(l,m,N,`${a.name} placed a Secret Plan.`);else if(v==="SABOTAGE")f(d),l[i].sabotagedCards||(l[i].sabotagedCards=[]),l[i].sabotagedCards.push(...d),await ee(l,m,N,`${a.name} Sabotaged (Discarded 2 cards).`);else if(v==="GIFT"){f(d);const c={type:"GIFT",initiatorId:n.uid,targetId:l[y].id,cards:d};await ee(l,m,N,`${a.name} offers a Gift (Choose 1 of 3).`,"interaction",c)}else if(v==="TRADE"){if(le!=="TRADE_SPLIT"){ne("TRADE_SPLIT");return}const c=H;if(c.length!==2){alert("Piles must be 2 and 2.");return}const j=c.map(k=>b[k]),o=S.filter(k=>!c.includes(k)).map(k=>b[k]);f(d);const C={type:"TRADE",initiatorId:n.uid,targetId:l[y].id,pile1:j,pile2:o};await ee(l,m,N,`${a.name} proposes a Trade (Pick a pile).`,"interaction",C)}},xe=async a=>{if(!t.pendingInteraction)return;const{type:s,initiatorId:l,targetId:i,cards:y,pile1:m,pile2:N}=t.pendingInteraction;if(n.uid!==i)return;let b=JSON.parse(JSON.stringify(t.players)),d=JSON.parse(JSON.stringify(t.kings)),f=[...t.deck];const c=b.find(I=>I.id===i),j=b.find(I=>I.id===l);let r="";if(s==="GIFT"){const I=y[a],K=y.filter((M,st)=>st!==a);W(d,I,c.color),K.forEach(M=>W(d,M,j.color)),r=`${c.name} chose ${z[I].item}. ${j.name} kept the rest.`}else if(s==="TRADE"){const I=a===0?m:N,K=a===0?N:m;I.forEach(M=>W(d,M,c.color)),K.forEach(M=>W(d,M,j.color)),r=`${c.name} picked a pile of ${I.length} items.`}const o=l;let C=b.find(I=>I.id!==o).id;if(b.every(I=>Object.values(I.tokens).every(K=>K===!0)))await ze(b,d);else{if(f.length>0){const I=f.pop(),K=b.findIndex(M=>M.id===C);b[K].hand.push(I)}await D(R(T,"artifacts",$,"public","data","rooms",p),{players:b,kings:d,deck:f,pendingInteraction:null,phase:"turn",turnPlayerId:C,logs:te(F(r,"success"))})}},ze=async(a,s)=>{let l=[];l.push(F("ðŸ”” Round End! Revealing Secret Plans...","neutral"));const i={};a.forEach(r=>{i[r.id]=[...r.faceDownCards],r.faceDownCards.forEach(o=>{W(s,o,r.color)}),r.faceDownCards=[]});let y=0,m=0,N=0,b=0;const d=a.find(r=>r.color==="red"),f=a.find(r=>r.color==="blue");Object.keys(s).forEach(r=>{const o=s[r],C=o.redItems.length,k=o.blueItems.length;C>k?(o.owner!=="red"&&l.push(F(`${d.name} conquered ${o.name}!`,"danger")),o.owner="red"):k>C&&(o.owner!=="blue"&&l.push(F(`${f.name} conquered ${o.name}!`,"blue")),o.owner="blue"),o.owner==="red"&&(y++,N+=o.val),o.owner==="blue"&&(m++,b+=o.val)});let c=null,j=null;y>=4||N>=11?(c=d.id,j=y>=4?"controlled 4 Kingdoms":"scored 11 Victory Points"):(m>=4||b>=11)&&(c=f.id,j=m>=4?"controlled 4 Kingdoms":"scored 11 Victory Points"),c&&l.push(F("ðŸ† Game Over!","success")),await D(R(T,"artifacts",$,"public","data","rooms",p),{status:c?"finished":"round_end",winnerId:c,winReason:j,kings:s,players:a,roundReveal:i,pendingInteraction:null,phase:"resolution",readyForNextRound:{},logs:te(...l)})};if(!n)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-yellow-500 animate-pulse",children:"Reclaiming throne..."});if(p&&!t&&!re)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(Y,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(gt,{size:48,className:"text-yellow-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(u==="menu")return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(Y,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-yellow-800 rounded-lg 
			font-bold shadow-md hover:text-yellow-400 transition-colors w-fit animate-pulse`,children:[e.jsx(ft,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),de&&e.jsx(ge,{onClose:()=>V(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(U,{size:64,className:"text-yellow-500 mx-auto mb-4 animate-bounce drop-shadow-[0_0_15px_rgba(234,179,8,0.5)]"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-linear-to-b from-yellow-300 to-yellow-600 font-serif tracking-widest drop-shadow-md",children:"EMPEROR"}),e.jsx("p",{className:"text-gray-400 tracking-[0.3em] uppercase mt-2",children:"Rule the Seven Kingdoms"})]}),e.jsxs("div",{className:"bg-gray-900/80 backdrop-blur border border-gray-700 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10 animate-in slide-in-from-bottom-10 duration-700 delay-100",children:[re&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-2 mb-4 rounded text-center text-sm border border-red-800",children:re}),e.jsx("input",{className:"w-full bg-black/50 border border-gray-600 p-3 rounded mb-4 text-white placeholder-gray-500 focus:border-yellow-500 outline-none transition-colors",placeholder:"Your Name, My Liege",value:P,onChange:a=>Se(a.target.value)}),e.jsxs("button",{onClick:Je,disabled:we,className:"w-full bg-linear-to-r from-yellow-700 to-yellow-600 hover:from-yellow-600 hover:to-yellow-500 p-4 rounded font-bold mb-4 flex items-center justify-center gap-2 border border-yellow-500/30 shadow-[0_0_15px_rgba(234,179,8,0.2)] transition-all",children:[e.jsx(U,{size:20})," Establish Kingdom"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx("input",{className:"w-full sm:flex-1 bg-black/50 border border-gray-600 p-3 rounded text-white placeholder-gray-500 uppercase font-mono tracking-wider focus:border-yellow-500 outline-none",placeholder:"ROOM CODE",value:A,onChange:a=>G(a.target.value.toUpperCase())}),e.jsx("button",{onClick:Xe,disabled:we,className:"w-full sm:w-auto bg-gray-800 hover:bg-gray-700 border border-gray-600 px-6 py-3 rounded font-bold transition-colors",children:"Join"})]}),e.jsxs("button",{onClick:()=>V(!0),className:"w-full text-sm text-gray-400 hover:text-white flex items-center justify-center gap-2 py-2",children:[e.jsx(Ae,{size:16})," Imperial Decree"]})]}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Hanamikoji. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),". Visit"," ",e.jsx("a",{href:"/rawfids-gamehub/",rel:"noopener noreferrer",className:"text-yellow-500 underline hover:text-yellow-600",children:"GAMEHUB"})," ","for more games."]})]});if(u==="lobby"&&t){const a=t.hostId===n.uid;return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-6 relative",children:[e.jsx(Y,{}),e.jsx(Le,{}),de&&e.jsx(ge,{onClose:()=>V(!1)}),Ce&&e.jsx(Ke,{onConfirm:Re,onCancel:()=>L(!1),isHost:a}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-gray-800/90 p-8 rounded-2xl border border-gray-700 shadow-2xl mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-yellow-500 font-bold uppercase",children:"Throne Room"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:p}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:Ze,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:Ne?e.jsx(De,{size:16,className:"text-green-500"}):e.jsx(ht,{size:16})}),Ne&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-yellow-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(J,{size:16})," ",t.players.length,"/2"]}),e.jsx("button",{onClick:()=>L(!0),className:"p-2 bg-red-900/50 hover:bg-red-900 rounded text-red-300",title:"Leave Room",children:e.jsx(Ge,{size:16})})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[t.players.map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-4 rounded border border-gray-700",children:[e.jsxs("span",{className:`font-bold ${s.color==="red"?"text-red-500":"text-blue-500"} flex items-center gap-2`,children:[s.id===t.hostId&&e.jsx(U,{size:14,className:"text-yellow-500"})," ",s.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.id===n.uid&&e.jsx("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded",children:"You"}),a&&s.id!==n.uid&&e.jsx("button",{onClick:()=>Qe(s.id),className:"p-2 hover:bg-red-900/50 rounded text-red-400",title:"Kick Player",children:e.jsx(X,{size:16})})]})]},s.id)),t.players.length<2&&e.jsx("div",{className:"text-center text-gray-500 animate-pulse italic",children:"Waiting for challenger..."})]}),e.jsx("div",{className:"flex flex-col gap-3",children:t.hostId===n.uid?e.jsx("button",{onClick:()=>Te(!1),disabled:t.players.length<2,className:`w-full py-4 rounded-xl font-bold text-lg shadow-lg transition-all ${t.players.length<2?"bg-gray-700 cursor-not-allowed text-gray-500":"bg-green-700 hover:bg-green-600 text-white shadow-green-900/30"}`,children:"Begin Campaign"}):e.jsx("div",{className:"text-center text-yellow-500/80 font-serif mb-2",children:"Waiting for Host to start..."})})]}),e.jsx(pe,{})]})}if(u==="game"&&t){const a=t.players.find(r=>r.id===n.uid),s=t.players.find(r=>r.id!==n.uid),l=t.hostId===n.uid;if(!s)return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Y,{}),e.jsxs("div",{className:"bg-gray-800 p-8 rounded-xl border border-red-700 shadow-2xl relative z-10 max-w-md",children:[e.jsx(Me,{size:64,className:"text-red-500 mb-4 mx-auto"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Opponent has fled the battlefield!"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"The empire is yours by default, though it is a hollow victory."}),e.jsx("button",{onClick:()=>{w(""),se(null),x("menu"),localStorage.removeItem("emperor_room_id"),localStorage.removeItem("emperor_player_name")},className:"bg-yellow-600 hover:bg-yellow-500 text-black px-6 py-3 rounded font-bold w-full",children:"Return to Menu"})]})]});const i=t.turnPlayerId===n.uid&&t.phase==="turn",y=t.phase==="interaction"&&t.pendingInteraction?.targetId===n.uid&&t.status==="playing",m=t.status==="round_end"||t.status==="finished",N=[...a.hand].sort((r,o)=>z[o].val-z[r].val),b=r=>{H.includes(r)?oe(H.filter(o=>o!==r)):H.length<2&&oe([...H,r])},d=t.readyForNextRound?.[n.uid],f=t.readyForNextRound?.[s.id],c=y||i&&!m;let j="";if(y)t.pendingInteraction.type==="GIFT"&&(j="Gift Received: Pick 1 Card from top right"),t.pendingInteraction.type==="TRADE"&&(j="Trade Offered: Pick 1 Pile from top right");else if(i&&!m)if(v){const r=E[v];v==="TRADE"&&le==="TRADE_SPLIT"?j="Split your cards into two piles":j=`${r.name}: Select ${r.reqCards} card${r.reqCards>1?"s":""}`}else j="Your Turn: Select an Action Token";return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col overflow-hidden relative font-sans select-none",children:[e.jsx(Y,{}),de&&e.jsx(ge,{onClose:()=>V(!1)}),ce&&e.jsx($t,{logs:t.logs,onClose:()=>Ie(!1)}),Ce&&e.jsx(Ke,{onConfirm:Re,onCancel:()=>L(!1),isHost:l,onReturnToLobby:et}),e.jsxs("div",{className:"h-14 bg-gray-900/80 border-b border-gray-800 flex items-center justify-between px-4 z-20 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"font-serif text-yellow-500 font-bold tracking-wider hidden md:block",children:"EMPEROR"}),e.jsxs("div",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:["Round ",t.round]})]}),e.jsxs("div",{className:"flex gap-2",children:[m&&(t.winnerId?e.jsxs("button",{onClick:()=>Z(!0),className:"px-4 py-1.5 bg-yellow-600 hover:bg-yellow-500 rounded text-sm font-bold animate-pulse shadow-lg shadow-yellow-900/50 flex items-center gap-2",children:[e.jsx(fe,{size:16})," Show Results"]}):e.jsxs("button",{onClick:Ee,className:`px-4 py-1.5 rounded text-sm font-bold flex items-center gap-2 transition-all ${d?"bg-green-700 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[d?e.jsx(Fe,{size:16}):e.jsx(He,{size:16}),d?f?"Starting...":"Waiting...":"Next Round"]})),e.jsx("button",{onClick:()=>Ie(!ce),className:`p-2 rounded-full ${ce?"bg-yellow-900 text-yellow-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(Ue,{size:18})}),e.jsx("button",{onClick:()=>V(!0),className:"p-2 hover:bg-gray-800 rounded text-gray-400",children:e.jsx(Ae,{size:18})}),e.jsx("button",{onClick:()=>L(!0),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:e.jsx(Ge,{size:18})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between p-2 md:p-4 relative z-10 max-w-6xl mx-auto w-full h-full",children:[e.jsxs("div",{className:"flex flex-row justify-between items-start mb-2 shrink-0 gap-2 h-24 md:h-auto",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-[45%] md:w-[40%]",children:[e.jsxs("div",{className:`flex items-center gap-2 font-bold ${s.color==="red"?"text-red-500":"text-blue-500"} text-sm md:text-base truncate`,children:[e.jsx(J,{size:16})," ",s.name,t.turnPlayerId===s.id&&!y&&!m&&e.jsx("span",{className:"text-[10px] md:text-xs bg-yellow-500 text-black px-1 rounded animate-pulse ml-2",children:"Thinking..."}),t.phase==="interaction"&&t.pendingInteraction.targetId===s.id&&e.jsx("span",{className:"text-[10px] md:text-xs bg-orange-500 text-white px-1 rounded animate-bounce ml-2",children:"Deciding..."})]}),e.jsx("div",{className:"flex gap-1 overflow-hidden",children:s.hand.map((r,o)=>e.jsx("div",{className:"w-4 h-6 md:w-5 md:h-8 bg-gray-800 border border-gray-600 rounded"},o))}),e.jsx("div",{className:"flex gap-1 mt-1 opacity-70",children:Object.keys(E).map(r=>{const o=E[r].icon,C=s.tokens[r];return e.jsx("div",{className:`p-1 rounded-full border ${C?"border-gray-700 bg-gray-800":"border-gray-600 bg-gray-900"}`,children:e.jsx(o,{size:10,className:C?"text-gray-600":E[r].color})},r)})}),e.jsxs("div",{className:"flex gap-2 mt-1 items-center overflow-x-auto no-scrollbar",children:[s.faceDownCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2",children:[e.jsx("span",{className:"text-[9px] text-gray-500 uppercase mr-1 whitespace-nowrap",children:e.jsx(Q,{size:10})}),s.faceDownCards.map((r,o)=>e.jsx(_,{tiny:!0,faceDown:!0},`secret-${o}`))]}),s.sabotagedCards&&s.sabotagedCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2",children:[e.jsx("span",{className:"text-[9px] text-gray-500 uppercase mr-1 whitespace-nowrap",children:e.jsx(X,{size:10})}),s.sabotagedCards.map((r,o)=>e.jsx(_,{typeId:r,tiny:!0},`discard-${o}`))]})]})]}),e.jsx("div",{className:"flex-1 flex justify-end h-full",children:y?e.jsxs("div",{className:"bg-gray-800/90 border border-orange-500 rounded-lg p-2 shadow-lg flex flex-col items-center justify-center w-full max-w-sm animate-in slide-in-from-right-4 fade-in h-full overflow-y-auto no-scrollbar",children:[t.pendingInteraction.type==="GIFT"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-[10px] md:text-xs font-bold text-white flex items-center gap-1 mb-1",children:[e.jsx(je,{size:12})," Gift! Keep 1:"]}),e.jsx("div",{className:"flex justify-center gap-2",children:t.pendingInteraction.cards.map((r,o)=>e.jsx("div",{className:"hover:scale-105 transition-transform cursor-pointer",onClick:()=>xe(o),children:e.jsx(_,{typeId:r,small:!0})},o))})]}),t.pendingInteraction.type==="TRADE"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-[10px] md:text-xs font-bold text-white flex items-center gap-1 mb-1",children:[e.jsx(ye,{size:12})," Trade! Pick Pile:"]}),e.jsxs("div",{className:"flex justify-center gap-2 items-center",children:[e.jsx("button",{onClick:()=>xe(0),className:"bg-gray-700 p-1 rounded border border-gray-600 hover:border-yellow-400 flex gap-1 items-center",children:t.pendingInteraction.pile1.map((r,o)=>e.jsx(_,{typeId:r,tiny:!0},o))}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:"OR"}),e.jsx("button",{onClick:()=>xe(1),className:"bg-gray-700 p-1 rounded border border-gray-600 hover:border-yellow-400 flex gap-1 items-center",children:t.pendingInteraction.pile2.map((r,o)=>e.jsx(_,{typeId:r,tiny:!0},o))})]})]})]}):e.jsx("div",{className:"w-full h-full"})})]}),e.jsx("div",{className:"flex justify-center mb-2 shrink-0",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 px-4 py-1 rounded-full text-xs font-mono text-gray-400 shadow-lg flex items-center gap-2",children:[e.jsx(bt,{size:14})," Deck: ",t.deck.length]})}),e.jsx("div",{className:"flex-1 flex flex-col justify-center min-h-0",children:e.jsx("div",{className:`
                w-full justify-items-center gap-1 md:gap-3
                grid grid-cols-7 md:grid-cols-7
            `,children:Object.keys(z).map((r,o)=>e.jsx("div",{className:`w-full ${o>=4?"md:col-auto":""}`,children:e.jsx(zt,{id:r,data:t.kings[r],myColor:a.color})},r))})}),e.jsx("div",{className:"h-8 flex items-center justify-center my-2 shrink-0 relative",children:!y&&e.jsx("div",{className:"w-full max-w-md text-center text-sm text-gray-400 bg-gray-900/50 p-1 rounded backdrop-blur-sm flex justify-center items-center gap-2",children:t.logs.slice(-1).map((r,o)=>e.jsxs("span",{className:`flex items-center gap-2 ${r.type==="danger"?"text-red-400":r.type==="blue"?"text-blue-400":r.type==="success"?"text-green-400":"text-gray-300"}`,children:[(r.type==="danger"||r.type==="blue")&&e.jsx(J,{size:14}),r.text]},o))})}),c&&e.jsx("div",{className:"flex justify-center mb-1 animate-bounce",children:e.jsxs("div",{className:"bg-yellow-500 text-black text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-yellow-300 flex items-center gap-2",children:[e.jsx(Me,{size:12})," ",j]})}),e.jsxs("div",{className:`bg-gray-900/90 p-3 md:p-4 rounded-t-xl md:rounded-xl border-t-2 border-gray-700 transition-all shrink-0 ${i?"shadow-[0_0_20px_rgba(234,179,8,0.1)] border-yellow-600/50":"grayscale opacity-80"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 -mt-1",children:[e.jsxs("div",{className:`flex items-center gap-2 font-bold ${a.color==="red"?"text-red-500":"text-blue-500"} text-sm md:text-base`,children:[e.jsx(J,{size:16})," ",a.name]}),i&&!m&&e.jsx("span",{className:"bg-green-600 text-white text-[10px] md:text-xs font-bold px-3 py-0.5 rounded-full shadow-lg animate-bounce border border-green-400 tracking-wider",children:"YOUR TURN"})]}),le==="TRADE_SPLIT"?e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"flex gap-4 p-4 bg-black/40 rounded-xl",children:S.map((r,o)=>{const C=N[r],k=H.includes(r);return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(_,{typeId:C,onClick:()=>b(r),selected:k}),e.jsx("div",{className:`text-xs font-bold px-2 py-1 rounded ${k?"bg-blue-600":"bg-red-600"}`,children:k?"Pile 1":"Pile 2"})]},o)})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>{ne(null),q([]),ae(null)},className:"px-6 py-2 bg-gray-700 rounded hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{onClick:_e,disabled:H.length!==2,className:"px-6 py-2 bg-yellow-600 rounded font-bold hover:bg-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Trade Split"})]})]}):e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 flex justify-center px-2 w-full",children:e.jsx("div",{className:"flex items-end -space-x-5 md:-space-x-10 hover:-space-x-3 transition-all duration-300 py-4",children:N.map((r,o)=>e.jsx("div",{className:`
                            shrink-0 relative transition-all duration-200
                            ${S.includes(o)?"z-20 -translate-y-4":"hover:z-10 hover:-translate-y-2"}
                          `,children:e.jsx(_,{typeId:r,onClick:()=>i&&tt(r,o),selected:S.includes(o),disabled:!i})},o))})}),e.jsxs("div",{className:"flex gap-2 items-center shrink-0 min-w-[80px] overflow-x-auto no-scrollbar",children:[a.faceDownCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2 shrink-0",children:[e.jsx("span",{className:"text-[9px] text-gray-500 uppercase mr-1 whitespace-nowrap",children:e.jsx(Q,{size:10})}),a.faceDownCards.map((r,o)=>e.jsx("div",{className:"opacity-80 hover:opacity-100 transition-opacity shrink-0",children:e.jsx(_,{typeId:r,tiny:!0},o)},`my-secret-${o}`))]}),a.sabotagedCards&&a.sabotagedCards.length>0&&e.jsxs("div",{className:"flex gap-1 items-center bg-black/20 p-1 rounded border-l border-gray-700 pl-2 shrink-0",children:[e.jsx(X,{size:10,className:"text-gray-500"}),a.sabotagedCards.map((r,o)=>e.jsx(_,{typeId:r,tiny:!0},`my-discard-${o}`))]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px] shrink-0 w-full md:w-auto",children:[e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.keys(E).map(r=>e.jsx(_t,{type:r,used:a.tokens[r],active:v===r,disabled:!i,onClick:()=>{i&&!a.tokens[r]&&(ae(r),q([]))}},r))}),v&&i&&e.jsxs("div",{className:"bg-black/40 p-2 rounded text-xs text-center animate-in slide-in-from-right-4 fade-in",children:[e.jsx("div",{className:"text-yellow-500 font-bold mb-1",children:E[v].name}),e.jsx("div",{className:"text-gray-400 mb-2",children:E[v].desc}),e.jsxs("button",{onClick:_e,disabled:S.length!==E[v].reqCards,className:"w-full bg-yellow-700 hover:bg-yellow-600 disabled:bg-gray-700 disabled:text-gray-500 text-white py-2 rounded font-bold transition-colors",children:["Execute (",S.length,"/",E[v].reqCards,")"]})]})]})]})})]})]}),m&&Ye&&t.roundReveal&&e.jsx("div",{className:"fixed inset-0 bg-black/95 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-purple-500 rounded-2xl p-8 max-w-2xl w-full text-center shadow-2xl animate-in zoom-in-90",children:[e.jsxs("h2",{className:"text-2xl font-serif text-purple-400 mb-6 flex items-center justify-center gap-2",children:[e.jsx(Q,{})," Secret Plans Revealed!"]}),e.jsx("div",{className:"flex flex-col md:flex-row justify-around gap-8 mb-8",children:Object.keys(t.roundReveal).map(r=>{const o=t.players.find(k=>k.id===r)?.name,C=t.roundReveal[r];return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"font-bold text-gray-300 mb-2",children:[o," revealed:"]}),e.jsx("div",{className:"flex gap-2",children:C.length>0?C.map((k,I)=>e.jsx(_,{typeId:k,small:!0},I)):e.jsx("div",{className:"text-gray-600 italic",children:"No plans"})})]},r)})}),e.jsxs("button",{onClick:()=>ie(!1),className:"px-8 py-3 bg-purple-700 hover:bg-purple-600 text-white rounded-lg font-bold flex items-center justify-center gap-2 mx-auto",children:[e.jsx(yt,{size:20})," Inspect Battlefield"]})]})}),m&&We&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:`bg-gray-900 border rounded-2xl p-8 max-w-lg w-full text-center shadow-[0_0_50px_rgba(0,0,0,0.5)] ${t.winnerId?"border-yellow-500 shadow-yellow-500/20":"border-gray-600"}`,children:[t.winnerId?e.jsxs(e.Fragment,{children:[e.jsx(fe,{size:64,className:"text-yellow-500 mx-auto mb-4 animate-bounce"}),e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Kingdoms United!"}),e.jsxs("p",{className:"text-xl text-gray-300 mb-2",children:[t.players.find(r=>r.id===t.winnerId).name," ","is the new Emperor!"]}),e.jsx("p",{className:"text-sm text-yellow-500/80 mb-8 uppercase tracking-widest border-t border-b border-yellow-900/50 py-2",children:t.winReason})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{size:64,className:"text-red-500 mx-auto mb-4"}),e.jsxs("h2",{className:"text-3xl font-bold text-white mb-2",children:["Round ",t.round," Complete"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6 text-left bg-black/30 p-4 rounded",children:[e.jsxs("div",{className:"text-red-500 font-bold text-center",children:[e.jsx("div",{className:"text-2xl",children:Object.values(t.kings).filter(r=>r.owner==="red").length}),e.jsx("div",{className:"text-xs uppercase text-gray-500",children:"Red Kingdoms"})]}),e.jsxs("div",{className:"text-blue-500 font-bold text-center",children:[e.jsx("div",{className:"text-2xl",children:Object.values(t.kings).filter(r=>r.owner==="blue").length}),e.jsx("div",{className:"text-xs uppercase text-gray-500",children:"Blue Kingdoms"})]})]})]}),e.jsx("div",{className:"flex flex-col gap-3",children:t.winnerId?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Ee,className:`w-full py-3 rounded-lg font-bold transition-all flex items-center justify-center gap-2 ${d?"bg-green-700 hover:bg-green-600 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:[d?e.jsx(Fe,{size:20}):e.jsx(He,{size:20}),d?f?"Starting New Game...":"Waiting for Opponent":"Ready for Rematch"]}),e.jsx("button",{onClick:()=>L(!0),className:"w-full bg-transparent border border-red-900 text-red-400 hover:bg-red-900/20 px-8 py-3 rounded-lg font-bold",children:"Exit Room"})]}):e.jsx("button",{onClick:()=>Z(!1),className:"w-full bg-gray-700 hover:bg-gray-600 text-white px-8 py-3 rounded-lg font-bold",children:"Close & Prepare"})})]})}),e.jsx("div",{className:"bg-gray-950 pb-1 pt-1 z-50",children:e.jsx(pe,{})})]})}return null}xt.createRoot(document.getElementById("root")).render(e.jsx(g.StrictMode,{children:e.jsx(Ot,{})}));
