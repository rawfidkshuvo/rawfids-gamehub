import{c as te,i as ts,g as as,a as rs,r as h,e as ls,o as ke,d as S,u as R,q as Z,j as e,H as ns,S as F,X as $e,n as is,s as os,h as cs,p as ds,f as xs,R as Se,t as us,m as ms}from"./x-vdu6PxPT.js";import{L as hs,S as fs,B as Ie,C as q,a as ps,b as xe,P as bs}from"./step-back-D7uqsBfy.js";import{T as G}from"./target-sC2nYOgS.js";import{U as Ce}from"./user-hi-jrCL7.js";import{T as gs}from"./trash-2-CC3Hg-Aa.js";import{H as ys}from"./history-r3RmdCN7.js";import{Z as js}from"./zap-BEeOHqdt.js";import{C as Ns}from"./cpu-cTepKb_S.js";import{T as Ee}from"./trophy-CV5zFLFQ.js";import{R as Pe}from"./rotate-ccw-B8nxxfV1.js";import{H as ue}from"./house-BdFnrmDF.js";import{E as ws}from"./eye-off-D-xHY3rk.js";const vs=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],me=te("activity",vs);const ks=[["path",{d:"M 22 14 L 22 10",key:"nqc4tb"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Re=te("battery",ks);const Ss=[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]],Is=te("fast-forward",Ss);const Cs=[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]],ze=te("signal",Cs),Es="/rawfids-gamehub/assets/spectrum_cover-EgoVXes7.png",Rs=typeof __firebase_config<"u"?JSON.parse(__firebase_config):{apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},Oe=ts(Rs),ce=as(Oe),I=rs(Oe),E=typeof __app_id<"u"?__app_id:"spectrum-game",zs="24",A={BLUE:{name:"Blue",color:"text-blue-400",bg:"bg-blue-900/40",border:"border-blue-500",icon:me},GREEN:{name:"Green",color:"text-emerald-400",bg:"bg-emerald-900/40",border:"border-emerald-500",icon:Ns},MAGENTA:{name:"Magenta",color:"text-fuchsia-400",bg:"bg-fuchsia-900/40",border:"border-fuchsia-500",icon:G},SILVER:{name:"Silver",color:"text-slate-200",bg:"bg-slate-700/40",border:"border-slate-400",icon:js}},Q={BLUE:0,GREEN:1,MAGENTA:2,SILVER:3},_e=l=>{let k=l.length,f;for(;k!==0;)f=Math.floor(Math.random()*k),k--,[l[k],l[f]]=[l[f],l[k]];return l},_s=({type:l,message:k,subtext:f,icon:b})=>e.jsx("div",{className:"fixed inset-0 z-160 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:`flex flex-col items-center justify-center p-8 md:p-12 rounded-3xl border-4 shadow-[0_0_50px_rgba(0,0,0,0.8)] transform transition-all animate-in fade-in zoom-in slide-in-from-bottom-10 duration-300 backdrop-blur-md
      ${l==="success"?"bg-fuchsia-900/90 border-fuchsia-500 text-fuchsia-100":""}
      ${l==="failure"?"bg-red-900/90 border-red-500 text-red-100":""}
      ${l==="neutral"?"bg-slate-900/90 border-slate-500 text-slate-100":""}
    `,children:[b&&e.jsx("div",{className:"mb-4 p-4 bg-black/30 rounded-full border-2 border-white/20",children:e.jsx(b,{size:64,className:"animate-bounce text-fuchsia-400"})}),e.jsx("h2",{className:"text-3xl md:text-5xl font-black uppercase tracking-widest text-center drop-shadow-lg mb-2",children:k}),f&&e.jsx("p",{className:"text-lg md:text-xl font-bold opacity-90 tracking-wide text-center",children:f})]})}),ee=({isShaking:l})=>e.jsxs("div",{className:`absolute inset-0 overflow-hidden pointer-events-none z-0 ${l?"animate-shake bg-red-900/20":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:[...Array(20)].map((k,f)=>{const b=Object.keys(A),C=A[b[f%b.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(C,{size:32})},f)})}),e.jsx("style",{children:`
      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
      }
      .animate-float { animation: float infinite ease-in-out; }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
      .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    `})]}),de=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(G,{size:12,className:"text-fuchsia-500"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-fuchsia-500 uppercase",children:"SPECTRUM"})]}),Me=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(G,{size:22,className:"text-fuchsia-500"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-fuchsia-500 uppercase",children:"SPECTRUM"})]}),Te=({onConfirmLeave:l,onConfirmLobby:k,onCancel:f,isHost:b,inGame:C})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2 font-serif",children:"Abort Frequency?"}),e.jsx("p",{className:"text-gray-400 mb-6 text-sm",children:b?"WARNING: As Host, shutting down the server will disconnect all users.":C?"Leaving now will destabilize the session for all observers!":"Disconnecting from the backroom..."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:f,className:"bg-gray-700 hover:bg-gray-600 text-white py-3 rounded font-bold transition-colors",children:"Stay Sync'd"}),C&&b&&e.jsxs("button",{onClick:k,className:"py-3 rounded font-bold bg-fuchsia-700 hover:bg-fuchsia-600 text-white flex items-center justify-center gap-2 transition-colors",children:[e.jsx(ue,{size:18})," Return to Backroom"]}),e.jsxs("button",{onClick:l,className:"bg-red-600 hover:bg-red-500 text-white py-3 rounded font-bold flex items-center justify-center gap-2 transition-colors",children:[e.jsx(xe,{size:18})," ",b?"Shut Down Server":"Sever Connection"]})]})]})}),se=({suit:l,val:k,faceDown:f,onClick:b,disabled:C,highlight:B,small:u,tiny:_})=>{const s=f?A.MAGENTA:A[l]||A.MAGENTA,U=f?5:k,W=s.icon;if(_)return e.jsx("div",{className:`w-6 h-8 rounded border flex items-center justify-center ${s.bg} ${s.border} shadow-sm shrink-0`,title:l,children:e.jsx("span",{className:`text-[10px] font-black ${s.color}`,children:U})});const M=u?"w-16 h-24 p-2":"w-24 h-36 md:w-32 md:h-48 p-3";return e.jsxs("button",{onClick:b,disabled:C,className:`relative rounded-xl border-2 shadow-lg transition-all flex flex-col items-center justify-between overflow-hidden
        ${M} ${s.bg} ${s.border}
        ${B?"ring-4 ring-fuchsia-400 scale-105 z-10":""}
        ${C?"opacity-50 cursor-not-allowed grayscale":"hover:scale-105 cursor-pointer"}
      `,children:[f&&e.jsx("div",{className:"absolute inset-0 bg-fuchsia-600/10 flex items-center justify-center pointer-events-none",children:e.jsx(ws,{size:48,className:"text-fuchsia-500/10"})}),e.jsxs("div",{className:`w-full flex justify-between font-black ${u?"text-xs":"text-lg"} ${s.color}`,children:[e.jsx("span",{children:U}),e.jsx(G,{size:u?12:16,opacity:.3})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(W,{size:u?20:32,className:`${s.color} mb-1`}),!u&&e.jsx("span",{className:`text-[8px] uppercase tracking-widest font-black ${s.color} opacity-60`,children:f?"MAGENTA 5":s.name})]}),e.jsx("div",{className:`w-full flex justify-start font-black ${u?"text-xs":"text-lg"} ${s.color} rotate-180`,children:e.jsx("span",{children:U})})]})},Ae=({onClose:l})=>e.jsx("div",{className:"fixed inset-0 bg-black/95 z-170 flex items-center justify-center p-0 md:p-4",children:e.jsxs("div",{className:"bg-gray-900 md:rounded-2xl w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] overflow-hidden border border-fuchsia-500/30 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-black text-fuchsia-500 uppercase tracking-widest font-serif",children:"SYSTEM OVERVIEW"}),e.jsx("span",{className:"text-gray-500 text-[10px] uppercase font-bold tracking-widest",children:"Spectrum Protocol"})]}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-gray-800 rounded-full text-gray-400 hover:text-white transition-colors",children:e.jsx($e,{})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 md:p-8 space-y-8 text-gray-300",children:[e.jsxs("div",{className:"bg-fuchsia-950/20 p-6 rounded-xl border border-fuchsia-500/20",children:[e.jsxs("h3",{className:"text-xl font-bold text-fuchsia-400 mb-2 flex items-center gap-2 font-serif",children:[e.jsx(G,{size:20})," Target: Equilibrium 25"]}),e.jsxs("p",{className:"text-sm md:text-base leading-relaxed opacity-80",children:["Win tricks to collect cards. Your cumulative score must reach"," ",e.jsx("strong",{children:"25"}),". Exceeding 25 causes a"," ",e.jsx("strong",{children:"System Overload (Bust)"}),"â€”you lose chips and forfeit the round score."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-bold text-white uppercase text-[10px] tracking-widest border-b border-gray-800 pb-2",children:"Trick Mechanisms"}),e.jsxs("ul",{className:"space-y-3 text-xs md:text-sm",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 mt-1.5 shrink-0"})," ","Must follow lead suit if possible."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 mt-1.5 shrink-0"})," ",e.jsx("strong",{children:"Silver"})," is always Trump."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500 mt-1.5 shrink-0"})," ","Highest card of lead suit (or Trump) takes the trick."]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-bold text-fuchsia-400 uppercase text-[10px] tracking-widest border-b border-fuchsia-900/50 pb-2",children:"The Magenta 5 Override"}),e.jsxs("ul",{className:"space-y-3 text-xs md:text-sm",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500 mt-1.5 shrink-0"})," ","Any card can be played ",e.jsx("strong",{children:"Face-Down"})," as a Magenta 5."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500 mt-1.5 shrink-0"})," ","Allowed only if unable to follow suit OR if it's your final card of that suit."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500 mt-1.5 shrink-0"})," ","Only ",e.jsx("strong",{children:"one"})," Magenta 5 per trick."]})]})]})]})]}),e.jsx("div",{className:"p-6 bg-gray-950 border-t border-gray-800 text-center",children:e.jsx("button",{onClick:l,className:"w-full md:w-auto bg-fuchsia-700 hover:bg-fuchsia-600 text-white px-16 py-4 rounded-xl font-bold uppercase tracking-widest shadow-lg shadow-fuchsia-900/20",children:"Engage"})})]})}),Ms=({onStart:l})=>{const[k,f]=h.useState(!1),[b,C]=h.useState(!1),[B,u]=h.useState(!1);return h.useEffect(()=>{u(!0);const _=localStorage.getItem("spectrum_roomId");f(!!_);const s=setTimeout(()=>{C(!0)},2e3);return()=>clearTimeout(s)},[]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-black flex flex-col items-center justify-end pb-20 md:justify-center md:pb-0 font-sans overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e.jsx("div",{className:`w-full h-full bg-cover bg-center transition-transform duration-[2000ms] ease-out ${B?"scale-100":"scale-130"}`,style:{backgroundImage:`url(${Es})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40"})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-8 animate-in fade-in slide-in-from-bottom-10 duration-1000",children:e.jsx("div",{className:`transform transition-all duration-1000 ease-out ${b?"translate-y-0 opacity-100":"translate-y-20 opacity-0"}`,children:e.jsxs("button",{onClick:l,className:"group relative px-12 py-5 bg-fuchsia-600/20 hover:bg-fuchsia-600/40 border border-fuchsia-500/50 hover:border-fuchsia-400 text-fuchsia-300 font-black text-2xl tracking-widest rounded-none transform transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.4)] backdrop-blur-md overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-fuchsia-400/10 to-transparent translate-y-[-100%] animate-[scan_2s_infinite_linear]"}),e.jsx("span",{className:"relative z-10 flex items-center gap-3 animate-pulse",children:k?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"animate-spin-slow"})," RESUME"]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{})," PLAY"]})})]})})}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(200%); }
        }
      `})]})};function Ts(){const[l,k]=h.useState(null),[f,b]=h.useState("splash"),[C,B]=h.useState(""),[u,_]=h.useState(""),[s,U]=h.useState(null),[W,M]=h.useState(!1),[ae,L]=h.useState(""),[he,Y]=h.useState(!1),[fe,$]=h.useState(!1),[re,pe]=h.useState(!1),[be,ge]=h.useState(null),[K,le]=h.useState("NORMAL"),[De,ye]=h.useState(!1),[je,Ne]=h.useState(!1),[P,Le]=h.useState(()=>localStorage.getItem("gameHub_playerName")||"");h.useEffect(()=>{P&&localStorage.setItem("gameHub_playerName",P)},[P]),h.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await is(ce,__initial_auth_token):await os(ce))();const a=ls(ce,k);return()=>a()},[]);const Fe=()=>{const t=localStorage.getItem("spectrum_roomId");t&&(M(!0),_(t)),b("menu")};h.useEffect(()=>{if(!u||!l)return;const t=ke(S(I,"artifacts",E,"public","data","rooms",u),a=>{if(a.exists()){const n=a.data();if(!n.players.some(N=>N.id===l.uid)){_(""),b("menu"),localStorage.removeItem("spectrum_roomId"),L("Signal Lost: Kicked by Host");return}U(n),n.status==="playing"?b("game"):n.status==="lobby"?b("lobby"):n.status==="finished"&&b("game")}else _(""),b("menu"),localStorage.removeItem("spectrum_roomId"),L("Synchronicity Terminated (Room Closed)")});return()=>t()},[u,l]),h.useEffect(()=>{if(!s||!l||s.status!=="playing")return;if(s.hostId===l.uid&&s.trick.length===s.players.length){const a=setTimeout(()=>{Ke(s.trick,s.players,s.leadSuit)},1200);return()=>clearTimeout(a)}},[s?.trick?.length,l?.uid,s?.status]),h.useEffect(()=>{const t=ke(S(I,"game_hub_settings","config"),a=>{a.exists()&&a.data()[zs]?.maintenance?ye(!0):ye(!1)});return()=>t()},[]);const H=(t,a,n="",i=null)=>{ge({type:t,message:a,subtext:n,icon:i}),setTimeout(()=>ge(null),2e3)},Ge=async()=>{if(!P)return L("Identifier Required");M(!0);const t="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let a="";for(let i=0;i<6;i++)a+=t.charAt(Math.floor(Math.random()*t.length));const n={roomId:a,hostId:l.uid,status:"lobby",players:[{id:l.uid,name:P,chips:5,hand:[],scorePile:[],scoreTotal:0,busted:!1,ready:!1}],deck:[],trick:[],leadSuit:null,turnIndex:0,roundCount:1,logs:[],reserve:0};await cs(S(I,"artifacts",E,"public","data","rooms",a),n),localStorage.setItem("spectrum_roomId",a),_(a),M(!1)},Be=async()=>{if(!C||!P)return L("Protocol Data Missing");M(!0);const t=S(I,"artifacts",E,"public","data","rooms",C),a=await ds(t);if(!a.exists()){L("Frequency not found"),M(!1);return}const n=a.data();if(n.status!=="lobby"){L("Session locked"),M(!1);return}if(n.players.length>=4){L("Backroom Full"),M(!1);return}const i=[...n.players,{id:l.uid,name:P,chips:5,hand:[],scorePile:[],scoreTotal:0,busted:!1,ready:!1}];await R(t,{players:i}),localStorage.setItem("spectrum_roomId",C),_(C),M(!1)},we=async()=>{if(!s||s.hostId!==l.uid)return;const t=s.players.length,a=t===3?9:13,n=[];Object.keys(A).forEach(o=>{for(let g=1;g<=a;g++)n.push({suit:o,val:g})});const i=_e(n),N=Math.floor(i.length/t),w=s.players.map(o=>{const g=[];for(let p=0;p<N;p++)g.push(i.pop());return{...o,hand:g,scorePile:[],scoreTotal:0,busted:!1,ready:!1}}),m=s.status==="playing";let r;m?r=((s.roundStarterIdx??0)+1)%t:r=Math.floor(Math.random()*t),await R(S(I,"artifacts",E,"public","data","rooms",u),{status:"playing",deck:i,players:w,trick:[],leadSuit:null,turnIndex:r,roundStarterIdx:r,roundResult:null,roundCount:m?xs(1):s.roundCount,logs:Z({text:`Initialized Frequency Sync: Round ${m?s.roundCount+1:s.roundCount}`,type:"neutral"})})},Ue=async()=>{if(!s||s.hostId!==l.uid)return;const t=s.players.map(a=>({...a,chips:5,scoreTotal:0,scorePile:[],hand:[],history:[],busted:!1,ready:!1,roundRank:null}));await R(S(I,"artifacts",E,"public","data","rooms",u),{status:"lobby",roundCount:1,players:t,deck:[],trick:[],roundResult:null,reserve:0,turnIndex:0,logs:[{text:"--- OPERATION COMPLETE: RETURNING TO BASE ---",type:"neutral"}]})},He=async()=>{if(!s||s.hostId!==l.uid)return;const t=s.players.length,a=t===3?9:13,n=[];Object.keys(A).forEach(r=>{for(let o=1;o<=a;o++)n.push({suit:r,val:o})});const i=_e(n),N=Math.floor(i.length/t),w=s.players.map(r=>{const o=[];for(let g=0;g<N;g++)o.push(i.pop());return{...r,chips:5,hand:o,scorePile:[],scoreTotal:0,busted:!1,ready:!1}}),m=Math.floor(Math.random()*t);await R(S(I,"artifacts",E,"public","data","rooms",u),{status:"playing",deck:i,players:w,trick:[],leadSuit:null,turnIndex:m,roundStarterIdx:m,roundCount:1,reserve:0,roundResult:null,logs:[{text:"--- GRID REBOOTED: COMMENCING NEW OPERATION ---",type:"neutral"}]}),$(!1)},Ve=async()=>{if(!s)return;const t=s.players.map(a=>a.id===l.uid?{...a,ready:!0}:a);await R(S(I,"artifacts",E,"public","data","rooms",u),{players:t})},qe=async()=>{if(!s)return;const t=s.players.map(a=>a.id===l.uid?{...a,ready:!0}:a);await R(S(I,"artifacts",E,"public","data","rooms",u),{players:t})},We=async(t,a)=>{if(!s||s.turnIndex===null||s.players[s.turnIndex].id!==l.uid)return;const n=s.players[s.turnIndex],i=n.hand[t];if(s.trick.length>0&&!a&&n.hand.some(y=>y.suit===s.leadSuit)&&i.suit!==s.leadSuit){H("failure","DESYNC","Must maintain lead frequency!");return}if(a){const d=n.hand.some(j=>j.suit===s.leadSuit),y=n.hand.filter(j=>j.suit===s.leadSuit).length===1&&i.suit===s.leadSuit;if(s.trick.some(j=>j.faceDown)){H("failure","JAMMED","One Magenta Override limit!");return}if(s.trick.length>0&&d&&!y){H("failure","INVALID MASK","Cannot mask if able to follow.");return}}const N=[...s.players],w=s.turnIndex;N[w].hand.splice(t,1);const m={playerId:l.uid,playerName:n.name,suit:i.suit,val:i.val,faceDown:a},r=[...s.trick,m];let o=s.leadSuit;s.trick.length===0&&(o=a?"MAGENTA":i.suit);const p=r.length===s.players.length?-1:(s.turnIndex+1)%s.players.length,O=a?`ðŸ“¡ ${n.name} initiated MAGENTA_OVERRIDE (MASKED)`:`ðŸ“¡ ${n.name} transmitted signal: ${i.suit} ${i.val}`;await R(S(I,"artifacts",E,"public","data","rooms",u),{players:N,trick:r,leadSuit:o,turnIndex:p,logs:Z({text:O,type:"neutral"})}),le("NORMAL")},Ye=({roundCount:t,results:a,players:n,isHost:i,hostId:N,onReady:w,onNextRound:m,onFinalize:r,myId:o})=>{const g=n.filter(x=>x.id!==N),p=g.every(x=>x.ready),O=g.filter(x=>x.ready).length,d=g.length,y=n.find(x=>x.id===o),T=Array.from({length:t},(x,D)=>D+1),j=a.isFinal,X=n.find(x=>x.id===a.winnerId)||n[0];return X?.id,e.jsx("div",{className:"fixed inset-0 z-200 flex items-center justify-center p-4 bg-black/90 backdrop-blur-xl animate-in fade-in duration-500",children:e.jsxs("div",{className:`w-full max-w-5xl ${j?"border-2 border-yellow-500/50 shadow-yellow-900/40":"border border-fuchsia-500/30"} bg-gray-900 rounded-3xl shadow-2xl flex flex-col overflow-hidden max-h-[90vh]`,children:[j&&e.jsxs("div",{className:"bg-linear-to-b from-yellow-900/20 to-gray-900 p-8 text-center shrink-0 border-b border-gray-800 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center animate-in slide-in-from-top-10 duration-700",children:[e.jsx(Ee,{size:64,className:"text-yellow-400 drop-shadow-[0_0_15px_rgba(250,204,21,0.6)] mb-4 animate-bounce"}),e.jsx("h1",{className:"text-4xl md:text-6xl font-black text-transparent bg-clip-text bg-linear-to-b from-yellow-200 to-yellow-600 font-serif tracking-[0.2em] uppercase mb-2",children:X.name}),e.jsx("div",{className:"inline-flex items-center gap-2 bg-yellow-950/40 border border-yellow-500/30 px-6 py-2 rounded-full",children:e.jsx("span",{className:"text-yellow-500 font-bold tracking-widest text-xs uppercase",children:"Mission Accomplished"})})]})]}),!j&&e.jsxs("div",{className:"p-6 bg-gray-950 border-b border-gray-800 flex justify-between items-center shrink-0",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-2xl font-black text-white font-serif tracking-widest uppercase",children:["Phase ",t," Report"]})}),e.jsxs("div",{className:"flex gap-4",children:[a.reserve>0&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-fuchsia-900/20 rounded-full border border-fuchsia-500/20",children:[e.jsx(Re,{size:16,className:"text-fuchsia-400"}),e.jsx("span",{className:"text-lg font-mono font-bold text-white",children:a.reserve})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-800/50 rounded-full border border-gray-700",children:[e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-black",children:"Ready"}),e.jsxs("span",{className:"text-lg font-mono font-bold text-white",children:[O,"/",d]})]})]})]}),e.jsxs("div",{className:"p-0 md:p-6 overflow-x-auto flex-1 bg-gray-900",children:[!j&&e.jsx("div",{className:"md:hidden text-center text-[10px] text-gray-500 uppercase py-2",children:"Scroll for details â†’"}),e.jsxs("table",{className:"w-full text-left border-collapse whitespace-nowrap",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-[10px] text-gray-500 uppercase tracking-widest border-b border-gray-800",children:[e.jsx("th",{className:"pb-3 pl-4 sticky left-0 bg-gray-900 z-20",children:"Rank"}),e.jsx("th",{className:"pb-3 sticky left-14 bg-gray-900 z-20",children:"Unit"}),T.map(x=>e.jsxs(Se.Fragment,{children:[e.jsxs("th",{className:"pb-3 text-center px-2 border-l border-gray-800 text-fuchsia-400/50",children:["R",x," Eq"]}),e.jsx("th",{className:"pb-3 text-center px-2 text-fuchsia-400/50",children:"Diff"})]},x)),e.jsx("th",{className:"pb-3 text-right pl-4 pr-4 border-l border-gray-800 text-white sticky right-0 bg-gray-900 z-20",children:"Total"})]})}),e.jsx("tbody",{className:"text-sm",children:a.breakdown.map(x=>{const D=x.id===o,ve=n.find(V=>V.id===x.id)?.history||[];return e.jsxs("tr",{className:`border-b border-gray-800/50 ${D?"bg-fuchsia-900/10":""}`,children:[e.jsx("td",{className:"py-4 pl-4 font-mono text-gray-400 sticky left-0 bg-gray-900/95 z-10",children:x.busted?e.jsx("span",{className:"text-red-500",children:"âš "}):`#${x.rank}`}),e.jsx("td",{className:`py-4 font-bold sticky left-14 bg-gray-900/95 z-10 ${D?"text-fuchsia-300":"text-gray-300"}`,children:x.name}),T.map((V,oe)=>{const z=ve[oe];return e.jsxs(Se.Fragment,{children:[e.jsx("td",{className:"py-4 text-center font-mono border-l border-gray-800 px-2 text-gray-500",children:z?z.eq:"-"}),e.jsx("td",{className:"py-4 text-center font-mono font-bold px-2",children:z?z.diff>0?e.jsxs("span",{className:"text-green-400",children:["+",z.diff]}):z.diff<0?e.jsx("span",{className:"text-red-400",children:z.diff}):e.jsx("span",{className:"text-gray-600",children:"-"}):"-"})]},V)}),e.jsx("td",{className:"py-4 text-right pr-4 font-mono font-bold text-white border-l border-gray-800 sticky right-0 bg-gray-900/95 z-10",children:x.chipsTotal})]},x.id)})})]})]}),e.jsx("div",{className:"p-6 bg-gray-950 border-t border-gray-800 flex justify-end gap-3 shrink-0",children:i?e.jsx("button",{onClick:j?r:m,disabled:!j&&!p,className:`px-8 py-4 rounded-xl font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all w-full md:w-auto ${j?"bg-yellow-600 hover:bg-yellow-500 text-white shadow-lg shadow-yellow-900/20":p?"bg-fuchsia-600 hover:bg-fuchsia-500 text-white shadow-lg":"bg-gray-800 text-gray-600 cursor-not-allowed opacity-50"}`,children:j?e.jsxs(e.Fragment,{children:[" ",e.jsx(ue,{size:18})," Return to Base"," "]}):e.jsxs(e.Fragment,{children:[" ",e.jsx(Is,{size:18})," ",p?"Initialize Next Phase":"Awaiting Signals..."," "]})}):e.jsx("button",{onClick:w,disabled:j||y?.ready,className:`px-8 py-4 rounded-xl font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all w-full md:w-auto ${j?"bg-gray-800 text-gray-500 cursor-default":y?.ready?"bg-green-900/30 border border-green-500/50 text-green-500 cursor-default":"bg-fuchsia-600 hover:bg-fuchsia-500 text-white shadow-lg animate-pulse"}`,children:j?"Awaiting Host...":y?.ready?"Standing By":"Signal Ready"})})]})})},Ke=async(t,a,n)=>{let i=t[0].playerId,N=-1;const w=t.filter(d=>d.suit==="SILVER"&&!d.faceDown);if(w.length>0)N=Math.max(...w.map(d=>d.val)),i=w.find(d=>d.val===N).playerId;else{const d=t.filter(y=>y.suit===n&&!y.faceDown||y.faceDown&&n==="MAGENTA");d.length>0&&(N=Math.max(...d.map(y=>y.faceDown?5:y.val)),i=d.find(y=>(y.faceDown?5:y.val)===N).playerId)}const m=a.findIndex(d=>d.id===i),r=t.find(d=>d.playerId===i),o=r.faceDown?5:r.val,g=[],p=a.map(d=>({...d}));if(p[m].scorePile=[...p[m].scorePile,r],p[m].scoreTotal+=o,p[m].scoreTotal>25&&(p[m].busted=!0,g.push({text:`âš ï¸ SYSTEM_OVERLOAD: ${p[m].name} BUSTED at ${p[m].scoreTotal}`,type:"danger"})),p.every(d=>d.hand.length===0)){const d=JSON.parse(JSON.stringify(p)),y={};d.forEach(c=>y[c.id]=c.chips);const T={};d.filter(c=>!c.busted).forEach(c=>{const v=Math.abs(25-c.scoreTotal);T[v]||(T[v]=[]),T[v].push(c.id)});const j=Object.keys(T).map(Number).sort((c,v)=>c-v),X=d.length===3?[2,1,0]:[3,2,1,0];let x=s.reserve||0,D=0;j.forEach(c=>{const v=T[c],Ze=X[D]||0,Qe=D+1;v.forEach(es=>{const J=d.find(ss=>ss.id===es);J.chips+=Ze,J.roundRank=Qe,c===0&&(J.chips+=1,g.push({text:`ðŸŽ¯ PERFECT_SYNC: ${J.name} (+1 Bonus)`,type:"success"}))}),D+=v.length}),d.forEach(c=>{c.busted&&(c.chips-=1,c.roundRank=99,x+=1)});const ie=T[j[0]]||[];if(ie.length===1){const c=d.find(v=>v.id===ie[0]);x>0&&(c.chips+=x,g.push({text:`âš¡ RESERVE CAPTURED: ${c.name} (+${x})`,type:"success"}),x=0)}d.forEach(c=>{Array.isArray(c.history)||(c.history=[]);const v=c.chips-y[c.id];c.history.push({eq:Number(c.scoreTotal),diff:Number(v)})});const V=d.map(c=>({id:c.id,name:c.name,chipsTotal:c.chips,rank:c.roundRank,busted:c.busted})).sort((c,v)=>c.busted===v.busted?v.chipsTotal-c.chipsTotal:c.busted?1:-1),oe=[...d].sort((c,v)=>v.chips-c.chips)[0],z=s.roundCount>=4||d.some(c=>c.chips>=25);z&&x>0&&(x=0),await R(S(I,"artifacts",E,"public","data","rooms",u),{players:d,trick:[],leadSuit:null,turnIndex:null,status:"playing",reserve:x,roundResult:{breakdown:V,reserve:x,isFinal:z,winnerId:z?oe.id:null},logs:Z(...g,{text:`--- Phase ${s.roundCount} Complete ---`,type:"neutral"})})}else await R(S(I,"artifacts",E,"public","data","rooms",u),{players:p,trick:[],leadSuit:null,turnIndex:m,logs:Z(...g,{text:`âœ… Trick secured by ${p[m].name}`,type:"success"})})},ne=async()=>{if(!u)return;const t=S(I,"artifacts",E,"public","data","rooms",u);try{if(s?.hostId===l.uid)await us(t);else{const a=s.players.filter(n=>n.id!==l.uid);await R(t,{players:a})}}catch(a){console.error(a)}localStorage.removeItem("spectrum_roomId"),_(""),b("menu"),$(!1)},Xe=()=>{const t=s.roomId,a=()=>{Ne(!0),setTimeout(()=>Ne(!1),2e3),H&&H("neutral","COPIED!","",q)};try{navigator.clipboard.writeText(t),a()}catch{const i=document.createElement("textarea");i.value=t,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),a()}},Je=async t=>{if(!s||s.hostId!==l.uid)return;const a=s.players.filter(n=>n.id!==t);await R(S(I,"artifacts",E,"public","data","rooms",u),{players:a})};if(De)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(Me,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(ns,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"The system is running short of chips. Wait until new chips are built and delivered."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(F,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(F,{size:16})]})})})}),e.jsx(de,{})]});if(!l)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-fuchsia-500 animate-pulse",children:"Merging frequencies..."});if(u&&!s&&!ae)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(ee,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(hs,{size:48,className:"text-fuchsia-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(f==="splash")return e.jsx(Ms,{onStart:Fe});if(f==="menu")return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(ee,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-fuchsia-800 rounded-lg 
			font-bold shadow-md hover:text-fuchsia-400 transition-colors w-fit animate-pulse`,children:[e.jsx(fs,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),he&&e.jsx(Ae,{onClose:()=>Y(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(G,{size:64,className:"text-fuchsia-500 mx-auto mb-4 animate-bounce drop-shadow-[0_0_20px_rgba(217,70,239,0.4)]"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-linear-to-b from-fuchsia-300 to-fuchsia-600 font-serif tracking-[0.2em]",children:"SPECTRUM"}),e.jsx("p",{className:"text-white-400/60 tracking-[0.3em] uppercase mt-2",children:"THE MAGENTA EQUILIBRIUM"})]}),e.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/20 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10",children:[ae&&e.jsx("div",{className:"bg-red-900/40 text-red-200 p-3 mb-4 rounded border border-red-800 text-center text-xs",children:ae}),e.jsx("input",{className:"w-full bg-black/60 border border-gray-700 p-3 rounded mb-4 text-white placeholder-gray-600 focus:border-fuchsia-500 outline-none transition-all uppercase font-mono tracking-widest text-sm",placeholder:"AGENT_IDENTIFIER",value:P,onChange:t=>Le(t.target.value)}),e.jsxs("button",{onClick:Ge,disabled:W,className:"w-full bg-fuchsia-700 hover:bg-fuchsia-600 p-4 rounded-xl font-black mb-4 flex items-center justify-center gap-2 shadow-lg tracking-widest uppercase transition-all text-sm",children:[e.jsx(G,{size:18})," Establish Grid"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx("input",{className:"w-full sm:flex-1 bg-black/60 border border-gray-700 p-3 rounded text-white placeholder-gray-600 uppercase font-mono tracking-widest text-sm outline-none",placeholder:"ROOM_CODE",value:C,onChange:t=>B(t.target.value.toUpperCase())}),e.jsx("button",{onClick:Be,disabled:W,className:"w-full sm:w-auto bg-gray-800 hover:bg-gray-700 border border-gray-700 px-6 py-3 rounded-xl font-bold text-xs uppercase tracking-widest",children:"Infiltrate"})]}),e.jsxs("button",{onClick:()=>Y(!0),className:"w-full text-[10px] text-gray-500 hover:text-fuchsia-400 flex items-center justify-center gap-2 uppercase tracking-widest",children:[e.jsx(Ie,{size:14})," System Manual"]})]}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Fives. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),". Visit"," ",e.jsx("a",{href:"/rawfids-gamehub/",rel:"noopener noreferrer",className:"text-fuchsia-500 underline hover:text-fuchsia-600",children:"GAMEHUB"})," ","for more games."]})]});if(f==="lobby"&&s){const t=s.hostId===l.uid;return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-6 relative",children:[e.jsx(ee,{}),e.jsx(Me,{}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-gray-900/95 backdrop-blur-xl p-8 rounded-2xl border border-fuchsia-900/30 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-800 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-fuchsia-500 font-bold uppercase",children:"Frequency"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:u}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:Xe,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:je?e.jsx(q,{size:16,className:"text-green-500"}):e.jsx(ps,{size:16})}),je&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-fuchsia-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsx("button",{onClick:()=>$(!0),className:"p-2 bg-red-900/20 hover:bg-red-900/40 rounded text-red-400 transition-colors",children:e.jsx(xe,{size:16})})]}),e.jsx("div",{className:"space-y-3 mb-10",children:s.players.map(a=>e.jsxs("div",{className:"flex items-center justify-between bg-black/40 p-4 rounded-xl border border-gray-800",children:[e.jsxs("span",{className:`font-black flex items-center gap-2 text-sm uppercase tracking-widest ${a.id===l.uid?"text-fuchsia-400":"text-gray-400"}`,children:[e.jsx(Ce,{size:14})," ",a.name," ",a.id===s.hostId&&e.jsx(F,{size:14,className:"text-yellow-500"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-green-500 text-[10px] font-black uppercase tracking-tighter flex items-center gap-1 animate-pulse",children:[e.jsx(q,{size:10})," Active"]}),t&&a.id!==s.hostId&&e.jsx("button",{onClick:()=>Je(a.id),className:"p-1.5 text-gray-600 hover:text-red-500 hover:bg-red-900/20 rounded-lg transition-all",title:"Kick Player",children:e.jsx(gs,{size:16})})]})]},a.id))}),t?e.jsx("button",{onClick:we,disabled:s.players.length<3,className:`w-full py-5 rounded-xl font-black uppercase tracking-[0.2em] transition-all shadow-xl ${s.players.length>=3?"bg-fuchsia-700 hover:bg-fuchsia-600 text-white shadow-fuchsia-900/20":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:s.players.length<3?"Awaiting Data (3+ Required)":"Commence Protocol"}):e.jsx("div",{className:"text-center text-fuchsia-500/50 animate-pulse font-serif italic text-sm",children:"Synchronizing with host authority..."})]}),fe&&e.jsx(Te,{onCancel:()=>$(!1),onConfirmLeave:ne,isHost:t}),e.jsx(de,{})]})}if(f==="game"&&s){const t=s.players.find(r=>r.id===l.uid);if(!t)return null;const a=s.turnIndex!==null&&s.turnIndex!==-1&&s.players[s.turnIndex]?.id===l.uid,n=s.hostId===l.uid,i=s.turnIndex===null&&s.status==="playing",N=t?[...t.hand].map((r,o)=>({...r,originalIdx:o})).sort((r,o)=>Q[r.suit]!==Q[o.suit]?Q[r.suit]-Q[o.suit]:r.val-o.val):[],w=s.players.filter(r=>r.id!==s.hostId).every(r=>r.ready),m=[...s.players].sort((r,o)=>o.chips-r.chips)[0];return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col relative overflow-hidden font-sans",children:[e.jsx(ee,{}),be&&e.jsx(_s,{...be}),he&&e.jsx(Ae,{onClose:()=>Y(!1)}),fe&&e.jsx(Te,{onCancel:()=>$(!1),onConfirmLeave:ne,onConfirmLobby:()=>{const r=s.players.map(o=>({...o,chips:5,scoreTotal:0,scorePile:[],hand:[],history:[],busted:!1,ready:!1}));R(S(I,"artifacts",E,"public","data","rooms",u),{status:"lobby",roundCount:1,roundResult:null,reserve:0,players:r,deck:[],trick:[],logs:[]}),$(!1)},isHost:n,inGame:!0}),e.jsxs("div",{className:"h-14 bg-gray-950/90 border-b border-fuchsia-900/30 flex items-center justify-between px-4 z-160 backdrop-blur-md sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-2 font-serif font-black text-fuchsia-500 tracking-[0.2em]",children:["SPECTRUM"," ",e.jsxs("span",{className:"text-[10px] text-gray-500 font-sans tracking-widest ml-1 opacity-70",children:["(ROUND ",s.roundCount,")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.reserve>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-fuchsia-900/40 px-3 py-1 rounded-full border border-fuchsia-500/30 mr-2 animate-in fade-in slide-in-from-right-4 duration-500",children:[e.jsx(Re,{size:12,className:"text-fuchsia-400"}),e.jsxs("span",{className:"text-[10px] font-black text-fuchsia-300 uppercase tracking-tighter",children:["EXTRA_CHIPS: ",s.reserve]})]}),e.jsx("button",{onClick:()=>Y(!0),className:"p-2 hover:bg-gray-800 rounded text-gray-400 transition-colors",children:e.jsx(Ie,{size:18})}),e.jsx("button",{onClick:()=>pe(!re),className:`p-2 rounded-full ${re?"bg-fuchsia-900 text-fuchsia-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(ys,{size:18})}),e.jsx("button",{onClick:()=>$(!0),className:"p-2 hover:bg-red-900/40 rounded text-red-400 transition-colors",children:e.jsx(xe,{size:18})})]})]}),e.jsxs("div",{className:"flex-1 p-2 md:p-4 flex flex-col items-center justify-between relative z-10 w-full max-w-6xl mx-auto",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 w-full justify-center",children:s.players.map((r,o)=>{if(r.id===l.uid)return null;const g=s.turnIndex===o;return e.jsxs("div",{className:`bg-black/60 p-3 rounded-xl border-2 transition-all 
                  ${g?"border-fuchsia-500 scale-105 shadow-xl shadow-fuchsia-900/40 animate-pulse":"border-gray-800"} 
                  ${r.busted?"opacity-30 grayscale":""}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-black text-[10px] uppercase tracking-wider truncate max-w-[70px]",children:r.name}),e.jsxs("div",{className:"flex gap-1 items-center bg-gray-900 px-2 rounded-full border border-gray-700",children:[e.jsx(F,{size:8,className:"text-yellow-400"}),e.jsx("span",{className:"text-[10px] font-mono",children:r.chips})]})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("div",{className:"flex -space-x-3",children:r.hand.map((p,O)=>e.jsx("div",{className:"w-4 h-6 bg-fuchsia-950 rounded border border-fuchsia-800"},O))}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-[10px] font-black tracking-tighter ${r.busted?"text-red-500":"text-fuchsia-400"}`,children:["EQ: ",r.scoreTotal]}),e.jsx("div",{className:"flex flex-wrap gap-0.5 justify-end max-w-[80px]",children:r.scorePile.map((p,O)=>e.jsx(se,{...p,tiny:!0},O))})]})]})]},r.id)})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center w-full relative",children:[i&&s.roundResult&&s.roundResult.breakdown&&e.jsx(Ye,{roundCount:s.roundCount,results:s.roundResult,players:s.players,isHost:n,hostId:s.hostId,myId:l.uid,onReady:qe,onNextRound:we,onFinalize:Ue}),e.jsxs("div",{className:"relative w-full max-w-md flex flex-wrap gap-4 justify-center items-center",children:[s.trick.map((r,o)=>e.jsxs("div",{className:"animate-in zoom-in slide-in-from-bottom-4 duration-500 flex flex-col items-center",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black text-center mb-1 tracking-tighter truncate w-24",children:r.playerName}),e.jsx(se,{...r,small:!0})]},o)),s.trick.length===0&&!i&&e.jsxs("div",{className:"text-gray-800 uppercase tracking-[0.5em] font-black text-center opacity-40 select-none flex flex-col items-center",children:[e.jsx(me,{size:64,className:"mb-4 text-fuchsia-900"}),"IDLE_GRID"]})]}),s.leadSuit&&!i&&e.jsxs("div",{className:"mt-8 bg-gray-900/80 border border-fuchsia-500/20 px-6 py-2 rounded-full text-[10px] font-black uppercase tracking-[0.2em] backdrop-blur-md",children:["Protocol:"," ",e.jsx("span",{className:A[s.leadSuit]?.color,children:A[s.leadSuit]?.name})]})]}),e.jsxs("div",{className:"w-full bg-gray-900/98 border-t-2 border-fuchsia-500/20 p-4 md:p-6 rounded-t-[2.5rem] shadow-[0_-20px_50px_rgba(0,0,0,0.8)] backdrop-blur-2xl",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`px-5 py-3 rounded-2xl flex items-center gap-3 border transition-all ${t.busted?"bg-red-950/40 border-red-500 shadow-red-900/20":"bg-fuchsia-950/40 border-fuchsia-500 shadow-fuchsia-900/20"}`,children:[e.jsx(me,{className:t.busted?"text-red-500":"text-fuchsia-400",size:24}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-2xl font-black leading-none ${t.busted?"text-red-500":"text-fuchsia-100"}`,children:t.scoreTotal}),e.jsx("span",{className:"text-[8px] uppercase font-black tracking-widest text-gray-500",children:"Equilibrium"})]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-700 px-4 py-2 rounded-xl flex items-center gap-2",children:[e.jsx(F,{size:16,className:"text-yellow-400"}),e.jsx("span",{className:"text-xl font-mono font-bold",children:t.chips})]}),e.jsxs("div",{className:"flex flex-col border-l border-gray-800 pl-4 ml-2",children:[e.jsx("span",{className:"text-[8px] uppercase text-gray-500 font-black mb-1",children:"Acquired"}),e.jsx("div",{className:"flex flex-wrap gap-0.5 max-w-[150px]",children:t.scorePile.map((r,o)=>e.jsx(se,{...r,tiny:!0},o))})]})]}),a&&!i&&e.jsxs("div",{className:"flex bg-black/50 p-1.5 rounded-xl border border-gray-800 shadow-inner",children:[e.jsx("button",{onClick:()=>le("NORMAL"),className:`px-2 sm:px-4 py-2 text-[8px] font-black tracking-widest uppercase rounded-lg transition-all ${K==="NORMAL"?"bg-fuchsia-600 text-white shadow-lg":"text-gray-500 hover:text-gray-400"}`,children:"Signal"}),e.jsx("button",{onClick:()=>le("FACEDOWN"),className:`px-2 sm:px-4 py-2 text-[8px] font-black tracking-widest uppercase rounded-lg transition-all ${K==="FACEDOWN"?"bg-fuchsia-600 text-white shadow-lg":"text-gray-500 hover:text-gray-400"}`,children:"Override"})]})]}),e.jsxs("div",{className:"flex gap-3 overflow-x-auto pt-6 pb-8 px-4 justify-start lg:justify-center items-end h-64 scrollbar-hide scroll-smooth",children:[N.map(r=>e.jsx("div",{className:`${a?"hover:translate-y-[-10px]":""} transition-transform duration-300 shrink-0`,children:e.jsx(se,{suit:r.suit,val:r.val,faceDown:K==="FACEDOWN",onClick:()=>a&&We(r.originalIdx,K==="FACEDOWN"),disabled:!a,highlight:a})},r.originalIdx)),t.hand.length===0&&s.trick.length>0&&e.jsx("div",{className:"text-gray-600 font-black uppercase text-xs animate-pulse",children:"Syncing Pulse..."}),t.hand.length===0&&s.trick.length===0&&!i&&s.status!=="finished"&&e.jsx("div",{className:"text-fuchsia-600 font-black uppercase text-xs animate-pulse",children:"Protocol Initializing..."})]})]})]}),re&&e.jsx("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-gray-900/95 border border-gray-700 rounded-xl z-155 overflow-y-auto p-2 shadow-2xl",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-800 w-full max-w-md h-[60vh] rounded-2xl flex flex-col shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-950 flex justify-between items-center border-b border-gray-800",children:[e.jsx("span",{className:"font-serif font-black text-fuchsia-500 tracking-widest uppercase text-sm",children:"System_Logs"}),e.jsx("button",{onClick:()=>pe(!1),children:e.jsx($e,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...s.logs].reverse().map((r,o)=>e.jsx("div",{className:`text-[10px] font-mono p-2 border-l-2 bg-black/30 ${r.type==="success"?"border-fuchsia-500 text-fuchsia-300":r.type==="danger"?"border-red-500 text-red-300":"border-gray-700 text-gray-500"}`,children:r.text},o))})]})}),s.status==="finished"&&e.jsxs("div",{className:"fixed inset-0 top-14 bg-black/95 z-150 flex flex-col items-center justify-center p-4 backdrop-blur-2xl",children:[e.jsxs("div",{className:"relative mb-10",children:[e.jsx(Ee,{size:100,className:"text-yellow-400 drop-shadow-[0_0_30px_rgba(250,204,21,0.5)] animate-bounce"}),e.jsx("span",{className:"absolute -top-4 -right-4 text-fuchsia-400 animate-pulse",children:e.jsx(F,{size:32})})]}),e.jsx("h1",{className:"text-4xl md:text-6xl font-serif font-black text-white mb-2 uppercase tracking-[0.4em] text-center",children:"SYNCHRONIZED"}),e.jsx("div",{className:"bg-fuchsia-950/40 border border-fuchsia-500/30 px-6 py-2 rounded-full mb-12",children:e.jsxs("p",{className:"text-fuchsia-400 font-mono text-xs tracking-[0.2em] uppercase font-black",children:["Protocol_Victor:"," ",e.jsx("span",{className:"text-white ml-2",children:m?.name})]})}),e.jsxs("div",{className:"w-full max-w-lg space-y-3 mb-16 overflow-y-auto max-h-[30vh]",children:[e.jsx("h3",{className:"text-center text-[10px] font-black text-gray-600 uppercase tracking-[0.3em] mb-4",children:"Unit Summary"}),s.players.map(r=>e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-2xl border transition-all ${r.id===m.id?"bg-fuchsia-900/30 border-fuchsia-500 shadow-lg shadow-fuchsia-900/20":"bg-black/40 border-gray-800 opacity-80"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{size:18,className:r.id===m.id?"text-fuchsia-400":"text-gray-600"}),e.jsx("span",{className:`font-black text-sm uppercase tracking-wider ${r.id===m.id?"text-fuchsia-100":"text-gray-400"}`,children:r.name}),r.ready&&r.id!==s.hostId&&e.jsx(q,{size:14,className:"text-green-500 ml-2"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{size:14,className:"text-yellow-400"}),e.jsx("span",{className:"font-mono text-lg font-bold",children:r.chips})]})]},r.id))]}),e.jsxs("div",{className:"space-y-4 w-full max-w-sm",children:[n?e.jsxs(e.Fragment,{children:[!w&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-red-400 text-[10px] font-black uppercase tracking-widest animate-pulse mb-2",children:[e.jsx(ze,{size:12})," Awaiting Signal from Observers..."]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:He,disabled:!w,className:`py-5 rounded-2xl font-black uppercase tracking-widest text-xs flex items-center justify-center gap-2 shadow-xl transition-all ${w?"bg-fuchsia-700 hover:bg-fuchsia-600 text-white shadow-fuchsia-900/20":"bg-gray-800 text-gray-500 cursor-not-allowed opacity-50"}`,children:[e.jsx(Pe,{size:16})," Reboot"]}),e.jsxs("button",{onClick:()=>{const r=s.players.map(o=>({...o,ready:!1}));R(S(I,"artifacts",E,"public","data","rooms",u),{status:"lobby",roundCount:1,roundResult:null,reserve:0,players:r}),$(!1)},disabled:!w,className:`py-5 rounded-2xl font-black uppercase tracking-widest text-xs flex items-center justify-center gap-2 border transition-all ${w?"border-fuchsia-600 text-fuchsia-400 hover:bg-fuchsia-900/20":"border-gray-800 text-gray-600 cursor-not-allowed opacity-50"}`,children:[e.jsx(ue,{size:16})," Backroom"]})]})]}):e.jsx("button",{onClick:Ve,disabled:t?.ready,className:`w-full py-5 rounded-2xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-3 shadow-xl transition-all ${t?.ready?"bg-black/50 border border-green-500 text-green-500 cursor-default":"bg-fuchsia-700 hover:bg-fuchsia-600 text-white shadow-fuchsia-900/20"}`,children:t?.ready?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:20})," Signal_Acquired"]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:20})," Transmit_Readiness"]})}),e.jsx("button",{onClick:ne,className:"w-full bg-transparent hover:bg-red-950/20 text-gray-600 hover:text-red-400 py-4 rounded-xl font-bold uppercase tracking-[0.2em] text-[10px] transition-all",children:"Sever_Connection"})]})]}),e.jsx(de,{})]})}return null}ms.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(Ts,{})}));
