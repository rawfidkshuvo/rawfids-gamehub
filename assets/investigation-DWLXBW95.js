import{c as Ke,i as ft,g as jt,a as Nt,r as d,e as vt,d as g,o as _e,u as y,q as T,j as e,H as Pe,S as J,X as we,n as yt,s as ze,h as wt,p as St,t as Be,R as Ct,m as Et}from"./x-vdu6PxPT.js";import{L as It,S as kt,B as Ve,C as je,a as Tt,b as Le}from"./step-back-DgPuYW0s.js";import{H as te,C as Rt}from"./hat-glasses-WqOJQKhK.js";import{U as qe}from"./user-hi-jrCL7.js";import{S as At}from"./settings-BLesBdFP.js";import{T as Mt}from"./trash-2-CC3Hg-Aa.js";import{G as Dt}from"./gavel-CJ-N0LgK.js";import{S as se}from"./search-Dn0gxp0x.js";import{T as ye}from"./target-sC2nYOgS.js";import{C as Ot}from"./crosshair-S3deBiGz.js";import{T as Gt}from"./triangle-alert-CO8fZ1I9.js";import{S as ae}from"./skull--JE29QMg.js";import{H as Ye}from"./history-r3RmdCN7.js";import{E as Se}from"./eye-ByZgRM3i.js";import{E as He}from"./eye-off-D-xHY3rk.js";import{B as Je}from"./briefcase-ClWMkL6D.js";const Wt=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]],G=Ke("badge",Wt);const _t=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ue=Ke("chevron-up",_t),Pt={apiKey:"AIzaSyBjIjK53vVJW1y5RaqEFGSFp0ECVDBEe1o",authDomain:"game-hub-ff8aa.firebaseapp.com",projectId:"game-hub-ff8aa",storageBucket:"game-hub-ff8aa.firebasestorage.app",messagingSenderId:"586559578902",appId:"1:586559578902:web:91da4fa4ace038d16aa637"},Xe=ft(Pt),X=jt(Xe),f=Nt(Xe),j=typeof __app_id<"u"?__app_id:"investigation-game",zt="2",Bt=["Kitchen Knife","Dagger","Crossed Swords","Fire Axe","Pickaxe","Hook","Scissors","Champagne Bottle","Katana","Blade","Saw","Hammer","Cricket Bat","Field Hockey Stick","Wrench","Crowbar","Brick","Moai Statue","Candlestick","Frying Pan","Stone","Pistol","Silenced Gun","Boxing Glove","Shotgun","Bow and Arrow","Rope","Wire","Necktie","Teddy Bear","Plastic Bag","Chain","Scarf","Arsenic","Cyanide Pill","Venomous Snake","Syringe","Sleeping Pills","Chainsaw","Explosives","Dynamite","Electrocution","Drowning","Push from Heights","Vehicle","Trophy","Screwdriver","Clamp","Fist","Electric Plug","Fire","Oil Drum","Lighter"],Vt=["Hand","Shoe","Blood Stain","DNA Sample","T-Shirt","Shirt Button","Sewing Thread","Wedding Ring","Wristwatch","Gem Stone","Glasses","Purse","Name Badge","Credit Card","Receipt","Ticket","Memo","Notebook","Framed Picture","World Map","Floppy Disk","Smartphone","Laptop","Key","Coin","Cigarette","Flashlight","Funeral Urn","Ice Cube","Fork and Knife","Wilted Flower","Leaf","Droplet","Oil Drum","Artist Palette","Fountain Pen","Candy","Wine Glass","Hot Beverage","Kiss Mark","Lotion Bottle","Salt Shaker","Collision","Hammer","Glove","Ninja Mask","Joker Card","Game Die","Mirror"],Lt={"Kitchen Knife":"ðŸ”ª",Dagger:"ðŸ—¡ï¸","Crossed Swords":"âš”ï¸","Fire Axe":"ðŸª“",Pickaxe:"â›ï¸",Hook:"ðŸª",Scissors:"âœ‚ï¸","Champagne Bottle":"ðŸ¾",Katana:"âš”ï¸",Blade:"ðŸ”ª",Saw:"ðŸªš",Hammer:"ðŸ”¨","Cricket Bat":"ðŸ","Field Hockey Stick":"ðŸ‘",Wrench:"ðŸ”§",Crowbar:"ðŸ› ï¸",Brick:"ðŸ§±","Moai Statue":"ðŸ—¿",Candlestick:"ðŸ•¯ï¸","Frying Pan":"ðŸ³",Stone:"ðŸª¨",Pistol:"ðŸ”«","Silenced Gun":"ðŸ”«","Boxing Glove":"ðŸ¥Š",Shotgun:"ðŸ”«","Bow and Arrow":"ðŸ¹",Rope:"ðŸª¢",Wire:"âž°",Necktie:"ðŸ‘”","Teddy Bear":"ðŸ§¸","Plastic Bag":"ðŸ›ï¸",Chain:"â›“ï¸",Scarf:"ðŸ§£",Arsenic:"â˜ ï¸","Cyanide Pill":"ðŸ’Š","Venomous Snake":"ðŸ",Syringe:"ðŸ’‰","Sleeping Pills":"ðŸ’¤",Chainsaw:"ðŸªš",Explosives:"ðŸ’£",Dynamite:"ðŸ§¨",Electrocution:"âš¡",Drowning:"ðŸŒŠ","Push from Heights":"ðŸ§—",Vehicle:"ðŸš—",Trophy:"ðŸ†",Screwdriver:"ðŸª›",Clamp:"ðŸ—œï¸",Fist:"ðŸ‘Š","Electric Plug":"ðŸ”Œ",Fire:"ðŸ”¥","Oil Drum":"ðŸ›¢ï¸",Lighter:"ðŸ”¥",Hand:"âœ‹",Shoe:"ðŸ‘ž","Blood Stain":"ðŸ©¸","DNA Sample":"ðŸ§¬","T-Shirt":"ðŸ‘•","Shirt Button":"ðŸ”˜","Sewing Thread":"ðŸ§µ","Wedding Ring":"ðŸ’",Wristwatch:"âŒš","Gem Stone":"ðŸ’Ž",Glasses:"ðŸ‘“",Purse:"ðŸ‘›","Name Badge":"ðŸ“›","Credit Card":"ðŸ’³",Receipt:"ðŸ§¾",Ticket:"ðŸŽ«",Memo:"ðŸ“",Notebook:"ðŸ““","Framed Picture":"ðŸ–¼ï¸","World Map":"ðŸ—ºï¸","Floppy Disk":"ðŸ’¾",Smartphone:"ðŸ“±",Laptop:"ðŸ’»",Key:"ðŸ”‘",Coin:"ðŸª™",Cigarette:"ðŸš¬",Flashlight:"ðŸ”¦","Funeral Urn":"âš±ï¸","Ice Cube":"ðŸ§Š","Fork and Knife":"ðŸ½ï¸","Wilted Flower":"ðŸ¥€",Leaf:"ðŸƒ",Droplet:"ðŸ’§","Artist Palette":"ðŸŽ¨","Fountain Pen":"âœ’ï¸",Candy:"ðŸ¬","Wine Glass":"ðŸ·","Hot Beverage":"â˜•","Kiss Mark":"ðŸ’‹","Lotion Bottle":"ðŸ§´","Salt Shaker":"ðŸ§‚",Collision:"ðŸ’¥",Glove:"ðŸ§¤","Ninja Mask":"ðŸ¥·","Joker Card":"ðŸƒ","Game Die":"ðŸŽ²",Mirror:"ðŸªž"},Z={FIXED:{title:"Cause of Death",type:"purple",options:["Suffocation","Severe Injury","Loss of Blood","Chemical / Sickness","Accident","Projectile / Blast"]},MAIN:[{title:"Location of Crime",type:"green",options:["Living Room","Bedroom","Kitchen / Dining","Bathroom","Balcony","Garden"]},{title:"Location of Crime",type:"green",options:["Office","Hotel","Restaurant","Pub/Bar","School","Hospital"]},{title:"Location of Crime",type:"green",options:["Vacation home","Park","Supermarket","Forest","University","Bookstore"]},{title:"Location of Crime",type:"green",options:["Playground","Classroom","Dormitory","Cafeteria","Lift","Toilet"]}],SUBORDINATE:[{title:"Duration of Crime",options:["Instantaneous","Few Seconds","Few Minutes","Under an Hour","Several Hours","Days"]},{title:"Trace at Scene",options:["Footprints","Fingerprints","Blood/Fluids","Smell/Scent","Sound/Recording","Writing/Marks"]},{title:"Weapon Type",options:["Sharp","Blunt","Toxin/Chemical","Projectile","Everyday Object","Machinery/Tool"]},{title:"Weapon Property",options:["Heavy","Lightweight","Long","Short/Small","Noisy","Silent"]},{title:"Weapon Origin",options:["Household","Industrial/Work","Medical/Chemical","Outdoor/Nature","Military/Tactical","Sports/Recreation"]},{title:"Evidence Material",options:["Fabric/Cloth","Metal","Paper/Wood","Plastic","Biological","Stone/Glass"]},{title:"Evidence Condition",options:["Broken/Damaged","New/Shiny","Old/Worn","Wet/Dirty","Burnt/Singed","Incomplete"]},{title:"Social Relation",options:["Relatives","Friends","Colleagues","Lovers","Strangers","Enemies"]},{title:"Sudden Incident",options:["Loud Shout","Heavy Thud","Bright Flash","Dead Silence","Scream","Breaking Glass"]},{title:"Motive",options:["Hatred/Revenge","Greed/Money","Love/Passion","Jealousy","Fear/Defense","Madness"]},{title:"Killer's Trait",options:["Arrogant","Cautious","Violent","Calm/Cold","Nervous","Calculating"]},{title:"Impression",options:["Natural","Artistic","Cruel","Clumsy","Professional","Bizarre"]},{title:"Noticed By Others",options:["Sound","Smell","Silhouette","Someone Running","Object Thrown","Nothing"]},{title:"Evidence Size",options:["Tiny","Small","Medium","Large","Heavy","Microscopic"]},{title:"Evidence Color",options:["Red/Purple","Blue/Green","Yellow/Orange","Black/Grey","White/Clear","Metallic"]},{title:"State of Scene",options:["Chaos / Destruction","Signs of Struggle","Perfectly Tidy","Items Missing","Staged / Artificially Arranged","Covered (Ash/Water/Dust)"]},{title:"Injury/Wounds",options:["Head / Neck","Chest / Torso","Hands / Arms","Legs / Feet","Internal Organs","No Visible Wounds"]},{title:"Assassin Hint",options:["Man","Woman","Tall","Short","Strong","Weak"]},{title:"Shape of Evidence",options:["Round/Spherical","Square/Rectangular","Long/Thin","Flat/Sheet","Irregular/Amorphous","Sharp/Pointed"]},{title:"Weapon Operation",options:["Muscle Power","Mechanism/Trigger","Chemical/Reaction","Electrical","Passive/Trap","Animal/Living"]},{title:"Evidence Domain",options:["Work/Office","Home/Domestic","Travel/Outdoor","Leisure/Hobby","Medical/Hygiene","Vice/Illegal"]},{title:"Concealability (Weapon)",options:["Pocket Size","Bag/Backpack Size","Two-Handed/Large","Not Concealable","Invisible/Internal","Disguised as Object"]},{title:"Origin of Evidence",options:["Owned by Victim","Stolen from Victim","Gifted to Victim","Belonged to Killer","Found at Scene","Unknown Origin"]},{title:"Texture of Evidence",options:["Hard/Rigid","Soft/Flexible","Metallic/Cold","Wooden/Rough","Paper-like","Sticky/Liquid"]},{title:"Weapon Residue",options:["Blood","Powder/Dust","Water/Fluid","Ash/Burn Mark","Fragments/Shards","None/Clean"]},{title:"Visibility of Injury",options:["None Visible","Small Puncture","Large Wound","Bruising/Swelling","Burns/Rash","Dismemberment/Breakage"]}]},L=l=>{let p=l.length,h;const N=[...l];for(;p!==0;)h=Math.floor(Math.random()*p),p--,[N[p],N[h]]=[N[h],N[p]];return N},C=l=>{const p=Lt[l]||"â“";return e.jsx("span",{className:"text-2xl leading-none filter drop-shadow-sm grayscale-[0.2] mb-1 block",children:p})},Q=()=>e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,var(--tw-gradient-stops))] from-gray-800 via-gray-900 to-black opacity-80"}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:'url("https://www.transparenttextures.com/patterns/black-scales.png")'}})]}),ee=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 py-2 w-full bg-slate-950/80 backdrop-blur-sm border-t border-slate-900/50 z-50",children:[e.jsx(te,{size:12,className:"text-green-500"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-green-500 uppercase",children:"INVESTIGATION"})]}),Ne=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 py-2 w-full bg-slate-950/80 backdrop-blur-sm border-t border-slate-900/50 z-50",children:[e.jsx(te,{size:22,className:"text-green-500"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-green-500 uppercase",children:"INVESTIGATION"})]}),ve=({onClose:l})=>e.jsx("div",{className:"fixed inset-0 z-170 bg-slate-950/95 flex justify-center overflow-y-auto p-4 animate-in slide-in-from-bottom-10 fade-in duration-300",children:e.jsxs("div",{className:"w-full max-w-4xl relative",children:[e.jsx("button",{onClick:l,className:"fixed top-4 right-4 md:absolute md:-right-12 md:top-0 bg-slate-800 p-2 rounded-full text-white hover:bg-slate-700 shadow-lg z-50",children:e.jsx(we,{size:24})}),e.jsxs("div",{className:"space-y-8 pb-20 mt-12 md:mt-0",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-4xl font-black text-transparent bg-clip-text bg-linear-to-r from-blue-400 to-green-600",children:"PENAL CODES"}),e.jsx("p",{className:"text-slate-400",children:"Deduction, Deception, and Discovery"})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-6 shadow-xl",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(ye,{className:"text-red-500"})," The Objective"]}),e.jsxs("p",{className:"text-slate-300 leading-relaxed",children:["A murder has been committed. The"," ",e.jsx("span",{className:"text-blue-400 font-bold",children:"Detective"})," knows the solution but can only communicate through vague clues. The"," ",e.jsx("span",{className:"text-green-400 font-bold",children:"Investigators"})," must interpret these clues to find the true"," ",e.jsx("strong",{className:"text-white",children:"Murder Weapon"})," and"," ",e.jsx("strong",{className:"text-white",children:"Evidence"})," before time runs out. Meanwhile, the"," ",e.jsx("span",{className:"text-red-400 font-bold",children:"Murderer"})," hides among them, trying to mislead the investigation."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 border border-blue-500/30 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-blue-600 p-1.5 rounded text-white",children:e.jsx(se,{size:16})}),e.jsx("span",{className:"font-bold text-blue-400",children:"Detective"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"Host & Guide. Knows the solution. Cannot speak about the case. Selects tile cards to give hints."})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-red-500/30 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-red-600 p-1.5 rounded text-white",children:e.jsx(ae,{size:16})}),e.jsx("span",{className:"font-bold text-red-400",children:"Murderer"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"The Culprit. Chooses the Means & Clue at the start. Hides identity and tries to sabotage the team."})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-emerald-500/30 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-emerald-600 p-1.5 rounded text-white",children:e.jsx(G,{size:16})}),e.jsx("span",{className:"font-bold text-emerald-400",children:"Investigator"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"The Team. Discusses clues and submits accusations to solve the crime."})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-orange-500/30 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-orange-600 p-1.5 rounded text-white",children:e.jsx(Je,{size:16})}),e.jsx("span",{className:"font-bold text-orange-400",children:"Accomplice"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"(Optional) Knows who the Murderer is. Helps them win without getting caught."})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-indigo-500/30 rounded-xl p-5 md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-indigo-600 p-1.5 rounded text-white",children:e.jsx(Se,{size:16})}),e.jsx("span",{className:"font-bold text-indigo-400",children:"Witness"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"(Optional) Knows the Murderer but not the solution. Must help Investigators without revealing themselves. If the Murderer finds the Witness at the end, the Murderer wins!"})]})]}),e.jsx("div",{className:"text-center pt-8",children:e.jsx("button",{onClick:l,className:"bg-white text-slate-900 px-8 py-3 rounded-full font-bold hover:scale-105 transition-transform",children:"Got it, Let's Play!"})})]})]})}),Ht=({logs:l,onClose:p})=>e.jsx("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-gray-900/95 border border-gray-700 rounded-xl z-155 overflow-y-auto p-2 shadow-2xl",children:e.jsxs("div",{className:"bg-slate-900 w-full md:max-w-md h-full md:h-[70vh] rounded-none md:rounded-xl flex flex-col border-none md:border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center bg-slate-800",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx(Ye,{size:18,className:"text-cyan-400"})," System Logs"]}),e.jsx("button",{onClick:p,className:"p-2 bg-slate-700 rounded-full hover:bg-slate-600",children:e.jsx(we,{className:"text-slate-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...l].reverse().map((h,N)=>e.jsxs("div",{className:`text-xs md:text-sm p-3 rounded border-l-2 ${h.type==="danger"?"bg-red-900/20 border-red-500 text-red-200":h.type==="success"?"bg-green-900/20 border-green-500 text-green-200":"bg-slate-700/50 border-slate-500 text-slate-300"}`,children:[e.jsxs("span",{className:"opacity-50 mr-2 font-mono",children:["[",new Date(parseInt(h.id)||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),"]"]}),h.text]},N))})]})}),Fe=({onConfirm:l,onCancel:p,isHost:h,onReturnToLobby:N})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Leave Game?"}),e.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:h?"As Host, leaving will end the game for everyone.":"Are you sure you want to leave the room?"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:p,className:"bg-slate-700 hover:bg-slate-600 text-white py-3 rounded font-bold transition-colors",children:"Stay"}),h&&N&&e.jsx("button",{onClick:N,className:"bg-blue-600 hover:bg-blue-500 text-white py-3 rounded font-bold transition-colors",children:"Return to Lobby"}),e.jsx("button",{onClick:l,className:"bg-red-600 hover:bg-red-500 text-white py-3 rounded font-bold transition-colors",children:h?"Delete Room":"Leave Room"})]})]})}),$e=({role:l})=>{if(!l)return null;let p="bg-gray-600",h=qe;l==="DETECTIVE"&&(p="bg-blue-600",h=se),l==="MURDERER"&&(p="bg-red-600",h=ae),l==="INVESTIGATOR"&&(p="bg-emerald-600",h=G),l==="ACCOMPLICE"&&(p="bg-orange-600",h=Je),l==="WITNESS"&&(p="bg-indigo-600",h=Se);const N=l.charAt(0)+l.slice(1).toLowerCase();return e.jsxs("div",{className:`${p} text-white px-2 py-1 rounded-full text-xs font-bold flex items-center gap-1 shadow-sm`,children:[Ct.createElement(h,{size:12})," ",e.jsx("span",{className:"whitespace-nowrap",children:N})]})};function Ut(){const[l,p]=d.useState(null),[h,N]=d.useState("menu"),[H,le]=d.useState(""),[b,z]=d.useState(null),[t,re]=d.useState(null),[Ce,K]=d.useState(!1),[ie,W]=d.useState(""),[Ee,Ie]=d.useState(!1),[ke,Te]=d.useState(!1),[Ft,$t]=d.useState(null),[Kt,qt]=d.useState(null),[x,B]=d.useState(null),[Ze,q]=d.useState(!1),[Yt,Jt]=d.useState(!1),[ne,Re]=d.useState(!1),[_,oe]=d.useState(!1),[Ae,V]=d.useState(!1),[Y,Qe]=d.useState(!0),[P,de]=d.useState(null),[Me,ce]=d.useState(!0),[Xt,De]=d.useState(!0),[xe,U]=d.useState(!1),[O,et]=d.useState(()=>localStorage.getItem("gameHub_playerName")||"");d.useEffect(()=>{O&&localStorage.setItem("gameHub_playerName",O)},[O]),d.useEffect(()=>{const s=localStorage.getItem("investigation_roomId");s&&(z(s),le(s))},[]),d.useEffect(()=>((async()=>{if(typeof __initial_auth_token<"u"&&__initial_auth_token)try{await yt(X,__initial_auth_token)}catch{await ze(X)}else await ze(X)})(),vt(X,a=>p(a))),[]),d.useEffect(()=>{t?.phase==="WITNESS_HUNT"?(ce(!0),De(!0)):ce(!1)},[t?.phase]),d.useEffect(()=>{t?.accompliceSuggestion&&De(!0)},[t?.accompliceSuggestion]),d.useEffect(()=>{if(!b||!l)return;const s=g(f,"artifacts",j,"public","data","rooms",b),a=_e(s,r=>{if(r.exists()){const i=r.data();if(!i.players.find(v=>v.id===l.uid)){localStorage.removeItem("investigation_roomId"),z(null),N("menu"),re(null),W("You were removed from the room.");return}re({id:r.id,...i}),i.status==="playing"||i.status==="finished"?N("game"):N("lobby"),i.status==="lobby"&&(q(!1),B(null),oe(!1)),i.status==="playing"&&i.phase==="INVESTIGATION"&&i.players.filter(M=>M.role!=="DETECTIVE"&&M.badge===!0).length===0&&!i.activeAccusation&&i.hostId===l.uid&&tt()}else localStorage.removeItem("investigation_roomId"),z(null),N("menu"),W("Room closed by host.")});return()=>a()},[b,l]),d.useEffect(()=>{const s=_e(g(f,"game_hub_settings","config"),a=>{a.exists()&&a.data()[zt]?.maintenance?Ie(!0):Ie(!1)});return()=>s()},[]);const tt=async s=>{let a=[{text:"All badges used. Murderer Escapes!",type:"danger"}];await y(g(f,"artifacts",j,"public","data","rooms",b),{phase:"GAME_OVER_BAD",logs:T(...a)})},ue=(s,a)=>{de({title:s,message:a,type:"alert"})},st=(s,a,r)=>{de({title:s,message:a,type:"confirm",onConfirm:r})},Oe=()=>de(null),at=async()=>{if(!l||!O.trim())return W("Enter nickname.");K(!0);const s="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let a="";for(let i=0;i<6;i++)a+=s.charAt(Math.floor(Math.random()*s.length));localStorage.setItem("investigation_roomId",a);const r={roomId:a,hostId:l.uid,players:[{id:l.uid,name:O,role:null,means:[],clues:[],badge:!0,ready:!0}],status:"lobby",settings:{useAccomplice:!1,useWitness:!1},logs:[],accusations:[],nextRoundRequests:[],replayRequests:[],readyPlayers:[],activeAccusation:null};try{await wt(g(f,"artifacts",j,"public","data","rooms",a),r),z(a),le(a)}catch{W("Failed to create room.")}K(!1)},lt=async()=>{if(!l||!H||!O.trim())return W("Enter details.");K(!0);try{const s=g(f,"artifacts",j,"public","data","rooms",H.toUpperCase()),a=await St(s);if(!a.exists())throw new Error("Room not found.");const r=a.data();if(r.players.length>=10)throw new Error("Room full.");if(r.status!=="lobby")throw new Error("Game started.");r.players.find(u=>u.id===l.uid)||await y(s,{players:T({id:l.uid,name:O,role:null,means:[],clues:[],badge:!0,ready:!0})}),localStorage.setItem("investigation_roomId",H.toUpperCase()),z(H.toUpperCase())}catch(s){W(s.message)}K(!1)},Ge=async s=>{if(!t||t.hostId!==l.uid)return;const a=t.settings?.[s]||!1;await y(g(f,"artifacts",j,"public","data","rooms",b),{[`settings.${s}`]:!a})},We=async()=>{if(!b||!l||!t)return;localStorage.removeItem("investigation_roomId");const s=g(f,"artifacts",j,"public","data","rooms",b);try{if(t.hostId===l.uid)await Be(s);else{const a=t.players.filter(r=>r.id!==l.uid);a.length===0?await Be(s):await y(s,{players:a})}}catch(a){console.error("Error leaving room:",a)}z(null),N("menu"),re(null),V(!1)},rt=async s=>{if(!t||t.hostId!==l.uid)return;const a=t.players.filter(r=>r.id!==s);await y(g(f,"artifacts",j,"public","data","rooms",b),{players:a})},it=()=>{const s=t.roomId,a=()=>{Te(!0),setTimeout(()=>Te(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",je)};try{navigator.clipboard.writeText(s),a()}catch{const i=document.createElement("textarea");i.value=s,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),a()}},me=async()=>{if(!t||t.hostId!==l.uid)return;const s=t.players.map(a=>({...a,role:null,means:[],clues:[],badge:!0,ready:!0}));await y(g(f,"artifacts",j,"public","data","rooms",b),{status:"lobby",phase:null,solution:null,activeTiles:null,logs:[],players:s,round:1,accusations:[],successfulSolvers:[],accompliceSuggestion:null,murdererGuess:null,nextRoundRequests:[],replayRequests:[],readyPlayers:[],activeAccusation:null})},he=async()=>{if(t.players.length<4)return W("Need 4+ players.");const s=t.players.length;let a=["DETECTIVE","MURDERER"];for(s>=6&&t.settings?.useAccomplice&&a.push("ACCOMPLICE"),s>=5&&t.settings?.useWitness&&a.push("WITNESS");a.length<s;)a.push("INVESTIGATOR");a=L(a);const r=L([...Bt]),i=L([...Vt]),u=t.players.map((E,w)=>{if(a[w]==="DETECTIVE")return{...E,role:a[w],means:[],clues:[],badge:!1};const D=[],n=[];for(let c=0;c<4;c++)D.push(r.pop());for(let c=0;c<4;c++)n.push(i.pop());return{...E,role:a[w],means:D,clues:n,badge:!0}}),v=L([...Z.MAIN])[0],M=L([...Z.SUBORDINATE]).slice(0,4),R=[{...Z.FIXED,id:"cause",selected:null},{...v,id:"main",selected:null},...M.map((E,w)=>({...E,id:`scene_${w}`,selected:null}))];await y(g(f,"artifacts",j,"public","data","rooms",b),{status:"playing",phase:"PRE_GAME_MURDER",players:u,activeTiles:R,solution:null,round:1,logs:T({text:"Game Started. Planning Phase...",type:"neutral"}),accusations:[],nextRoundRequests:[],readyPlayers:[],replayRequests:[],activeAccusation:null})},nt=async()=>{if(t.readyPlayers?.includes(l.uid))return;const s=[...t.readyPlayers||[],l.uid],a=t.players.length===s.length;let r={readyPlayers:s};a&&(r.phase="MURDERER_SELECT",r.logs=T({text:"Everyone Ready. Murderer is choosing...",type:"danger"})),await y(g(f,"artifacts",j,"public","data","rooms",b),r)},ot=async(s,a)=>{await y(g(f,"artifacts",j,"public","data","rooms",b),{solution:{means:s,clue:a,murdererId:l.uid},phase:"DETECTIVE_TURN",logs:T({text:"Crime Committed. Detective is analyzing evidence...",type:"danger"})})},dt=async(s,a)=>{const r=[...t.activeTiles];r[s].selected=a,await y(g(f,"artifacts",j,"public","data","rooms",b),{activeTiles:r})},ct=async()=>{if(!t.activeTiles.every(a=>a.selected!==null))return ue("Incomplete","Select an option for every tile!");await y(g(f,"artifacts",j,"public","data","rooms",b),{phase:"INVESTIGATION",logs:T({text:`Round ${t.round} Clues Revealed! Investigators, submit your files when ready.`,type:"info"}),nextRoundRequests:[]})},xt=async()=>{t.nextRoundRequests?.includes(l.uid)||await y(g(f,"artifacts",j,"public","data","rooms",b),{nextRoundRequests:T(l.uid)})},ut=async s=>{if(s<2)return ue("Invalid Action","You cannot replace the Cause of Death or Main Location tile.");if(t.round>=3)return;const a=t.activeTiles.map(v=>v.title),r=Z.SUBORDINATE.filter(v=>!a.includes(v.title)),i=L(r)[0],u=[...t.activeTiles];u[s]={...i,id:`scene_r${t.round+1}_${s}`,selected:null},await y(g(f,"artifacts",j,"public","data","rooms",b),{phase:"DETECTIVE_TURN",round:t.round+1,activeTiles:u,logs:T({text:`Round ${t.round+1} Begins. Detective is updating a clue...`,type:"neutral"})}),oe(!1)},mt=async()=>{if(!x)return;const{targetId:s,means:a,clue:r}=x,i=t.players.findIndex(w=>w.id===l.uid),u=[...t.players];u[i].badge=!1;const v=t.solution,M=s===v.murdererId&&a===v.means&&r===v.clue,R={solverId:l.uid,solverName:u[i].name,targetId:s,means:a,clue:r,isCorrect:M,continueVotes:[]},E=t.nextRoundRequests||[];E.includes(l.uid)||E.push(l.uid),await y(g(f,"artifacts",j,"public","data","rooms",b),{players:u,accusations:T(R),activeAccusation:R,nextRoundRequests:E,logs:T({text:`${u[i].name} submitted a case file.`,type:"neutral"})}),q(!1),B(null)},ht=async()=>{if(!t.activeAccusation)return;const s=t.activeAccusation.continueVotes||[];if(s.includes(l.uid))return;const a=[...s,l.uid],r=t.players.length===a.length;let i={"activeAccusation.continueVotes":a};r&&(i.activeAccusation=null,t.activeAccusation.isCorrect?t.settings?.useWitness?(i.phase="WITNESS_HUNT",i.successfulSolvers=[t.activeAccusation.solverId],i.logs=T({text:"CORRECT! But Murderer can steal win by finding Witness.",type:"warning"})):(i.phase="GAME_OVER_GOOD",i.successfulSolvers=[t.activeAccusation.solverId],i.logs=T({text:"CORRECT! Investigators Win!",type:"success"})):i.logs=T({text:`${t.activeAccusation.solverName} was WRONG. Game Continues.`,type:"danger"})),await y(g(f,"artifacts",j,"public","data","rooms",b),i)},bt=async s=>{await y(g(f,"artifacts",j,"public","data","rooms",b),{accompliceSuggestion:s})},pt=async s=>{const a=t.players.find(u=>u.id===s);let r="GAME_OVER_GOOD",i=[];a.role==="WITNESS"?(r="GAME_OVER_BAD",i.push({text:`Murderer identified the Witness (${a.name})! Murderer Wins!`,type:"danger"})):(r="GAME_OVER_GOOD",i.push({text:"Murderer guessed wrong! Investigators Win!",type:"success"})),await y(g(f,"artifacts",j,"public","data","rooms",b),{phase:r,logs:T(...i)})};if(Ee)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(Ne,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(Pe,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"Crime scene sealed. Forensics team is sweeping the area."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"https://rawfidkshuvo.github.io/gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(J,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(J,{size:16})]})})})}),e.jsx(ee,{})]});if(Ee)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(Ne,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(Pe,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"Crime scene sealed. Forensics team is sweeping the area."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(J,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(J,{size:16})]})})})}),e.jsx(ee,{})]});if(!l)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-green-500 animate-pulse",children:"Unfolding clues..."});if(b&&!t&&!ie)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(Q,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(It,{size:48,className:"text-green-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(h==="menu")return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(Q,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-green-800 rounded-lg 
			font-bold shadow-md hover:text-green-400 transition-colors w-fit animate-pulse`,children:[e.jsx(kt,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),xe&&e.jsx(ve,{onClose:()=>U(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(te,{size:64,className:"text-green-500 mx-auto mb-4 animate-bounce drop-shadow-[0_0_15px_rgba(34,197,94,0.5)]"}),e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-6xl font-black text-transparent bg-clip-text bg-linear-to-b from-green-300 to-green-600 font-serif tracking-widest drop-shadow-md wrap-break-word max-w-full",children:"INVESTIGATION"}),e.jsx("p",{className:"text-gray-400 tracking-[0.3em] uppercase mt-2",children:"Murder Mystery"})]}),e.jsxs("div",{className:"bg-gray-900/80 backdrop-blur border border-gray-700 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10 animate-in slide-in-from-bottom-10 duration-700 delay-100",children:[ie&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-2 mb-4 rounded text-center text-sm border border-red-800",children:ie}),e.jsx("input",{className:"w-full bg-black/50 border border-gray-600 p-3 rounded mb-4 text-white placeholder-gray-500 focus:border-green-500 outline-none transition-colors",placeholder:"Your Codename",value:O,onChange:s=>et(s.target.value)}),e.jsxs("button",{onClick:at,disabled:Ce,className:"w-full bg-linear-to-r from-green-700 to-green-600 hover:from-green-600 hover:to-green-500 p-4 rounded font-bold mb-4 flex items-center justify-center gap-2 border border-green-500/30 shadow-[0_0_15px_rgba(34,197,94,0.2)] transition-all",children:[e.jsx(G,{size:20})," Create Case File"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx("input",{className:"w-full sm:flex-1 bg-black/50 border border-gray-600 p-3 rounded text-white placeholder-gray-500 uppercase font-mono tracking-wider focus:border-green-500 outline-none",placeholder:"ROOM CODE",value:H,onChange:s=>le(s.target.value.toUpperCase())}),e.jsx("button",{onClick:lt,disabled:Ce,className:"w-full sm:w-auto bg-gray-800 hover:bg-gray-700 border border-gray-600 px-6 py-3 rounded font-bold transition-colors",children:"Join"})]}),e.jsxs("button",{onClick:()=>U(!0),className:"w-full text-sm text-gray-400 hover:text-white flex items-center justify-center gap-2 py-2",children:[e.jsx(Ve,{size:16})," Penal Codes"]})]}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Deception: Murder in Hongkong. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),". Visit"," ",e.jsx("a",{href:"/rawfids-gamehub/",rel:"noopener noreferrer",className:"text-emerald-500 underline hover:text-emerald-600",children:"GAMEHUB"})," ","for more games."]})]});if(h==="lobby"&&t){const s=t.hostId===l.uid,a=t.players.length;return e.jsxs("div",{className:"min-h-screen bg-gray-950 text-white flex flex-col items-center justify-center p-6 relative pb-16",children:[e.jsx(Q,{}),e.jsx(Ne,{}),xe&&e.jsx(ve,{onClose:()=>U(!1)}),Ae&&e.jsx(Fe,{onCancel:()=>V(!1),onConfirm:We,isHost:s}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-gray-800/90 p-8 rounded-2xl border border-gray-700 shadow-2xl mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-green-500 font-bold uppercase",children:"Case File"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:t.roomId}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:it,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:ke?e.jsx(je,{size:16,className:"text-green-500"}):e.jsx(Tt,{size:16})}),ke&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-green-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(qe,{size:16})," ",a,"/10"]}),e.jsx("button",{onClick:()=>V(!0),className:"p-2 bg-red-900/50 hover:bg-red-900 rounded text-red-300",title:"Leave Room",children:e.jsx(Le,{size:16})})]})]}),e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700 flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300 font-bold",children:[e.jsx(At,{size:18})," Settings"]}),e.jsxs("div",{className:"flex gap-4",children:[a>=6&&e.jsxs("label",{className:`flex items-center gap-2 cursor-pointer ${!s&&"opacity-50 pointer-events-none"}`,children:[e.jsx("input",{type:"checkbox",checked:t.settings?.useAccomplice||!1,onChange:()=>Ge("useAccomplice"),className:"w-4 h-4 accent-green-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Accomp."})]}),a>=5&&e.jsxs("label",{className:`flex items-center gap-2 cursor-pointer ${!s&&"opacity-50 pointer-events-none"}`,children:[e.jsx("input",{type:"checkbox",checked:t.settings?.useWitness||!1,onChange:()=>Ge("useWitness"),className:"w-4 h-4 accent-green-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Witness"})]}),a<5&&e.jsx("span",{className:"text-xs text-gray-500",children:"Need 5+ players for extra roles"})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[t.players.map(r=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-4 rounded border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("span",{className:`font-bold ${r.id===l.uid?"text-green-500":"text-gray-300"}`,children:[r.name," ",r.id===t.hostId&&"ðŸ‘‘"]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-green-600 flex items-center gap-1 text-sm",children:[e.jsx(je,{size:14})," Ready"]}),s&&r.id!==l.uid&&e.jsx("button",{onClick:()=>rt(r.id),className:"text-red-900 hover:text-red-500 transition-colors",children:e.jsx(Mt,{size:16})})]})]},r.id)),t.players.length<4&&e.jsx("div",{className:"text-center text-gray-500 animate-pulse italic",children:"Waiting for more investigators..."})]}),s?e.jsx("button",{onClick:he,disabled:t.players.length<4,className:`w-full py-4 rounded-xl font-bold text-lg shadow-lg transition-all ${t.players.length<4?"bg-gray-700 cursor-not-allowed text-gray-500":"bg-green-700 hover:bg-green-600 text-white shadow-green-900/30"}`,children:"Start Investigation"}):e.jsx("div",{className:"text-center text-green-500/80 font-serif mb-2",children:"Waiting for Host to start..."})]}),e.jsx("div",{className:"fixed bottom-0 left-0 w-full",children:e.jsx(ee,{})})]})}if(h==="game"&&t){const s=t.players.find(n=>n.id===l.uid);if(!s)return e.jsx("div",{onClick:()=>window.location.reload(),className:"p-10 text-white cursor-pointer",children:"You were removed. Click to reload."});let a={};if(a[s.id]=s.role,s.role==="DETECTIVE"&&t.players.forEach(n=>a[n.id]=n.role),s.role==="MURDERER"){const n=t.players.find(c=>c.role==="ACCOMPLICE");n&&(a[n.id]="ACCOMPLICE")}if(s.role==="ACCOMPLICE"){const n=t.players.find(c=>c.role==="MURDERER");n&&(a[n.id]="MURDERER")}s.role==="WITNESS"&&t.players.forEach(n=>{n.role==="MURDERER"&&(a[n.id]="MURDERER")});const r=s.role==="DETECTIVE",i=s.role==="MURDERER",u=s.role==="ACCOMPLICE",v=t.accusations?.find(n=>n.solverId===l.uid),M=(n,c,o)=>{const I=t.phase==="INVESTIGATION";r||!s.badge||!I||B(S=>{if(S?.targetId!==n)return{targetId:n,[c]:o,[c==="means"?"clue":"means"]:null};const k={...S};return k[c]===o?k[c]=null:k[c]=o,k})};let R="INVESTIGATION",E=te,w="text-green-500",D=null;if(t.phase==="PRE_GAME_MURDER"?(R="PRE-GAME",E=Se,w="text-blue-400"):t.phase==="MURDERER_SELECT"?i||u?(R="MURDER PHASE",E=ae,w="text-red-500"):r?(R="DETECTIVE",E=se,w="text-blue-500"):(R="NIGHT PHASE",E=He,w="text-slate-500"):t.phase.includes("GAME_OVER")&&(R="CASE CLOSED",E=G,w="text-yellow-500"),t.phase==="PRE_GAME_MURDER"){const n=t.readyPlayers?.includes(l.uid);D=e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-800/50 p-2 flex justify-between items-center border-b border-slate-700",children:[e.jsx("span",{className:"text-xs text-slate-400 font-bold uppercase",children:"Review Roles & Cards"}),e.jsx("button",{onClick:nt,disabled:n,className:`px-4 py-1.5 rounded-full font-bold text-sm transition-all ${n?"bg-green-600 text-white cursor-default":"bg-blue-600 hover:bg-blue-500 text-white shadow-lg animate-pulse"}`,children:n?"Waiting...":"Ready"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 max-w-7xl mx-auto pb-20",children:t.players.map(c=>{const o=c.id===l.uid,I=a[c.id]||c.role==="DETECTIVE";return e.jsxs("div",{className:`relative bg-slate-900 border rounded-xl overflow-hidden shadow-lg ${o?"border-blue-500/50":"border-slate-800"}`,children:[e.jsx("div",{className:"p-2 bg-slate-800/80 flex justify-between items-center border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`font-bold text-sm ${o?"text-blue-400":"text-slate-200"}`,children:c.name}),I&&e.jsx($e,{role:c.role})]})}),e.jsxs("div",{className:"p-2 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] uppercase font-bold text-red-900 mb-1",children:"Murder Weapon"}),c.means.map(S=>e.jsxs("div",{className:"p-1.5 rounded bg-slate-800 border border-red-900/30 flex flex-col items-center justify-center text-center gap-1 min-h-[50px] shadow-sm",children:[C(S),e.jsx("span",{className:"text-[9px] font-bold text-red-200 leading-tight line-clamp-2",children:S})]},S))]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] uppercase font-bold text-blue-900 mb-1",children:"Evidence on Site"}),c.clues.map(S=>e.jsxs("div",{className:"p-1.5 rounded bg-slate-800 border border-blue-900/30 flex flex-col items-center justify-center text-center gap-1 min-h-[50px] shadow-sm",children:[C(S),e.jsx("span",{className:"text-[9px] font-bold text-blue-200 leading-tight line-clamp-2",children:S})]},S))]})]})]},c.id)})})})]})}else if(t.phase==="MURDERER_SELECT")i||u?D=e.jsxs("div",{className:"flex-1 flex flex-col items-center pt-8 px-4 overflow-y-auto",children:[e.jsx("h1",{className:"text-3xl font-black text-red-500 mb-2",children:"COMMIT THE CRIME"}),e.jsx("p",{className:"text-red-200 mb-6 max-w-md text-center",children:i?"Select 1 Murder Weapon and 1 Evidence.":"Helping Murderer select..."}),i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-4xl pb-32",children:[e.jsxs("div",{className:"bg-red-900/30 p-4 rounded-xl border border-red-800",children:[e.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2 text-sm",children:[e.jsx(Dt,{size:16})," WEAPON"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.means.map(n=>e.jsxs("button",{onClick:()=>B({...x,means:n}),className:`p-2 rounded-lg border flex flex-col items-center justify-center gap-1 min-h-[80px] ${x?.means===n?"bg-red-600 border-white text-white":"bg-red-900/50 border-red-700 text-red-200"}`,children:[C(n),e.jsx("span",{className:"text-xs font-bold leading-tight",children:n})]},n))})]}),e.jsxs("div",{className:"bg-blue-900/30 p-4 rounded-xl border border-blue-800",children:[e.jsxs("h3",{className:"text-blue-400 font-bold mb-2 flex items-center gap-2 text-sm",children:[e.jsx(se,{size:16})," EVIDENCE"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.clues.map(n=>e.jsxs("button",{onClick:()=>B({...x,clue:n}),className:`p-2 rounded-lg border flex flex-col items-center justify-center gap-1 min-h-[80px] ${x?.clue===n?"bg-blue-600 border-white text-white":"bg-blue-900/50 border-blue-700 text-blue-200"}`,children:[C(n),e.jsx("span",{className:"text-xs font-bold leading-tight",children:n})]},n))})]})]}),i&&e.jsx("div",{className:"fixed bottom-12 left-0 w-full p-4 flex justify-center z-40 pointer-events-none",children:e.jsx("button",{disabled:!x?.means||!x?.clue,onClick:()=>ot(x.means,x.clue),className:"w-full max-w-md bg-white text-red-900 px-8 py-3 rounded-full font-black text-lg hover:scale-105 disabled:opacity-50 pointer-events-auto shadow-2xl",children:"CONFIRM KILL"})})]}):r?D=e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-blue-400 mb-4",children:"Awaiting The Crime..."}),e.jsxs("div",{className:"animate-pulse bg-slate-800 p-6 rounded-xl max-w-lg",children:[e.jsx("p",{className:"text-slate-300",children:"The Murderer is choosing the Weapon and Evidence."}),e.jsx("p",{className:"text-slate-500 text-sm mt-4",children:"Study the cards while you wait."})]})]}):D=e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8",children:[e.jsx(He,{size:64,className:"text-slate-700 mb-6 mx-auto"}),e.jsx("h2",{className:"text-4xl font-black text-slate-500 mb-4",children:"EYES CLOSED"}),e.jsx("p",{className:"text-slate-600",children:"The Murder is taking place..."})]});else{const n=r&&t.phase==="DETECTIVE_TURN",c=t.players.filter(o=>o.role!=="DETECTIVE").every(o=>{const I=t.nextRoundRequests?.includes(o.id),S=t.accusations?.some(k=>k.solverId===o.id);return I||S});D=e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsx("div",{className:"bg-slate-800/80 p-2 flex justify-center md:hidden border-b border-slate-700 shrink-0",children:e.jsxs("button",{onClick:()=>Qe(!Y),className:"text-xs font-bold text-slate-400 flex items-center gap-1",children:[Y?"Hide Clues":"Show Clues"," ",Y?e.jsx(Ue,{size:12}):e.jsx(Rt,{size:12})]})}),Y&&e.jsx("div",{className:"bg-slate-900/50 p-2 overflow-x-auto border-b border-slate-800 shrink-0",children:e.jsx("div",{className:"flex gap-2 min-w-max mx-auto px-2",children:t.activeTiles.map((o,I)=>e.jsxs("div",{onClick:()=>{_&&r&&I>=2&&ut(I)},className:`w-40 bg-slate-800 rounded-lg border-2 flex flex-col relative shadow-lg transition-all ${_&&I>=2&&r?"border-red-500 cursor-pointer hover:bg-red-900/20 scale-105":r&&n&&"hover:border-blue-500/50"} ${o.selected===null?"border-slate-700":"border-slate-600"} ${_&&I<2&&"opacity-50"}`,children:[_&&I>=2&&r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10 text-red-500 font-bold",children:e.jsx(we,{size:32})}),e.jsx("div",{className:`p-1.5 text-center font-bold text-[10px] uppercase tracking-wider text-white truncate ${o.type==="purple"?"bg-purple-900":o.type==="green"?"bg-emerald-900":"bg-slate-700"}`,children:o.title}),e.jsx("div",{className:"p-1.5 space-y-0.5",children:o.options.map((S,k)=>{const F=o.selected===k;return e.jsxs("div",{onClick:$=>{$.stopPropagation(),r&&n&&dt(I,k)},className:`text-[10px] px-1.5 py-1 rounded cursor-pointer flex justify-between items-center transition-colors ${F?"bg-red-600 text-white font-bold shadow-md ring-1 ring-red-400":r&&n?"hover:bg-slate-700 text-slate-300":"text-slate-500 opacity-50"}`,children:[e.jsx("span",{className:"truncate",children:S}),F&&e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full ml-1 shrink-0"})]},k)})})]},o.id))})}),e.jsxs("div",{className:"bg-slate-900 relative z-30 shadow-xl p-2 flex justify-between items-center border-b border-slate-800 shrink-0",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold block",children:"Round"}),e.jsxs("span",{className:"text-sm font-bold text-white",children:[t.round,"/3"]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&n&&e.jsx("button",{onClick:ct,className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded text-xs font-bold shadow-lg animate-pulse",children:"Confirm"}),t.phase==="INVESTIGATION"&&r&&t.round<3&&e.jsxs("button",{disabled:!c,onClick:()=>oe(!_),className:`${_?"bg-red-500 animate-pulse":c?"bg-blue-600":"bg-slate-700 opacity-50 cursor-not-allowed"} hover:brightness-110 text-white px-3 py-1.5 rounded text-xs font-bold shadow-lg transition-colors flex items-center gap-1`,children:[_?"Select Tile":"Next Rnd",!c&&e.jsxs("span",{className:"text-[10px] bg-black/30 px-1 rounded",children:[t.nextRoundRequests?.length||0,"/",t.players.length-1]})]}),t.phase==="INVESTIGATION"&&!r&&!v&&!t.nextRoundRequests?.includes(l.uid)&&t.round<3&&e.jsx("button",{onClick:xt,className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded text-xs font-bold shadow-lg",children:"Request Clue Change"}),t.phase==="INVESTIGATION"&&!r&&t.nextRoundRequests?.includes(l.uid)&&e.jsx("div",{className:"text-[10px] text-green-400 font-bold bg-green-900/30 px-2 py-1 rounded border border-green-800",children:"Ready"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-transparent relative z-10",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 max-w-7xl mx-auto pb-32",children:t.players.map(o=>{const I=o.id===l.uid,S=a[o.id]||o.role==="DETECTIVE"||t.phase.includes("GAME_OVER"),k=x?.targetId===o.id,F=t.accompliceSuggestion===o.id,$=v?.targetId===o.id,A=t.accusations?.find(m=>m.solverId===o.id),gt=t.phase==="WITNESS_HUNT"&&!Me&&(u||i)&&o.role!=="DETECTIVE"&&o.role!=="MURDERER"&&o.role!=="ACCOMPLICE";return e.jsxs("div",{onClick:()=>{t.phase==="INVESTIGATION"&&!r&&s.badge&&B({targetId:o.id,means:null,clue:null})},className:`relative bg-slate-900 border rounded-xl overflow-hidden shadow-lg transition-all ${I?"border-blue-500/30 ring-1 ring-blue-900/50":"border-slate-800"} ${t.phase==="WITNESS_HUNT"&&F&&i?"ring-4 ring-yellow-500 scale-105":""} ${$?"border-yellow-500/50 ring-1 ring-yellow-500/30":""}`,children:[e.jsxs("div",{className:"p-2 bg-slate-800/80 flex justify-between items-center border-b border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`font-bold text-sm ${I?"text-blue-400":"text-slate-200"}`,children:o.name}),S&&e.jsx($e,{role:o.role})]}),o.badge&&o.role!=="DETECTIVE"&&e.jsx(G,{size:14,className:"text-yellow-500",fill:"currentColor"}),!o.badge&&o.role!=="DETECTIVE"&&e.jsx("div",{className:"text-[10px] text-slate-600 font-bold uppercase",children:"Submitted"})]}),e.jsxs("div",{className:"p-2 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] uppercase font-bold text-red-900 mb-1",children:"Weapon"}),o.means.map(m=>{const be=k&&x.means===m,pe=$&&v.means===m,ge=(r||u||i)&&t.solution?.means===m&&t.solution?.murdererId===o.id;return e.jsxs("div",{onClick:fe=>{fe.stopPropagation(),o.id!==l.uid&&M(o.id,"means",m)},className:`p-1.5 rounded-md border flex flex-col items-center justify-center text-center cursor-pointer transition-all active:scale-95 touch-manipulation min-h-[60px] shadow-sm ${be?"bg-red-600 text-white font-bold shadow-md scale-105 border border-white":pe?"bg-red-900/40 text-red-200 border border-yellow-500/50 shadow-inner":ge?"bg-purple-900/80 text-white border-2 border-purple-400 animate-pulse":"bg-slate-800 text-red-200 border border-red-900/30 hover:bg-red-900/20 hover:border-red-500"} ${o.id===l.uid&&"opacity-50 cursor-not-allowed"}`,children:[C(m),e.jsx("span",{className:"text-[10px] font-bold leading-tight line-clamp-2 w-full",children:m})]},m)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] uppercase font-bold text-blue-900 mb-1",children:"Evidence"}),o.clues.map(m=>{const be=k&&x.clue===m,pe=$&&v.clue===m,ge=(r||u||i)&&t.solution?.clue===m&&t.solution?.murdererId===o.id;return e.jsxs("div",{onClick:fe=>{fe.stopPropagation(),o.id!==l.uid&&M(o.id,"clue",m)},className:`p-1.5 rounded-md border flex flex-col items-center justify-center text-center cursor-pointer transition-all active:scale-95 touch-manipulation min-h-[60px] shadow-sm ${be?"bg-blue-600 text-white font-bold shadow-md scale-105 border border-white":pe?"bg-blue-900/40 text-blue-200 border border-yellow-500/50 shadow-inner":ge?"bg-purple-900/80 text-white border-2 border-purple-400 animate-pulse":"bg-slate-800 text-blue-200 border border-blue-900/30 hover:bg-blue-900/20 hover:border-blue-500"} ${o.id===l.uid&&"opacity-50 cursor-not-allowed"}`,children:[C(m),e.jsx("span",{className:"text-[10px] font-bold leading-tight line-clamp-2 w-full",children:m})]},m)})]})]}),t.phase==="WITNESS_HUNT"&&F&&(u||i)&&e.jsx("div",{className:"absolute inset-0 bg-yellow-500/30 pointer-events-none flex items-center justify-center z-20",children:e.jsx("div",{className:`bg-yellow-500 text-black px-3 py-1.5 rounded-lg font-black text-xs shadow-xl border-2 border-black transform -rotate-6 ${i?"animate-pulse scale-110":""}`,children:u?"YOU SUGGESTED":"ACCOMPLICE'S PICK"})}),A&&e.jsxs("div",{className:`mx-2 mb-2 border-2 rounded-lg p-2 text-center relative overflow-hidden ${(t.phase==="WITNESS_HUNT"||t.phase.includes("GAME_OVER_GOOD"))&&A.isCorrect?"border-green-500 bg-green-950/40":"border-red-500 bg-red-950/40"}`,children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-1 ${(t.phase==="WITNESS_HUNT"||t.phase.includes("GAME_OVER_GOOD"))&&A.isCorrect?"bg-green-500":"bg-red-500"}`}),e.jsx("div",{className:`text-[10px] font-black uppercase tracking-widest mb-1 ${(t.phase==="WITNESS_HUNT"||t.phase.includes("GAME_OVER_GOOD"))&&A.isCorrect?"text-green-400":"text-red-400"}`,children:(t.phase==="WITNESS_HUNT"||t.phase.includes("GAME_OVER_GOOD"))&&A.isCorrect?"SUCCESSFUL":"FAILED"}),e.jsxs("div",{className:"text-xs text-slate-200 mb-1",children:["Suspected:"," ",e.jsx("span",{className:"font-bold text-white text-sm",children:t.players.find(m=>m.id===A.targetId)?.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:"border rounded px-1 py-0.5 text-[10px] truncate flex items-center justify-center gap-1 bg-black/40 border-slate-600",children:[C(A.means),A.means]}),e.jsxs("div",{className:"border rounded px-1 py-0.5 text-[10px] truncate flex items-center justify-center gap-1 bg-black/40 border-slate-600",children:[C(A.clue),A.clue]})]})]}),gt&&e.jsxs("div",{className:"p-2 pt-0 mt-auto sticky bottom-0 bg-slate-900/95 backdrop-blur-sm border-t border-slate-700 -mx-px -mb-px rounded-b-xl z-30",children:[u&&e.jsxs("button",{onClick:m=>{m.stopPropagation(),bt(o.id)},className:"w-full bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-2 px-4 rounded-lg text-xs flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(ye,{size:14})," Suggest"]}),i&&e.jsxs("button",{onClick:m=>{if(m.stopPropagation(),t.settings?.useAccomplice&&!t.accompliceSuggestion){ue("Wait!","Wait for Accomplice!");return}st("Eliminate Witness?",`End game by guessing ${o.name}?`,()=>pt(o.id))},className:"w-full bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-4 rounded-lg text-xs flex items-center justify-center gap-2 shadow-lg animate-pulse",children:[e.jsx(Ot,{size:14})," ELIMINATE"]})]}),k&&(x.means||x.clue)&&t.phase==="INVESTIGATION"&&e.jsx("div",{className:"p-2 pt-0 mt-auto sticky bottom-0 bg-slate-900/95 backdrop-blur-sm border-t border-slate-700 -mx-px -mb-px rounded-b-xl z-10",children:e.jsxs("button",{onClick:m=>{m.stopPropagation(),q(!0)},className:"w-full bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-2 px-4 rounded-lg text-xs flex items-center justify-center gap-2 shadow-lg animate-in slide-in-from-bottom-2 fade-in transition-transform active:scale-95",children:[e.jsx(G,{size:14})," Review"]})})]},o.id)})})})]})}return e.jsxs("div",{className:"min-h-screen bg-slate-950 text-slate-100 font-sans flex flex-col relative overflow-hidden pb-12",children:[e.jsx(Q,{}),xe&&e.jsx(ve,{onClose:()=>U(!1)}),Ae&&e.jsx(Fe,{onConfirm:We,onCancel:()=>V(!1),isHost:t.hostId===l.uid,onReturnToLobby:()=>{me(),V(!1)}}),ne&&e.jsx(Ht,{logs:t.logs,onClose:()=>Re(!1)}),Ze&&x&&e.jsx("div",{className:"fixed inset-0 top-14 bg-black/90 z-150 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-lg p-6 shadow-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-2xl font-black text-yellow-500 mb-4 flex items-center gap-2",children:[e.jsx(G,{})," SUBMIT CASE FILE"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase",children:"Suspect"}),e.jsx("div",{className:"text-xl font-bold text-white",children:t.players.find(n=>n.id===x.targetId)?.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase mb-1",children:"Murder Weapon"}),x.means?e.jsxs("div",{className:"p-3 bg-red-900/50 border border-red-600 rounded text-red-100 font-bold text-center text-sm flex items-center justify-center gap-2",children:[C(x.means),x.means]}):e.jsx("div",{className:"p-3 bg-slate-800 border border-slate-700 border-dashed rounded text-slate-500 text-center text-xs",children:"Select Weapon"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase mb-1",children:"Evidence"}),x.clue?e.jsxs("div",{className:"p-3 bg-blue-900/50 border border-blue-600 rounded text-blue-100 font-bold text-center text-sm flex items-center justify-center gap-2",children:[C(x.clue),x.clue]}):e.jsx("div",{className:"p-3 bg-slate-800 border border-slate-700 border-dashed rounded text-slate-500 text-center text-xs",children:"Select Evidence"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>q(!1),className:"py-3 rounded-lg font-bold text-slate-400 hover:bg-slate-800",children:"Cancel"}),e.jsx("button",{disabled:!x.means||!x.clue,onClick:mt,className:"bg-yellow-600 hover:bg-yellow-500 text-black py-3 rounded-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"CONFIRM"})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 top-14 bg-black/90 z-150 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:P.title}),e.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:P.message}),e.jsxs("div",{className:`grid ${P.type==="confirm"?"grid-cols-2":"grid-cols-1"} gap-3`,children:[P.type==="confirm"&&e.jsx("button",{onClick:Oe,className:"bg-slate-700 hover:bg-slate-600 text-white py-3 rounded font-bold",children:"Cancel"}),e.jsx("button",{onClick:()=>{P.onConfirm&&P.onConfirm(),Oe()},className:"bg-blue-600 hover:bg-blue-500 text-white py-3 rounded font-bold",children:"OK"})]})]})}),t.activeAccusation&&e.jsx("div",{className:"fixed inset-0 top-14 bg-black/95 z-150 flex items-center justify-center p-4",children:e.jsxs("div",{className:`max-w-lg w-full p-6 rounded-2xl border-4 shadow-2xl text-center ${t.activeAccusation.isCorrect?"bg-green-900/90 border-green-500":"bg-red-900/90 border-red-500"}`,children:[e.jsx("h2",{className:"text-3xl font-black text-white mb-2 uppercase tracking-widest",children:t.activeAccusation.isCorrect?"CASE SOLVED!":"WRONG ACCUSATION"}),e.jsxs("div",{className:"bg-black/30 p-4 rounded-xl mb-6 text-left",children:[e.jsxs("div",{className:"grid grid-cols-[80px_1fr] gap-2 items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"Accuser:"}),e.jsx("span",{className:"text-white font-bold",children:t.activeAccusation.solverName})]}),e.jsxs("div",{className:"grid grid-cols-[80px_1fr] gap-2 items-center mb-4",children:[e.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"Suspect:"}),e.jsx("span",{className:"text-xl text-white font-black",children:t.players.find(n=>n.id===t.activeAccusation.targetId)?.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-red-900/30 border border-red-500/30 p-2 rounded text-center",children:[e.jsx("div",{className:"text-[10px] text-red-300 uppercase font-bold mb-1",children:"Weapon"}),e.jsxs("div",{className:"text-white font-bold text-sm flex items-center justify-center gap-1",children:[C(t.activeAccusation.means),t.activeAccusation.means]})]}),e.jsxs("div",{className:"bg-blue-900/30 border border-blue-500/30 p-2 rounded text-center",children:[e.jsx("div",{className:"text-[10px] text-blue-300 uppercase font-bold mb-1",children:"Evidence"}),e.jsxs("div",{className:"text-white font-bold text-sm flex items-center justify-center gap-1",children:[C(t.activeAccusation.clue),t.activeAccusation.clue]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"text-xs uppercase font-bold text-white/50",children:["Waiting for players:"," ",t.activeAccusation.continueVotes?.length||0,"/",t.players.length]}),e.jsxs("button",{onClick:ht,disabled:t.activeAccusation.continueVotes?.includes(l.uid),className:`px-8 py-3 rounded-full font-bold text-lg transition-all flex items-center gap-2 ${t.activeAccusation.continueVotes?.includes(l.uid)?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-white text-black hover:scale-105 shadow-xl"}`,children:[t.activeAccusation.continueVotes?.includes(l.uid)?"WAITING...":"CONTINUE"," ",e.jsx(Ue,{className:"rotate-90"})]})]})]})}),t.phase==="WITNESS_HUNT"&&Me&&e.jsx("div",{className:"fixed inset-0 top-14 z-150 flex flex-col items-center justify-center p-4 bg-black/80",children:i||u?e.jsxs("div",{className:"bg-red-950 border-2 border-red-500 p-6 rounded-xl shadow-2xl text-center max-w-lg animate-in fade-in zoom-in duration-300",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-black text-red-500 mb-2",children:"YOU HAVE BEEN CAUGHT!"}),e.jsx("p",{className:"text-red-100 text-base md:text-lg mb-4",children:u?"Help the Murderer find the Witness.":"Identify the Witness to steal the win."}),i&&t.settings?.useAccomplice&&(t.accompliceSuggestion?e.jsxs("div",{className:"bg-green-900/40 p-3 rounded border border-green-500 mb-4 animate-bounce",children:[e.jsxs("div",{className:"font-bold text-green-400 text-sm mb-1 uppercase",children:[e.jsx(ye,{size:14,className:"inline mr-1"})," Target Confirmed"]}),"Accomplice suggests:"," ",e.jsx("span",{className:"text-white font-black text-lg block mt-1",children:t.players.find(n=>n.id===t.accompliceSuggestion)?.name})]}):e.jsxs("div",{className:"bg-black/40 p-3 rounded border border-red-500/50 mb-4 animate-pulse",children:[e.jsxs("div",{className:"font-bold text-yellow-400 text-sm mb-1 uppercase",children:[e.jsx(Gt,{size:14,className:"inline mr-1"})," Hold Fire"]}),"Waiting for Accomplice suggestion..."]})),e.jsx("button",{onClick:()=>ce(!1),className:"mt-4 bg-white text-red-900 px-8 py-3 rounded-full font-black uppercase text-sm hover:scale-105 transition-transform shadow-xl",children:"Select Witness"})]}):e.jsxs("div",{className:"bg-slate-900/95 border-2 border-yellow-500 p-6 rounded-xl shadow-2xl text-center max-w-lg animate-in fade-in zoom-in duration-300",children:[e.jsx("h2",{className:"text-3xl font-black text-yellow-500 mb-2",children:"CRIME SOLVED!"}),e.jsx("p",{className:"text-slate-200 text-lg mb-4",children:"The Investigators found the solution. However..."}),e.jsx("div",{className:"text-xl font-bold text-red-400 mb-4 animate-pulse",children:"THE MURDERER IS HUNTING FOR THE WITNESS"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"If the Murderer identifies the Witness correctly, the Bad Guys steal the win."})]})}),t.phase==="GAME_OVER_GOOD"&&e.jsxs("div",{className:"fixed inset-0 top-14 bg-blue-900/95 z-150 flex flex-col items-center justify-center p-6 text-center overflow-y-auto",children:[e.jsx(G,{size:96,className:"text-yellow-400 mb-6 shadow-xl shrink-0"}),e.jsx("h1",{className:"text-4xl md:text-6xl font-black text-white mb-4",children:"INVESTIGATORS WIN"}),e.jsxs("p",{className:"text-blue-200 text-lg md:text-xl max-w-lg mb-8",children:["Solved by:"," ",e.jsx("span",{className:"text-yellow-400 font-bold",children:(t.successfulSolvers||[]).map(n=>t.players.find(c=>c.id===n)?.name).join(", ")})]}),e.jsxs("div",{className:"bg-white/10 p-6 rounded-xl border border-white/20 mb-8 w-full max-w-md backdrop-blur-md",children:[e.jsx("div",{className:"text-sm uppercase tracking-widest text-blue-300 mb-6 font-bold",children:"The Solution"}),e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/80 border-2 border-red-500/50 p-4 rounded-xl flex flex-col items-center justify-center w-32 h-36 shadow-2xl",children:[e.jsx("div",{className:"scale-150 mb-2",children:C(t.solution.means)}),e.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:t.solution.means})]}),e.jsx("div",{className:"flex items-center text-white/50",children:e.jsx("span",{className:"text-2xl font-black",children:"+"})}),e.jsxs("div",{className:"bg-slate-900/80 border-2 border-blue-500/50 p-4 rounded-xl flex flex-col items-center justify-center w-32 h-36 shadow-2xl",children:[e.jsx("div",{className:"scale-150 mb-2",children:C(t.solution.clue)}),e.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:t.solution.clue})]})]}),e.jsxs("div",{className:"text-lg text-blue-200 bg-black/20 p-2 rounded-lg inline-block px-6",children:["Culprit:"," ",e.jsx("span",{className:"text-white font-black",children:t.players.find(n=>n.id===t.solution.murdererId)?.name})]})]}),t.hostId===l.uid&&e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:he,className:"bg-green-600 hover:bg-green-500 text-white px-8 py-3 rounded-full font-bold shadow-lg",children:"New Game"}),e.jsx("button",{onClick:me,className:"bg-slate-700 hover:bg-slate-600 text-white px-8 py-3 rounded-full font-bold shadow-lg",children:"Lobby"})]})]}),t.phase==="GAME_OVER_BAD"&&e.jsxs("div",{className:"fixed inset-0 top-14 bg-red-950/95 z-150 flex flex-col items-center justify-center p-6 text-center overflow-y-auto",children:[e.jsx(ae,{size:96,className:"text-red-500 mb-6 shadow-xl shrink-0"}),e.jsx("h1",{className:"text-4xl md:text-6xl font-black text-white mb-4",children:"MURDERER WINS"}),e.jsx("p",{className:"text-red-200 text-lg md:text-xl max-w-lg mb-8",children:"The investigation failed or the witness was silenced."}),e.jsxs("div",{className:"bg-white/10 p-6 rounded-xl border border-white/20 mb-8 w-full max-w-md backdrop-blur-md",children:[e.jsx("div",{className:"text-sm uppercase tracking-widest text-red-300 mb-6 font-bold",children:"The Solution"}),e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/80 border-2 border-red-500/50 p-4 rounded-xl flex flex-col items-center justify-center w-32 h-36 shadow-2xl",children:[e.jsx("div",{className:"scale-150 mb-2",children:C(t.solution.means)}),e.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:t.solution.means})]}),e.jsx("div",{className:"flex items-center text-white/50",children:e.jsx("span",{className:"text-2xl font-black",children:"+"})}),e.jsxs("div",{className:"bg-slate-900/80 border-2 border-blue-500/50 p-4 rounded-xl flex flex-col items-center justify-center w-32 h-36 shadow-2xl",children:[e.jsx("div",{className:"scale-150 mb-2",children:C(t.solution.clue)}),e.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:t.solution.clue})]})]}),e.jsxs("div",{className:"text-lg text-red-200 bg-black/20 p-2 rounded-lg inline-block px-6",children:["Culprit:"," ",e.jsx("span",{className:"text-white font-black",children:t.players.find(n=>n.id===t.solution.murdererId)?.name})]})]}),t.hostId===l.uid&&e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:he,className:"bg-green-600 hover:bg-green-500 text-white px-8 py-3 rounded-full font-bold shadow-lg",children:"New Game"}),e.jsx("button",{onClick:me,className:"bg-slate-700 hover:bg-slate-600 text-white px-8 py-3 rounded-full font-bold shadow-lg",children:"Lobby"})]})]}),e.jsxs("div",{className:"h-14 bg-slate-900/90 border-b border-slate-800 flex items-center justify-between px-4 z-160 sticky top-0 backdrop-blur-md shrink-0 shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{size:20,className:w}),e.jsx("span",{className:`font-black uppercase tracking-tight text-lg hidden md:block ${w}`,children:R}),e.jsx("span",{className:`font-black uppercase tracking-tight text-sm md:hidden ${w}`,children:R==="INVESTIGATION"?"INV.":R})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Re(!ne),className:`p-2 rounded-full ${ne?"bg-green-900 text-green-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(Ye,{size:18})}),e.jsx("button",{onClick:()=>U(!0),className:"p-2 text-slate-400 hover:bg-slate-800 rounded-full",children:e.jsx(Ve,{size:18})}),e.jsx("button",{onClick:()=>V(!0),className:"p-2 text-red-400 hover:bg-red-900/20 rounded-full",children:e.jsx(Le,{size:18})})]})]}),D,e.jsx("div",{className:"fixed bottom-0 left-0 w-full z-50",children:e.jsx(ee,{})})]})}return null}Et.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(Ut,{})}));
