import{c as J,i as Ut,g as Wt,a as qt,R as $e,H as Xe,j as e,r as w,e as Vt,o as ct,d as _,S as dt,L as jt,u as U,n as Kt,s as Xt,h as Zt,p as xt,q as le,t as Qt,X as ze,m as Jt}from"./x-CZayGA_K.js";import{B as at}from"./bomb-CPfKlG-9.js";import{U as He}from"./utensils-Czw7CYer.js";import{F as es}from"./flame-XBfCM_8i.js";import{C as ts}from"./cpu-ss1vPBLf.js";import{Z as ss}from"./zap-DHEZY8d6.js";import{S as as,B as Ze,C as Ye,a as ns,L as Qe,R as Nt,P as rs}from"./step-back-B0OJpjC1.js";import{P as be,C as ls}from"./package-BN6kFsWo.js";import{S as yt}from"./shield-check-DvSI8-Ee.js";import{U as De}from"./user-iW0fLfER.js";import{C as we}from"./crown-Dx9ZX0tf.js";import{S as oe}from"./siren-X_ZdJY1I.js";import{H as mt}from"./handshake-CwFD2Zap.js";import{S as vt}from"./skull-BGTgQEHs.js";import{C as Me}from"./coins-BhibZBWg.js";import{R as is}from"./repeat-BW_zRdst.js";import{L as os}from"./layers-CZxw1yXP.js";import{H as wt}from"./history-Zl31ME6M.js";import{S as fe}from"./shopping-bag-BAj5u9OS.js";import{F as zt}from"./file-text-BGLwDmGo.js";import{B as ge}from"./briefcase-R8NAtjLz.js";import{E as kt}from"./eye-vNcUtVSg.js";import{G as It}from"./ghost-BsYVa44o.js";import{L as Je}from"./lock-CZZW-3wT.js";import{I as cs}from"./info-Ck8746Bx.js";import{C as ds}from"./clock-CqBtuG2l.js";import{H as xs}from"./house-BF2Y3ccd.js";const ms=[["path",{d:"M12 18H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5",key:"x6cv4u"}],["path",{d:"m16 19 3 3 3-3",key:"1ibux0"}],["path",{d:"M18 12h.01",key:"yjnet6"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M6 12h.01",key:"c2rlol"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ps=J("banknote-arrow-down",ms);const hs=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],St=J("box",hs);const us=[["path",{d:"M4 20a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1z",key:"mqzwx6"}],["path",{d:"m6.7 18-1-1C4.35 15.682 3 14.09 3 12a5 5 0 0 1 4.95-5c1.584 0 2.7.455 4.05 1.818C13.35 7.455 14.466 7 16.05 7A5 5 0 0 1 21 12c0 2.082-1.359 3.673-2.7 5l-1 1",key:"1gdt1g"}],["path",{d:"M10 4h4",key:"1xpv9s"}],["path",{d:"M12 2v6.818",key:"b17a49"}]],bs=J("chess-king",us);const fs=[["path",{d:"M4 9a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h4a1 1 0 0 1 1 1v4a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-4a1 1 0 0 1 1-1h4a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-4a1 1 0 0 1-1-1V4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4a1 1 0 0 1-1 1z",key:"1xbrqy"}]],Ue=J("cross",fs);const gs=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],js=J("factory",gs);const Ns=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Ct=J("flag",Ns);const ys=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],vs=J("octagon-alert",ys);const ws=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],Et=J("scan",ws);const zs=[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]],We=J("shirt",zs);const ks=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}]],Is=J("sparkle",ks);const Ss=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Cs=J("trash",Ss);const Es=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],As=J("trending-down",Es);const Ls=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Rs=J("trending-up",Ls),pt="/rawfids-gamehub/assets/contraband_cover-CfnmcVqE.png",Os={apiKey:"AIzaSyC1rk47vYi_kdLnywxgPdPlVdbeyAhDpLc",authDomain:"rawfids-gamehub.firebaseapp.com",projectId:"rawfids-gamehub",storageBucket:"rawfids-gamehub.firebasestorage.app",messagingSenderId:"33131208034",appId:"1:33131208034:web:030549a981b3e80d6b603b"},At=Ut(Os),qe=Wt(At),D=qt(At),P=typeof __app_id<"u"?__app_id:"contraband-game",Ts="12",_e=500,et=500,Q={DIPLOMAT:{id:"DIPLOMAT",name:"Diplomat",desc:"Pay 50% less fines.",icon:Ct,color:"text-blue-400"},YAKUZA:{id:"YAKUZA",name:"Yakuza",desc:"+20% value for Contraband.",icon:It,color:"text-purple-400"},SNITCH:{id:"SNITCH",name:"Snitch",desc:"Earn $100 whenever another player is fined.",icon:kt,color:"text-yellow-400"},MERCHANT:{id:"MERCHANT",name:"Merchant",desc:"+20% value for Legal Goods.",icon:ge,color:"text-emerald-400"}},ie={NORMAL:{id:"NORMAL",name:"Market Stable",desc:"Business as usual.",multiplier:1,target:null},WAR:{id:"WAR",name:"War Zone",desc:"Weapons value x2.",multiplier:2,target:["WEAPON_1","WEAPON_2"]},PANDEMIC:{id:"PANDEMIC",name:"Pandemic",desc:"Meds & Rations value x2.",multiplier:2,target:["MEDS","FOOD","ROYAL_2_FOOD","ROYAL_3_FOOD","ROYAL_2_MEDS","ROYAL_3_MEDS"]},INDUSTRIAL_REV:{id:"INDUSTRIAL_REV",name:"Industrial Boom",desc:"Uniforms & Machinery value x2.",multiplier:2,target:["TEXTILE","PARTS","ROYAL_2_TEXTILE","ROYAL_3_TEXTILE","ROYAL_2_PARTS"]},RECESSION:{id:"RECESSION",name:"Market Recession",desc:"Contraband value -20%.",multiplier:.8,target:"ALL_ILLEGAL"},DEFLATION:{id:"DEFLATION",name:"Deflation",desc:"Legal Goods value -20%.",multiplier:.8,target:"ALL_LEGAL"},CRACKDOWN:{id:"CRACKDOWN",name:"Police Crackdown",desc:"All Fines Double.",multiplier:2,target:"ALL_FINES"},FREE_TRADE:{id:"FREE_TRADE",name:"Free Trade",desc:"All Fines Halved.",multiplier:.5,target:"ALL_FINES"}},he={POCKETS:{id:"POCKETS",name:"Deep Pockets",desc:"Hand Size +1 (Immediate Draw)",cost:300,icon:ge},EXPANDED:{id:"EXPANDED",name:"Crate Extension",desc:"Load up to 5 cards",cost:500,icon:St},CONCEAL:{id:"CONCEAL",name:"Hidden Compartment",desc:"One highest value illegal item is safe per inspection",cost:400,icon:Je},SCANNER:{id:"SCANNER",name:"X-Ray Scanner",desc:"As Inspector, reveal 1 random card per crate",cost:400,icon:Et}},z={FOOD:{id:"FOOD",name:"Rations",val:200,penalty:200,type:"LEGAL",icon:He,color:"text-green-200",kingBonus:1e3,queenBonus:600},MEDS:{id:"MEDS",name:"Medkits",val:300,penalty:200,type:"LEGAL",icon:Ue,color:"text-green-300",kingBonus:1500,queenBonus:900},TEXTILE:{id:"TEXTILE",name:"Uniforms",val:300,penalty:200,type:"LEGAL",icon:We,color:"text-green-400",kingBonus:1500,queenBonus:900},PARTS:{id:"PARTS",name:"Machinery",val:400,penalty:200,type:"LEGAL",icon:Xe,color:"text-green-500",kingBonus:2e3,queenBonus:1200},WEAPON_1:{id:"WEAPON_1",name:"Laser Gun",val:600,penalty:400,type:"ILLEGAL",icon:Is,color:"text-red-200"},WEAPON_2:{id:"WEAPON_2",name:"Plasma Rifle",val:700,penalty:400,type:"ILLEGAL",icon:ss,color:"text-red-300"},CHIP:{id:"CHIP",name:"Neural Chip",val:800,penalty:400,type:"ILLEGAL",icon:ts,color:"text-red-400"},SPICE:{id:"SPICE",name:"Red Dust",val:900,penalty:400,type:"ILLEGAL",icon:es,color:"text-red-500"},ROYAL_2_FOOD:{id:"ROYAL_2_FOOD",name:"Ambrosia",val:400,penalty:300,type:"ILLEGAL",icon:He,color:"text-cyan-200",legalType:"FOOD",legalCount:2},ROYAL_2_MEDS:{id:"ROYAL_2_MEDS",name:"Panacea Vial",val:600,penalty:400,type:"ILLEGAL",icon:Ue,color:"text-cyan-300",legalType:"MEDS",legalCount:2},ROYAL_2_TEXTILE:{id:"ROYAL_2_TEXTILE",name:"Neo-Silk",val:600,penalty:400,type:"ILLEGAL",icon:We,color:"text-cyan-400",legalType:"TEXTILE",legalCount:2},ROYAL_2_PARTS:{id:"ROYAL_2_PARTS",name:"Quantum Gear",val:800,penalty:400,type:"ILLEGAL",icon:Xe,color:"text-cyan-500",legalType:"PARTS",legalCount:2},ROYAL_3_FOOD:{id:"ROYAL_3_FOOD",name:"Nectar of Gods",val:600,penalty:400,type:"ILLEGAL",icon:He,color:"text-yellow-200",legalType:"FOOD",legalCount:3},ROYAL_3_MEDS:{id:"ROYAL_3_MEDS",name:"Phoenix Serum",val:900,penalty:400,type:"ILLEGAL",icon:Ue,color:"text-yellow-300",legalType:"MEDS",legalCount:3},ROYAL_3_TEXTILE:{id:"ROYAL_3_TEXTILE",name:"Astral Velvet",val:900,penalty:400,type:"ILLEGAL",icon:We,color:"text-yellow-400",legalType:"TEXTILE",legalCount:3},TRAP:{id:"TRAP",name:"Booby Trap",val:0,penalty:0,type:"TRAP",icon:at,color:"text-orange-400",desc:"If opened: Inspector pays $200"}},Ve=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(be,{size:12,className:"text-emerald-400"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-emerald-400 uppercase",children:"CONTRABAND"})]}),ht=()=>e.jsxs("div",{className:"flex items-center justify-center gap-1 opacity-40 mt-auto pb-2 pt-2 relative z-10",children:[e.jsx(be,{size:20,className:"text-emerald-400"}),e.jsx("span",{className:"text-[20px] font-black tracking-widest text-emerald-400 uppercase",children:"CONTRABAND"})]}),_s=(a,x="SHORT")=>{let r=[];const n=x==="LONG"&&a>4?1.5:1,d={MEDS:8*a*n,FOOD:6*a*n,PARTS:6*a*n,TEXTILE:4*a*n,WEAPON_1:4*a*n,WEAPON_2:4*a*n,CHIP:2*a*n,SPICE:2*a*n,ROYAL_2_MEDS:2*n,ROYAL_2_FOOD:2*n,ROYAL_2_TEXTILE:2*n,ROYAL_2_PARTS:2*n,ROYAL_3_MEDS:2*n,ROYAL_3_FOOD:2*n,ROYAL_3_TEXTILE:2*n};Object.entries(d).forEach(([u,A])=>{for(let B=0;B<A;B++)r.push(u)});for(let u=0;u<a;u++)r.push("TRAP");return r},tt=a=>{let x=a.length,r;for(;x!==0;)r=Math.floor(Math.random()*x),x--,[a[x],a[r]]=[a[r],a[x]];return a},Ke=(a,x)=>{if(a.length===0)return null;let r=[],n=null;const d=x.includes("TRAP");for(;a.length>0;){let u=a.pop();if(u==="TRAP"&&d)r.push(u);else{n=u;break}}return r.length>0&&a.unshift(...r),n},ut=a=>{const x=Object.keys(Q),r=[...x];for(;r.length<a.length;)r.push(...x);const n=tt(r);return a.map((d,u)=>({...d,role:Q[n[u]].id}))},F=(a,x,r)=>{const n=a[x]||{income:0,expense:0,transactions:[],role:"",isInspector:!1,marketItems:[],roleBonus:0,eventImpact:0},d=r.transaction?[...n.transactions||[],r.transaction]:n.transactions||[],u=r.marketItem?[...n.marketItems||[],r.marketItem]:n.marketItems||[];return{...a,[x]:{...n,...r,income:(n.income||0)+(r.income||0),expense:(n.expense||0)+(r.expense||0),roleBonus:(n.roleBonus||0)+(r.roleBonus||0),eventImpact:(n.eventImpact||0)+(r.eventImpact||0),transactions:d,marketItems:u}}},ve=$e.memo(()=>{const a=$e.useMemo(()=>[...Array(20)].map((x,r)=>{const n=Object.keys(z),d=z[n[r%n.length]].icon;return e.jsx("div",{className:"absolute animate-float text-white/60",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*20}s`,transform:`scale(${.5+Math.random()})`},children:e.jsx(d,{size:32})},r)}),[]);return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,var(--tw-gradient-stops))] from-yellow-900/20 via-gray-950 to-black"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:a}),e.jsx("style",{children:`
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-20px) rotate(10deg); }
        }
        .animate-float { animation: float infinite ease-in-out; }
      `})]})}),Ds=({typeId:a,size:x=12})=>{const r=z[a];return r?e.jsx(r.icon,{size:x,className:r.color}):null},bt=({players:a,roundData:x,isFinal:r})=>{const[n,d]=w.useState(r?"FINAL":Math.max(0,x.length-1)),u=r?["FINAL","STASH",...x.map((t,S)=>`ROUND ${S+1}`)]:[],A=()=>{const t=[...a].sort((S,H)=>H.finalScore-S.finalScore);return e.jsx("div",{className:"flex flex-row gap-4 p-6 bg-zinc-900/50 overflow-x-auto pb-8 snap-x",children:t.map((S,H)=>{const l=[],N=[],R=[],W=[],b=[],C={};return S.stash.forEach(g=>{C[g]=(C[g]||0)+1}),Object.entries(C).forEach(([g,ee])=>{const M=z[g];if(!M)return;const ne={...M,qty:ee};M.id.startsWith("ROYAL_")&&N.push(ne),M.id.startsWith("ROYAL_2")?R.push(ne):M.id.startsWith("ROYAL_3")?W.push(ne):M.type==="ILLEGAL"?b.push(ne):M.type==="LEGAL"&&l.push(ne)}),e.jsxs("div",{className:`flex flex-col w-[320px] shrink-0 bg-zinc-800 rounded-xl border snap-center ${H===0?"border-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.1)]":"border-zinc-700"} overflow-hidden`,children:[e.jsxs("div",{className:"p-3 bg-black/20 w-full flex flex-row justify-between items-center border-b border-zinc-700",children:[e.jsx("div",{children:e.jsx("div",{className:"font-bold text-md text-white",children:S.name})}),H===0&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500 text-[10px] font-bold uppercase tracking-wider bg-yellow-900/20 px-2 py-1 rounded border border-yellow-500/20",children:[e.jsx(we,{size:10})," Winner"]})]}),e.jsxs("div",{className:"flex-1 p-3 flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-widest border-b border-zinc-700 pb-1",children:"Exports Manifest"}),l.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-emerald-500 font-bold uppercase mb-1 block",children:"Legal Goods"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:l.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-emerald-900/20 px-1.5 py-0.5 rounded border border-emerald-500/20 text-[10px] text-emerald-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id))})]}),N.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-yellow-500 font-bold uppercase mb-1 block",children:"Royal Goods"}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[W.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-yellow-900/20 px-1.5 py-0.5 rounded border border-yellow-500/20 text-[10px] text-yellow-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id)),R.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-cyan-900/20 px-1.5 py-0.5 rounded border border-cyan-500/20 text-[10px] text-cyan-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id))]})]}),b.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-red-500 font-bold uppercase mb-1 block",children:"Contraband"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:b.map(g=>e.jsxs("div",{className:"flex items-center gap-1 bg-red-900/20 px-1.5 py-0.5 rounded border border-red-500/20 text-[10px] text-red-100",children:[e.jsx(g.icon,{size:10})," ",g.name," ",e.jsxs("span",{className:"font-mono opacity-60",children:["x",g.qty]})]},g.id))})]}),l.length===0&&N.length===0&&b.length===0&&e.jsx("div",{className:"text-zinc-600 italic text-xs",children:"No goods exported."})]}),e.jsxs("div",{className:"bg-black/20 -mx-3 -mb-3 p-3 border-t border-zinc-700 mt-auto",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-2",children:"Titles & Honors"}),S.kqDetails&&S.kqDetails.length>0?e.jsx("div",{className:"space-y-1 mb-3",children:S.kqDetails.map((g,ee)=>{const M=g.includes("King");return e.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded ${M?"bg-yellow-500/10":"bg-pink-500/10"}`,children:[M?e.jsx(we,{size:12,className:"text-yellow-400"}):e.jsx(bs,{size:12,className:"text-pink-400"}),e.jsx("span",{className:`text-[10px] font-bold ${M?"text-yellow-200":"text-pink-200"}`,children:g})]},ee)})}):e.jsx("div",{className:"text-zinc-600 italic text-[10px] mb-3",children:"No titles awarded."}),e.jsxs("div",{className:"flex justify-between items-center border-t border-zinc-700 pt-2",children:[e.jsx("span",{className:"text-[10px] text-zinc-500 uppercase",children:"Bonus Payout"}),e.jsxs("span",{className:`font-mono font-bold ${S.kqIncome>0?"text-yellow-400 text-sm":"text-zinc-600 text-xs"}`,children:["+$",S.kqIncome]})]})]})]})]},S.id)})})},B=(t,S)=>{let H=[];if(S)H=a.map(l=>{let N=0,R=[],W=0,b=[],C=0,g=[],ee=0,M=[];const ne=l.kqIncome||0,ke=l.kqDetails||[],je=l.stash||[];x.forEach((te,ce)=>{const G=te.stats[l.id];if(G){G.roleBonus>0&&(N+=G.roleBonus,R.push(`R${ce+1} (${Q[G.role]?.name}): +$${G.roleBonus}`)),G.eventImpact&&G.eventImpact!==0&&(W+=G.eventImpact,b.push(`R${ce+1} (${te.event?.name}): ${G.eventImpact>0?"+":""}$${G.eventImpact}`)),G.marketItems&&G.marketItems.length>0&&G.marketItems.forEach(se=>{const O=he[se];O&&(ee+=O.cost,M.push(`R${ce+1}: ${O.name} (-$${O.cost})`))});const Ce=["Fine Paid","Fine Collected","Bribe Paid","Bribe Accepted","Bribe Returned","Trap Exploded","Trap Reward","Wrongful Search","Clean Bonus"];G.transactions&&G.transactions.forEach(se=>{if(Ce.includes(se.label)&&(C+=se.amount,Math.abs(se.amount)>0)){let O=se.label;O==="Fine Paid"&&(O="Fined"),O==="Fine Collected"&&(O="Fine Coll."),O==="Trap Exploded"&&(O="Trap Hit"),O==="Wrongful Search"&&(O="Clean"),g.push(`R${ce+1}: ${O} (${se.amount>0?"+":""}${se.amount})`)}})}});const Ie=je.reduce((te,ce)=>te+(z[ce]?.val||0),0),Se=Math.floor(l.coins-et+ne);return{id:l.id,name:l.name,role:l.role,cash:l.coins,stashVal:Ie,bonus:Math.floor(N),bonusDetails:R,eventBonus:W,eventDetails:b,inspectionNet:C,inspectionDetails:g,marketCost:ee,marketDetails:M,kqIncome:ne,kqDetails:ke,loan:-et,total:Se,isWinner:!1}}),H.sort((l,N)=>N.total-l.total),H.length>0&&(H[0].isWinner=!0);else{typeof n=="string"&&parseInt(n.split(" ")[1])-1;const l=Array.isArray(x)?x[n==="FINAL"||n==="STASH"?0:typeof n=="number"?n:parseInt(n.split(" ")[1])-1]:null,N=l?l.stats:null,R=l?l.event:null;if(!N)return e.jsx("div",{className:"p-12 text-center text-zinc-500 italic",children:"No Data Available"});H=Object.keys(N).map(W=>{const b=N[W],C=a.find(g=>g.id===W)?.name||"Unknown";return{id:W,name:C,role:b.role,isInspector:b.isInspector,marketItems:b.marketItems||[],roleBonus:b.roleBonus||0,eventImpact:b.eventImpact||0,transactions:b.transactions||[],income:b.income,expense:b.expense,net:b.income-b.expense,activeEvent:R}})}return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-zinc-900/50 text-xs uppercase text-zinc-500 font-bold tracking-wider",children:[e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Agent"}),S?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right",children:"Cash"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-emerald-300",children:"Stash"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-purple-400",children:"Insp. Impact"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-orange-400",children:"Black Market"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-yellow-400",children:"Role Bonus"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-blue-400",children:"Event Impact"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-yellow-200",children:"King/Queen"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-red-400",children:"Loan"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right text-white",children:"Final Score"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Event Impact"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Market"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800",children:"Role Bonus"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 w-1/3",children:"Activity Log"}),e.jsx("th",{className:"px-6 py-3 border-b border-zinc-800 text-right",children:"Net Change"})]})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-800 text-sm",children:H.map((l,N)=>{const R=Q[l.role]?.icon,W=Q[l.role]?.color;return S?e.jsxs("tr",{className:`group hover:bg-zinc-800/30 transition-colors ${l.isWinner?"bg-emerald-900/10":""}`,children:[e.jsx("td",{className:"px-6 py-4 align-top",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex items-center justify-center w-6 h-6 rounded-full font-bold text-[10px] ${l.isWinner?"bg-yellow-500 text-black":"bg-zinc-800 text-zinc-500"}`,children:N+1}),e.jsx("span",{className:`font-medium ${l.isWinner?"text-white":"text-zinc-400"}`,children:l.name}),l.isWinner&&e.jsx(we,{size:14,className:"text-yellow-500"})]})}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-zinc-400 align-top",children:["$",l.cash]}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-emerald-300 align-top",children:["$",l.stashVal]}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.inspectionNet>0?"text-purple-400":l.inspectionNet<0?"text-red-400":"text-zinc-600"}`,children:[l.inspectionNet>0?"+":"",l.inspectionNet]}),l.inspectionDetails.map((b,C)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},C))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.marketCost>0?"text-orange-400":"text-zinc-600"}`,children:["-$",l.marketCost]}),l.marketDetails.map((b,C)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},C))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"font-mono text-yellow-400",children:["+",l.bonus]}),l.bonusDetails.map((b,C)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},C))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.eventBonus>0?"text-blue-400":l.eventBonus<0?"text-red-400":"text-zinc-600"}`,children:[l.eventBonus>0?"+":"",l.eventBonus]}),l.eventDetails.map((b,C)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},C))]})}),e.jsx("td",{className:"px-6 py-4 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`font-mono ${l.kqIncome>0?"text-yellow-200":"text-zinc-600"}`,children:[l.kqIncome>0?"+":"",l.kqIncome]}),l.kqDetails.map((b,C)=>e.jsx("span",{className:"text-[9px] text-zinc-500 whitespace-nowrap",children:b},C))]})}),e.jsx("td",{className:"px-6 py-4 text-right font-mono text-red-400 align-top",children:l.loan}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono font-bold text-white text-lg align-top",children:["$",l.total]})]},l.id):e.jsxs("tr",{className:"group hover:bg-zinc-800/30",children:[e.jsxs("td",{className:"px-6 py-4 align-top",children:[e.jsx("div",{className:"font-medium text-white mb-1",children:l.name}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-zinc-500 mb-2",children:[l.isInspector?e.jsx(oe,{size:12,className:"text-red-500"}):e.jsx(R,{size:12,className:W??"text-zinc-400"}),l.isInspector?"Inspector":Q[l.role]?.name]})]}),e.jsxs("td",{className:"px-6 py-4 align-top",children:[l.activeEvent&&e.jsx("div",{className:"text-xs text-zinc-400 mb-1",children:e.jsx("div",{className:"font-bold text-zinc-300",children:l.activeEvent.name})}),l.eventImpact!==0?e.jsxs("span",{className:`font-mono text-xs font-bold px-1.5 py-0.5 rounded ${l.eventImpact>0?"text-emerald-400 bg-emerald-900/20":"text-red-400 bg-red-900/20"}`,children:[l.eventImpact>0?"+":"",l.eventImpact]}):e.jsx("span",{className:"text-zinc-600 text-xs",children:"-"})]}),e.jsx("td",{className:"px-6 py-4 align-top",children:l.marketItems.length>0?e.jsx("div",{className:"flex flex-col gap-1",children:l.marketItems.map((b,C)=>{const g=he[b];return e.jsxs("div",{className:"text-xs text-zinc-400 flex items-center gap-1",children:[e.jsx(fe,{size:10})," ",g?.name," ",e.jsxs("span",{className:"text-red-400",children:["-$",g?.cost]})]},C)})}):e.jsx("span",{className:"text-zinc-600 italic text-xs",children:"-"})}),e.jsx("td",{className:"px-6 py-4 align-top",children:l.roleBonus>0?e.jsxs("span",{className:"text-yellow-400 font-mono text-xs",children:["+$",l.roleBonus]}):e.jsx("span",{className:"text-zinc-600 text-xs",children:"-"})}),e.jsx("td",{className:"px-6 py-4 align-top",children:e.jsx("div",{className:"space-y-2",children:l.transactions.length===0?e.jsx("span",{className:"text-zinc-600 italic text-xs",children:"No activity."}):l.transactions.map((b,C)=>e.jsxs("div",{className:"flex flex-col text-xs border-b border-zinc-800 pb-1 last:border-0",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{className:"text-zinc-300 font-bold",children:b.label}),e.jsxs("span",{className:`font-mono ${b.amount>=0?"text-emerald-400":"text-red-400"}`,children:[b.amount>=0?"+":"",b.amount]})]}),b.items&&b.items.length>0&&e.jsx("div",{className:"flex gap-1 mt-1 flex-wrap",children:b.items.map((g,ee)=>e.jsx("div",{className:"bg-black/40 p-0.5 rounded border border-zinc-700",title:z[g]?.name,children:e.jsx(Ds,{typeId:g,size:10})},ee))}),b.detail&&e.jsx("div",{className:"text-[10px] text-zinc-500 mt-0.5",children:b.detail})]},C))})}),e.jsx("td",{className:"px-6 py-4 text-right font-mono font-bold align-top",children:e.jsxs("span",{className:l.net>=0?"text-emerald-400":"text-red-400",children:[l.net>=0?"+":"",l.net]})})]},l.id)})})]})})};return e.jsxs("div",{className:"w-full max-w-5xl bg-zinc-900 rounded-xl border border-zinc-700 overflow-hidden shadow-2xl mb-6 animate-in fade-in slide-in-from-bottom-10 duration-700",children:[e.jsx("div",{className:"bg-zinc-950 px-6 py-4 border-b border-zinc-800 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-900/30 rounded-lg border border-emerald-500/20",children:e.jsx(zt,{className:"text-emerald-500",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Mission Report"}),e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wider",children:r?"Final Operation Audit":"Round Summary"})]})]})}),r&&e.jsx("div",{className:"flex border-b border-zinc-800 bg-zinc-900/50 overflow-x-auto",children:u.map(t=>e.jsx("button",{onClick:()=>d(t),className:`px-6 py-3 text-sm font-bold transition-colors whitespace-nowrap ${n===t?"text-emerald-400 border-b-2 border-emerald-500 bg-emerald-900/10":"text-zinc-500 hover:text-zinc-300"}`,children:t},t))}),r&&n==="STASH"?A():B(x,r&&n==="FINAL")]})},Ms=({stash:a,onClose:x})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-160 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-700 p-6 max-w-lg w-full shadow-2xl flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-zinc-800 pb-2",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(ge,{className:"text-emerald-500"})," Stash (",a.length,")"]}),e.jsx("button",{onClick:x,className:"p-1 hover:bg-zinc-800 rounded text-zinc-400",children:e.jsx(ze,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto grid grid-cols-4 gap-2",children:a.length===0?e.jsx("div",{className:"col-span-4 text-center text-zinc-500 py-8 italic",children:"Your stash is empty."}):a.map((r,n)=>{const d=z[r];if(!d)return null;const u=d.type==="ILLEGAL";return e.jsxs("div",{className:`p-2 rounded border flex flex-col items-center gap-1 ${u?"bg-red-900/10 border-red-900/30":"bg-emerald-900/10 border-emerald-900/30"}`,children:[e.jsx(d.icon,{size:24,className:d.color}),e.jsx("span",{className:`text-[10px] font-bold ${d.color}`,children:d.name}),e.jsxs("span",{className:"text-[9px] text-zinc-500",children:["$",d.val]})]},n)})}),e.jsxs("div",{className:"mt-4 pt-2 border-t border-zinc-800 text-center text-xs text-zinc-500",children:["Total Base Value: $",a.reduce((r,n)=>r+(z[n]?.val||0),0)]})]})}),$s=({player:a,onClose:x})=>{if(!a)return null;const r=a.stash||[],n=r.filter(u=>z[u]?.type==="LEGAL").length,d=r.length-n;return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-160 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-700 p-6 max-w-lg w-full shadow-2xl flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-zinc-800 pb-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(De,{size:20,className:"text-zinc-400"}),a.name,"'s Cargo"]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-1",children:["Visible:"," ",e.jsxs("span",{className:"text-emerald-400",children:[n," Legal"]})," â€¢ Suspicious:"," ",e.jsxs("span",{className:"text-red-400",children:[d," Unknown"]})]})]}),e.jsx("button",{onClick:x,className:"p-1 hover:bg-zinc-800 rounded text-zinc-400",children:e.jsx(ze,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:r.length===0?e.jsx("div",{className:"text-center text-zinc-500 py-12 italic border-2 border-dashed border-zinc-800 rounded-xl",children:"Cargo Hold Empty"}):e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2",children:r.map((u,A)=>{const B=z[u],t=B&&B.type==="LEGAL";return e.jsx("div",{className:"flex justify-center",children:e.jsx(st,{typeId:u,small:!0,faceDown:!t})},A)})})}),e.jsx("div",{className:"mt-4 pt-3 border-t border-zinc-800 text-center",children:e.jsx("div",{className:"text-xs text-zinc-600 uppercase tracking-widest",children:"Official Public Record"})})]})})},st=({typeId:a,small:x,selected:r,onClick:n,faceDown:d})=>{const u=z[a];if(!u)return null;const A=u.icon,B=u.type==="ILLEGAL",t=u.type==="TRAP",S=a.startsWith("ROYAL_");return d?e.jsx("div",{className:`
        relative shrink-0 rounded-xl border-2 border-zinc-700 bg-zinc-800 
        flex flex-col items-center justify-center shadow-lg
        ${x?"w-10 h-14":"w-20 h-32"}
      `,children:e.jsx("div",{className:"opacity-20",children:e.jsx(be,{size:x?16:32})})}):e.jsxs("div",{onClick:n,className:`
        relative shrink-0 rounded-xl border-2 flex flex-col items-center justify-between shadow-lg transition-all 
        ${r?"ring-4 ring-yellow-400 -translate-y-2 z-10 scale-105":"hover:-translate-y-1"}
        ${t?"bg-orange-950/50 border-orange-600/50":S?"bg-purple-950/50 border-purple-500/50":B?"bg-red-950/30 border-red-900/50":"bg-emerald-950/30 border-emerald-900/50"}
        ${x?"w-12 h-16 p-1":"w-24 h-36 md:w-32 md:h-44 p-2 md:p-3"}
        ${n?"cursor-pointer":""}
      `,children:[e.jsxs("div",{className:"w-full flex justify-between items-start",children:[e.jsx("span",{className:`font-black ${x?"text-[8px]":"text-xs"} text-zinc-500`,children:t?"TRAP":S?"ROYAL":B?"!!":"OK"}),e.jsx(A,{size:x?10:16,className:u.color})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(A,{size:x?16:32,className:`${u.color} drop-shadow-md`}),!x&&e.jsx("span",{className:`text-[10px] uppercase font-bold text-center leading-tight ${u.color}`,children:u.name})]}),!x&&e.jsx("div",{className:"w-full bg-black/40 rounded p-1 text-[8px] text-zinc-400 text-center leading-tight",children:t?"Inspector pays fine":e.jsxs(e.Fragment,{children:["val: ",u.val," ",e.jsx("br",{})," fine: ",u.penalty]})})]})},Ps=a=>{const x=["MEDS","FOOD","PARTS","TEXTILE"],r={};return a.forEach(n=>{r[n.id]={income:0,details:[]}}),x.forEach(n=>{const d=a.map(N=>{let R=0;return(N.stash||[]).forEach(W=>{const b=z[W];b&&(b.id===n&&(R+=1),b.legalType===n&&(R+=b.legalCount||0))}),{id:N.id,count:R,name:N.name}});if(d.sort((N,R)=>R.count-N.count),d.length===0)return;const u=d[0].count;if(u===0)return;const A=d.filter(N=>N.count===u),B=d.filter(N=>N.count<u&&N.count>0),t=B.length>0?B[0].count:0,S=B.filter(N=>N.count===t),H=z[n]?.kingBonus||0,l=z[n]?.queenBonus||0;A.forEach(N=>{r[N.id].income+=H,r[N.id].details.push(`King of ${z[n]?.name} (+${H})`)}),A.length===1&&S.length>0&&S.forEach(N=>{r[N.id].income+=l,r[N.id].details.push(`Queen of ${z[n]?.name} (+${l})`)})}),r},ft=({onConfirm:a,onCancel:x,isHost:r,onLobby:n})=>e.jsx("div",{className:"fixed inset-0 bg-black/90 z-200 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-700 p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:r?"Disband Operation?":"Abandon Cargo?"}),e.jsx("p",{className:"text-zinc-400 mb-6 text-sm",children:r?"You are the Host. Leaving will close the checkpoint and kick all players.":"Leaving now will forfeit your progress."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[r&&n&&e.jsxs("button",{onClick:n,className:"bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded font-bold transition-colors flex items-center justify-center gap-2",children:[e.jsx(xs,{size:18})," Return Everyone to Lobby"]}),e.jsxs("button",{onClick:a,className:"bg-red-900/80 hover:bg-red-800 text-red-200 py-3 rounded font-bold transition-colors flex items-center justify-center gap-2 border border-red-900",children:[e.jsx(Qe,{size:18})," ",r?"Destroy Room & Exit":"Leave Game"]}),e.jsx("button",{onClick:x,className:"text-zinc-500 hover:text-white py-2 text-sm",children:"Cancel"})]})]})}),Bs=({type:a,message:x,subtext:r,icon:n})=>e.jsx("div",{className:"fixed inset-0 z-160 flex items-center justify-center pointer-events-none p-4",children:e.jsxs("div",{className:`
      flex flex-col items-center justify-center p-8 md:p-12 rounded-3xl border-4 shadow-[0_0_50px_rgba(0,0,0,0.8)] 
      transform transition-all animate-in fade-in zoom-in slide-in-from-bottom-5 duration-300 backdrop-blur-xl
      ${a==="success"?"bg-emerald-900/90 border-emerald-500 text-emerald-100":""}
      ${a==="danger"?"bg-red-900/90 border-red-500 text-red-100":""}
      ${a==="neutral"?"bg-zinc-800/90 border-zinc-500 text-zinc-100":""}
      ${a==="bribe"?"bg-yellow-900/90 border-yellow-500 text-yellow-100":""}
    `,children:[n&&e.jsx("div",{className:"mb-4 p-4 bg-black/30 rounded-full border-2 border-white/20 shadow-xl",children:e.jsx(n,{size:48,className:"animate-bounce"})}),e.jsx("h2",{className:"text-4xl md:text-6xl font-black uppercase tracking-widest text-center drop-shadow-lg mb-2",children:x}),r&&e.jsx("p",{className:"text-xl md:text-2xl font-bold opacity-90 tracking-wide text-center",children:r})]})}),Gs=({isOpen:a,onClose:x,player:r,onBuy:n})=>a?e.jsx("div",{className:"fixed inset-0 bg-black/90 z-100 flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 rounded-2xl w-full max-w-2xl max-h-[80vh] flex flex-col border border-yellow-600/30 shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-zinc-950 border-b border-zinc-800 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-yellow-500 flex items-center gap-2",children:[e.jsx(fe,{})," Black Market"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-white font-mono flex items-center gap-1 bg-zinc-800 px-3 py-1 rounded-full",children:[e.jsx(Me,{size:14,className:"text-yellow-500"})," $",r.coins]}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-zinc-800 rounded-full",children:e.jsx(ze,{className:"text-zinc-400"})})]})]}),e.jsx("div",{className:"p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(he).map(d=>{const u=r.upgrades?.includes(d.id),A=r.coins>=d.cost;return e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700 flex flex-col justify-between group hover:border-yellow-500/50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"p-2 bg-black/50 rounded-lg text-yellow-500",children:e.jsx(d.icon,{size:24})}),e.jsxs("span",{className:"text-sm font-mono text-zinc-400",children:["$",d.cost]})]}),e.jsx("h3",{className:"font-bold text-lg text-white mb-1",children:d.name}),e.jsx("p",{className:"text-xs text-zinc-400 mb-4 h-8",children:d.desc}),e.jsx("button",{onClick:()=>n(d),disabled:u||!A,className:`w-full py-2 rounded font-bold text-sm transition-all
                    ${u?"bg-zinc-700 text-zinc-500 cursor-default":A?"bg-yellow-600 hover:bg-yellow-500 text-black shadow-lg shadow-yellow-900/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed"}`,children:u?"OWNED":A?"BUY":"TOO POOR"})]},d.id)})})]})}):null,Fs=({logs:a,onClose:x})=>e.jsx("div",{className:"fixed top-16 right-4 w-64 max-h-60 bg-gray-900/95 border border-gray-700 rounded-xl z-155 overflow-y-auto p-2 shadow-2xl",children:e.jsxs("div",{className:"bg-zinc-900 w-full md:max-w-md h-full md:h-[70vh] rounded-none md:rounded-xl flex flex-col border-none md:border border-zinc-700 shadow-2xl",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-800 flex justify-between items-center bg-zinc-950",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx(wt,{size:18,className:"text-emerald-500"})," Operation Logs"]}),e.jsx("button",{onClick:x,className:"p-2 bg-zinc-800 rounded-full hover:bg-zinc-700",children:e.jsx(ze,{className:"text-zinc-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...a].reverse().map((r,n)=>e.jsxs("div",{className:`text-xs md:text-sm p-3 rounded border-l-2 ${r.type==="danger"?"bg-red-900/10 border-red-500 text-red-300":r.type==="success"?"bg-green-900/10 border-green-500 text-green-300":r.type==="bribe"?"bg-yellow-900/10 border-yellow-500 text-yellow-300":"bg-zinc-800/50 border-zinc-600 text-zinc-400"}`,children:[e.jsxs("span",{className:"opacity-50 mr-2 font-mono",children:["[",new Date(parseInt(r.id)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),"]"]}),r.text]},n))})]})}),gt=({onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black/95 z-150 flex items-center justify-center p-0 md:p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-zinc-900 md:rounded-2xl w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] overflow-hidden border-none md:border border-emerald-500/30 flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-zinc-800 flex justify-between items-center bg-zinc-950",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2 tracking-wider",children:[e.jsx(Ze,{className:"text-emerald-500"})," Smuggler's Guide"]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-zinc-800 rounded-full text-zinc-400",children:e.jsx(ze,{})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-zinc-300 space-y-8 scrollbar-thin scrollbar-thumb-zinc-700",children:[e.jsxs("section",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-3xl font-black text-emerald-400 uppercase tracking-widest",children:"The Goal"}),e.jsx("p",{className:"text-lg text-zinc-400",children:"Amass the biggest fortune. Money is earned by smuggling goods and collecting fines. The player with the highest total value (Cash + Stash + Bonus)."})]}),e.jsxs("section",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700",children:[e.jsxs("h4",{className:"font-bold text-yellow-500 mb-2 flex items-center gap-2",children:[e.jsx(fe,{size:16})," 1. The Market"]}),e.jsx("p",{className:"text-sm",children:"Buy illegal upgrades from the Black Market. Deep pockets, crate extensions, and scanners can turn the tide."})]}),e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700",children:[e.jsxs("h4",{className:"font-bold text-emerald-500 mb-2 flex items-center gap-2",children:[e.jsx(be,{size:16})," 2. Load & Bluff"]}),e.jsxs("p",{className:"text-sm",children:["Pack up to 4 items (+1 with extention). You must declare a legal good type. You can lie. You can also attach a cash ",e.jsx("strong",{children:"Bribe"})," to tempt the Inspector."]})]}),e.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded-xl border border-zinc-700",children:[e.jsxs("h4",{className:"font-bold text-red-500 mb-2 flex items-center gap-2",children:[e.jsx(oe,{size:16})," 3. Inspection"]}),e.jsxs("p",{className:"text-sm",children:["The Inspector chooses to ",e.jsx("strong",{children:"PASS"})," or"," ",e.jsx("strong",{children:"OPEN"})," or take ",e.jsx("strong",{children:"BRIBE"}),". If passed, you sell goods immediately. If opened and caught lying, you pay a fine!"]})]})]}),e.jsxs("section",{className:"bg-zinc-800/30 p-5 rounded-xl border border-zinc-700/50",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(yt,{className:"text-emerald-500"})," Inspection Mechanics"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-sm",children:[e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-400 font-bold min-w-[60px]",children:"PASS:"})," ","Smuggler keeps goods & earns full value immediately."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-yellow-400 font-bold min-w-[60px]",children:"BRIBE:"})," ","If Inspector accepts bribe, crate passes. Inspector keeps bribe."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-orange-400 font-bold min-w-[60px]",children:"TRAP:"})," ","If opened crate has a"," ",e.jsx("span",{className:"text-orange-500 font-bold",children:"Booby Trap"}),", Inspector pays $200 fine!"]})]}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-red-400 font-bold min-w-[60px]",children:"BUSTED:"})," ","If opened & lying (or contraband): Smuggler pays fine. Illegal goods seized."]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-400 font-bold min-w-[60px]",children:"CLEAN:"})," ","If opened & telling truth: Inspector pays fine to Smuggler for wasting time."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Player Roles"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-blue-400 mb-1",children:[e.jsx(Ct,{size:16})," Diplomat"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"Pays 50% less fines when caught."})]}),e.jsxs("div",{className:"p-3 bg-purple-900/20 border border-purple-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-purple-400 mb-1",children:[e.jsx(It,{size:16})," Yakuza"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"+20% immediate value for Illegal goods."})]}),e.jsxs("div",{className:"p-3 bg-emerald-900/20 border border-emerald-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-emerald-400 mb-1",children:[e.jsx(ge,{size:16})," Merchant"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"+20% immediate value for Legal goods."})]}),e.jsxs("div",{className:"p-3 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-yellow-400 mb-1",children:[e.jsx(kt,{size:16})," Snitch"]}),e.jsx("div",{className:"text-xs text-zinc-400",children:"Get $100 whenever someone else is fined."})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(fe,{className:"text-yellow-500"})," Black Market Items"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.values(he).map(x=>e.jsxs("div",{className:"p-3 bg-zinc-800/50 border border-yellow-600/20 rounded-lg flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-yellow-500",children:[e.jsx(x.icon,{size:16})," ",x.name]}),e.jsxs("span",{className:"text-xs font-mono text-zinc-300 bg-black/40 px-2 py-0.5 rounded border border-zinc-700",children:["$",x.cost]})]}),e.jsx("div",{className:"text-xs text-zinc-400",children:x.desc})]},x.id))})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Global Events"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(at,{size:16,className:"text-red-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"War Zone:"})," Weapons sell for 2x value."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(vt,{size:16,className:"text-purple-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Pandemic:"})," Meds and Foods sell for 2x value."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(js,{size:16,className:"text-green-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Industrial Revolution:"})," Uniforms and Machinery sell for 2x value."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(oe,{size:16,className:"text-blue-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Crackdown:"})," All fines are doubled."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(Rs,{size:16,className:"text-green-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Free Trade:"})," All fines are halved."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(ps,{size:16,className:"text-purple-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Deflation:"})," Legal Goods value -20%."]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-zinc-800 rounded",children:[e.jsx(As,{size:16,className:"text-red-500"})," ",e.jsxs("span",{children:[e.jsx("strong",{children:"Recession:"})," Contraband value -20%."]})]})]})]})]})]})}),Hs=({onStart:a})=>{const[x,r]=w.useState(!1),[n,d]=w.useState(!1),[u,A]=w.useState(!1);return w.useEffect(()=>{const B=localStorage.getItem("contraband_roomId");r(!!B);const t=new Image;t.src=pt,t.onload=()=>{d(!0),setTimeout(()=>{A(!0)},2e3)}},[]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-black flex flex-col items-center justify-end pb-20 md:justify-center md:pb-0 font-sans overflow-hidden",children:[!n&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-50 text-emerald-500/50",children:[e.jsx(jt,{size:48,className:"animate-spin mb-4"}),e.jsx("div",{className:"font-mono text-xs tracking-[0.3em] animate-pulse",children:"INITIALIZING SYSTEM..."})]}),e.jsxs("div",{className:`absolute inset-0 z-0 overflow-hidden transition-opacity duration-1000 ${n?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:`w-full h-full bg-cover bg-center transition-transform duration-[2000ms] ease-out ${n?"scale-100":"scale-130"}`,style:{backgroundImage:`url(${pt})`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40"})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-8 animate-in fade-in slide-in-from-bottom-10 duration-1000",children:e.jsx("div",{className:`transform transition-all duration-1000 ease-out ${u?"translate-y-0 opacity-100":"translate-y-32 opacity-0"}`,children:e.jsxs("button",{onClick:a,className:"group relative px-12 py-5 bg-emerald-600/20 hover:bg-emerald-600/40 border border-emerald-500/50 hover:border-emerald-400 text-emerald-300 font-black text-2xl tracking-widest rounded-none transform transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.4)] backdrop-blur-md overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-emerald-400/10 to-transparent translate-y-[-100%] animate-[scan_2s_infinite_linear]"}),e.jsx("span",{className:"relative z-10 flex items-center gap-3 animate-pulse",children:x?e.jsxs(e.Fragment,{children:[e.jsx(Nt,{className:"animate-spin-slow"})," RESUME"]}):e.jsxs(e.Fragment,{children:[e.jsx(rs,{})," PLAY"]})})]})})}),e.jsxs("div",{className:"absolute bottom-4 text-slate-600 text-xs text-center",children:["Inspired by Sheriff of Nottingham. A tribute game.",e.jsx("br",{}),"Developed by ",e.jsx("strong",{children:"RAWFID K SHUVO"}),"."]}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(200%); }
        }
      `})]})};function Ys(){const[a,x]=w.useState(null),[r,n]=w.useState("splash"),[d,u]=w.useState(""),[A,B]=w.useState(""),[t,S]=w.useState(null),[H,l]=w.useState(!1),[N,R]=w.useState(""),[W,b]=w.useState(!1),[C,g]=w.useState(!1),[ee,M]=w.useState(!1),[ne,ke]=w.useState(!1),[je,Ie]=w.useState(!1),[Se,te]=w.useState(!1),[ce,G]=w.useState(!1),[Ce,se]=w.useState(null),[O,nt]=w.useState(null),[re,Pe]=w.useState([]),[rt,Lt]=w.useState("FOOD"),[ue,Ee]=w.useState(0),[Be,Rt]=w.useState(0),[de,Ot]=w.useState(()=>localStorage.getItem("gameHub_playerName")||"");w.useEffect(()=>{de&&localStorage.setItem("gameHub_playerName",de)},[de]),w.useEffect(()=>{(async()=>typeof __initial_auth_token<"u"&&__initial_auth_token?await Kt(qe,__initial_auth_token):await Xt(qe))();const o=Vt(qe,x);return()=>o()},[]);const Tt=()=>{const i=localStorage.getItem("contraband_roomId");i&&(l(!0),u(i)),n("menu")};w.useEffect(()=>{if(!d||!a)return;const i=ct(_(D,"artifacts",P,"public","data","rooms",d),o=>{if(o.exists()){const h=o.data();if(!h.players?.some(c=>c.id===a.uid)){u(""),n("menu"),localStorage.removeItem("contraband_roomId"),R("Connection Lost or Room Closed.");return}S(h),h.status==="lobby"?n("lobby"):n("game"),h.feedbackTrigger&&h.feedbackTrigger.id!==t?.feedbackTrigger?.id&&(!h.feedbackTrigger.visibleTo||h.feedbackTrigger.visibleTo===a.uid)&&(nt(h.feedbackTrigger),setTimeout(()=>nt(null),3e3))}else u(""),n("menu"),localStorage.removeItem("contraband_roomId"),R("Room Closed.")});return()=>i()},[d,a,t?.feedbackTrigger?.id]);const f=t?.players.find(i=>i.id===a?.uid)||{},Ae=t?.players[t?.inspectorIndex]?.id===a?.uid,Ne=t?.hostId===a?.uid,q=t?.marketEvent?ie[t.marketEvent.id]:ie.NORMAL,Le=t?.inspectorOrder?.length||t?.players.length||0;w.useEffect(()=>{f.loadedCrate&&f.loadedCrate.bribe!==void 0&&Ee(f.loadedCrate.bribe)},[f.loadedCrate]),w.useEffect(()=>{const i=ct(_(D,"game_hub_settings","config"),o=>{o.exists()&&o.data()[Ts]?.maintenance?g(!0):g(!1)});return()=>i()},[]);const _t=async()=>{if(!de.trim())return R("Codename required.");l(!0);const i="123456789ABCDEFGHIJKLMNPQRSTUVWXYZ";let o="";for(let c=0;c<6;c++)o+=i.charAt(Math.floor(Math.random()*i.length));const h={roomId:o,hostId:a.uid,gameLength:"SHORT",status:"lobby",players:[{id:a.uid,name:de,coins:_e,hand:[],stash:[],upgrades:[],role:null,loadedCrate:null,ready:!1}],deck:[],inspectorIndex:0,turnState:"IDLE",marketEvent:ie.NORMAL,logs:[],currentRound:1,inspectorOrder:[],roundHistory:[],currentRoundStats:{}};await Zt(_(D,"artifacts",P,"public","data","rooms",o),h),localStorage.setItem("contraband_roomId",o),u(o),l(!1)},Dt=async()=>{if(!A||!de)return R("Missing Info.");l(!0);try{const i=_(D,"artifacts",P,"public","data","rooms",A),o=await xt(i);if(!o.exists())throw new Error("Room not found.");if(o.data().status!=="lobby")throw new Error("Game in progress.");if(o.data().players.length>=6)throw new Error("Full.");const h={id:a.uid,name:de,coins:_e,hand:[],stash:[],upgrades:[],role:null,loadedCrate:null,ready:!1};await U(i,{players:le(h)}),localStorage.setItem("contraband_roomId",A),u(A)}catch(i){R(i.message)}l(!1)},lt=async()=>{if(!d)return;const i=_(D,"artifacts",P,"public","data","rooms",d);try{const o=await xt(i);if(o.exists()){const h=o.data();if(h.hostId===a.uid)await Qt(i);else{const c=h.players.filter(s=>s.id!==a.uid);await U(i,{players:c})}}}catch(o){console.error(o)}localStorage.removeItem("contraband_roomId"),u(""),n("menu"),te(!1)},Mt=async i=>{if(!Ne||!d)return;const o=t.players.filter(h=>h.id!==i);await U(_(D,"artifacts",P,"public","data","rooms",d),{players:o})},$t=()=>{const i=t.roomId,o=()=>{b(!0),setTimeout(()=>b(!1),2e3),triggerFeedback&&triggerFeedback("neutral","COPIED!","",Ye)};try{navigator.clipboard.writeText(i),o()}catch{const c=document.createElement("textarea");c.value=i,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c),o()}},Ge=async()=>{const i=t.players.map(o=>({...o,coins:_e,hand:[],stash:[],upgrades:[],role:null,loadedCrate:null,ready:!1}));await U(_(D,"artifacts",P,"public","data","rooms",d),{status:"lobby",players:i,logs:[],deck:[],turnState:"IDLE",winner:null,feedbackTrigger:null,marketEvent:ie.NORMAL,currentRound:1,inspectorOrder:[],roundHistory:[],currentRoundStats:{}}),te(!1)},it=async()=>{if(t.players.length<3)return R("Need 3+ Players.");const i=tt(_s(t.players.length,t.gameLength));let o=t.players.map((m,V)=>V);t.gameLength==="LONG"&&(o=[...o,...o]),o=tt(o);const h=o[0],c=t.players[h].id,s={};let y=ut(t.players);y[h].role=null,y=y.map(m=>{const V=[];for(let p=0;p<6;p++){const L=Ke(i,V);L&&V.push(L)}return s[m.id]={role:m.role,isInspector:m.id===c,income:0,expense:0,transactions:[]},{...m,hand:V,coins:_e,stash:[],upgrades:[],loadedCrate:null,ready:!1}}),await U(_(D,"artifacts",P,"public","data","rooms",d),{status:"playing",players:y,deck:i,inspectorOrder:o,inspectorIndex:h,currentRound:1,currentRoundStats:s,roundHistory:[],turnState:"SHOPPING",marketEvent:ie.NORMAL,logs:[{id:Date.now().toString(),text:"Market Open. Roles Assigned.",type:"neutral"}]})},Fe=async()=>{const i=t.players.map(o=>o.id===a.uid?{...o,ready:!o.ready}:o);if(t.status==="playing"&&t.turnState==="SHOPPING"&&i.every(o=>o.ready)){i.forEach(o=>o.ready=!1),await U(_(D,"artifacts",P,"public","data","rooms",d),{players:i,turnState:"LOADING",logs:le({id:Date.now().toString(),text:"Loading Phase Begun.",type:"neutral"})});return}if(t.status==="playing"&&t.turnState==="ROUND_SUMMARY"&&i.every(o=>o.ready)){await Ft();return}await U(_(D,"artifacts",P,"public","data","rooms",d),{players:i})},Pt=async i=>{if(f.coins<i.cost)return;let o=[...t.deck],h=F(t.currentRoundStats,a.uid,{expense:i.cost,marketItem:i.id});const c=t.players.map(s=>{if(s.id===a.uid){let y=[...s.hand];if(i.id==="POCKETS"&&o.length>0){const m=Ke(o,y);m&&y.push(m)}return{...s,hand:y,coins:s.coins-i.cost,upgrades:[...s.upgrades||[],i.id]}}return s});await U(_(D,"artifacts",P,"public","data","rooms",d),{players:c,deck:o,currentRoundStats:h})},Bt=async()=>{if(Date.now()-Be<2e3)return;const i=parseInt(ue);if(isNaN(i)||i<0)return;const o=f.loadedCrate?.bribe||0,h=i-o;if(f.coins-h<0)return;Rt(Date.now());const c=t.players.map(s=>s.id===a.uid?{...s,coins:s.coins-h,loadedCrate:{...s.loadedCrate,bribe:i}}:s);await U(_(D,"artifacts",P,"public","data","rooms",d),{players:c})},Gt=async()=>{const i=f.upgrades?.includes("EXPANDED")?5:4;if(re.length===0||re.length>i)return;const o=Math.max(0,parseInt(ue)||0);if(o>0&&o>f.coins)return;const h=t.players.findIndex(p=>p.id===a.uid),c=[...t.players],s=[...c[h].hand],y=[];[...re].sort((p,L)=>L-p).forEach(p=>{y.push(s[p]),s.splice(p,1)}),c[h].hand=s,c[h].coins-=o,c[h].loadedCrate={cards:y,declaration:rt,bribe:o};const m=c[t.inspectorIndex].id,V=c.every(p=>p.id===m||p.loadedCrate!==null);let X={players:c};V&&(X.turnState="INSPECTING",X.logs=le({id:Date.now().toString(),text:"Inspection Phase.",type:"neutral"})),await U(_(D,"artifacts",P,"public","data","rooms",d),X),Pe([]),Ee(0)},Re=async(i,o)=>{const h=t.players[t.inspectorIndex],c=[...t.players],s=c.findIndex(j=>j.id===i),y=c.findIndex(j=>j.id===h.id),m=c[s];if(!m.loadedCrate)return;h.upgrades?.includes("SCANNER");const V=m.upgrades?.includes("CONCEAL"),X=c.filter(j=>j.role==="SNITCH"&&j.id!==m.id);let p={...t.currentRoundStats};const L=j=>{let I=0,$=0;return j.forEach(K=>{const E=z[K];if(!E)return;let v=E.val,k=v;const T=Array.isArray(q.target)?q.target.includes(K):q.target===K,xe=q.target==="ALL_ILLEGAL"&&E.type==="ILLEGAL"||q.target==="ALL_LEGAL"&&E.type==="LEGAL";(T||xe)&&(k=Math.floor(v*q.multiplier)),I+=k,$+=k-v}),{total:I,impact:$}},ae=(j,I)=>{let $=j.reduce((k,T)=>k+z[T].penalty,0),K=0;I&&m.role==="DIPLOMAT"&&(K=$*.5,$*=.5);let E=$;q.id==="CRACKDOWN"&&(E*=2),q.id==="FREE_TRADE"&&(E*=.5);const v=$-E;return{finalFine:E,roleSavings:K,eventImpact:v}},Z=(j,I)=>{const $=c[j];let K=0;if($.role==="MERCHANT"){const v=I.filter(k=>z[k].type==="LEGAL").reduce((k,T)=>k+(z[T].val||0),0);K=Math.floor(v*.2)}else if($.role==="YAKUZA"){const v=I.filter(k=>z[k].type==="ILLEGAL").reduce((k,T)=>k+(z[T].val||0),0);K=Math.floor(v*.2)}K>0&&(c[j].coins+=K,c[j].coins=Math.floor(c[j].coins),p=F(p,$.id,{income:K,roleBonus:K,transaction:{label:`${Q[$.role].name} Bonus`,amount:K,detail:"Role ability triggered"}}))};if(o==="PEEK"){if(m.loadedCrate.scanned)return;const j=m.loadedCrate.cards[Math.floor(Math.random()*m.loadedCrate.cards.length)],I=[...c];I[s].loadedCrate={...I[s].loadedCrate,scanned:!0},await U(_(D,"artifacts",P,"public","data","rooms",d),{players:I,logs:le({id:Date.now().toString(),text:`Inspector used scanner in ${m.name}'s crate!`,type:"neutral"}),feedbackTrigger:{id:Date.now(),type:"neutral",message:"SCAN RESULT",subtext:`Found: ${z[j].name}`,visibleTo:h.id}});return}let Y=[],me=null;if(o==="PASS"||o==="ACCEPT_BRIBE"){const j=m.loadedCrate.bribe||0;o==="ACCEPT_BRIBE"&&j>0?(c[y].coins+=j,Y.push({id:Date.now().toString(),text:`Inspector accepted $${j} bribe from ${m.name}.`,type:"bribe"}),p=F(p,h.id,{income:j,transaction:{label:"Bribe Accepted",amount:j,detail:`From ${m.name}`}}),p=F(p,m.id,{expense:j,transaction:{label:"Bribe Paid",amount:-j,detail:`To ${h.name}`}})):(c[s].coins+=j,Y.push({id:Date.now().toString(),text:`Inspector passed ${m.name}.`,type:"success"}),p=F(p,h.id,{transaction:{label:"Pass Decision",amount:0,detail:`Passed ${m.name}`}}),j>0&&(p=F(p,m.id,{income:j,transaction:{label:"Bribe Returned",amount:j}})));const{total:I,impact:$}=L(m.loadedCrate.cards);c[s].coins+=I,p=F(p,m.id,{income:I,eventImpact:$,transaction:{label:"Goods Sold",amount:I,items:m.loadedCrate.cards,detail:$!==0?`Event Impact: ${$>0?"+":""}$${$}`:""}}),c[s].stash.push(...m.loadedCrate.cards),Z(s,m.loadedCrate.cards)}else if(o==="OPEN"){const j=m.loadedCrate.bribe||0;c[s].coins+=j,j>0&&(p=F(p,m.id,{income:j,transaction:{label:"Bribe Returned",amount:j}}));const I=m.loadedCrate.cards,$=m.loadedCrate.declaration;if(I.includes("TRAP")){c[y].coins-=200,c[s].coins+=200,p=F(p,h.id,{expense:200,transaction:{label:"Trap Exploded",amount:-200,detail:"Booby Trap triggered"}}),p=F(p,m.id,{income:200,transaction:{label:"Trap Reward",amount:200,detail:"Inspector triggered trap"}});const E=I.filter(T=>T!=="TRAP"),{total:v,impact:k}=L(E);c[s].coins+=v,p=F(p,m.id,{income:v,eventImpact:k,transaction:{label:"Survivors Sold",amount:v,items:E,detail:k!==0?`Event Impact: ${k>0?"+":""}$${k}`:""}}),c[s].stash.push(...E),Z(s,E),Y.push({id:Date.now().toString(),text:"BOOM! Booby Trap! Inspector pays $200.",type:"danger"}),me={id:Date.now(),type:"danger",message:"BOOBY TRAP!",subtext:"Inspector blown up."}}else{let E=I.filter(v=>z[v].type==="ILLEGAL"||v!==$);if(V&&E.length>0&&(E.sort((v,k)=>z[v].val-z[k].val),E.pop(),Y.push({id:Date.now().toString(),text:`${m.name}'s Hidden Compartment saved an item!`,type:"neutral"})),E.length===0){const{finalFine:v,eventImpact:k}=ae(I,!1);c[y].coins-=v,c[s].coins+=v,p=F(p,h.id,{expense:v,transaction:{label:"Wrongful Search",amount:-v,detail:"Paid compensation"}}),p=F(p,m.id,{income:v,eventImpact:k,transaction:{label:"Clean Bonus",amount:v,detail:"Compensation received"}});const{total:T,impact:xe}=L(I);c[s].coins+=T,p=F(p,m.id,{income:T,eventImpact:xe,transaction:{label:"Goods Sold",amount:T,items:I,detail:xe!==0?`Event Impact: ${xe>0?"+":""}$${xe}`:""}}),c[s].stash.push(...I),Z(s,I),Y.push({id:Date.now().toString(),text:`CLEAN! Inspector pays $${v} fine.`,type:"danger"}),me={id:Date.now(),type:"danger",message:"CLEAN",subtext:"Inspector pays fine."}}else{let v=[],k=[];I.forEach(pe=>{if(E.includes(pe)){v.push(pe);const ye=E.indexOf(pe);ye>-1&&E.splice(ye,1)}else k.push(pe)});const{finalFine:T,roleSavings:xe,eventImpact:Ht}=ae(v,!0);c[s].coins-=T,c[y].coins+=T,p=F(p,m.id,{expense:T,roleBonus:xe,eventImpact:Ht,transaction:{label:"Fine Paid",amount:-T,detail:`Seized: ${v.length} items`}}),p=F(p,h.id,{income:T,transaction:{label:"Fine Collected",amount:T,items:v}});const{total:Oe,impact:Te}=L(k);c[s].coins+=Oe,Oe>0&&(p=F(p,m.id,{income:Oe,eventImpact:Te,transaction:{label:"Kept Goods Sold",amount:Oe,items:k,detail:Te!==0?`Event Impact: ${Te>0?"+":""}$${Te}`:""}})),c[s].stash.push(...k),Z(s,k),X.forEach(pe=>{const ye=c.findIndex(Yt=>Yt.id===pe.id);ye>-1&&(c[ye].coins+=100,p=F(p,pe.id,{income:100,roleBonus:100,transaction:{label:"Snitch Reward",amount:100,detail:`${m.name} busted`}}))}),Y.push({id:Date.now().toString(),text:`BUSTED! ${m.name} pays $${T}. ${v.length} items seized.`,type:"success"}),me={id:Date.now(),type:"success",message:"BUSTED",subtext:"Contraband Seized!"}}}}if(c[s].loadedCrate=null,c.filter(j=>j.id!==h.id&&j.loadedCrate!==null).length===0){const j={stats:p,event:q||ie.NORMAL};await U(_(D,"artifacts",P,"public","data","rooms",d),{players:c,logs:le(...Y),currentRoundStats:p,roundHistory:le(j),turnState:"ROUND_SUMMARY",feedbackTrigger:me})}else await U(_(D,"artifacts",P,"public","data","rooms",d),{players:c,logs:le(...Y),currentRoundStats:p,feedbackTrigger:me})},Ft=async()=>{const i=t.currentRound+1;if(i>Le){const L=Ps(t.players),ae=t.players.map(Z=>{const Y=L[Z.id],me=Z.stash.reduce((j,I)=>j+(z[I]?.val||0),0),ot=Math.floor(Z.coins+me-et+Y.income);return{...Z,finalScore:ot,kqDetails:Y.details,kqIncome:Y.income,ready:!1}}).sort((Z,Y)=>Y.finalScore-Z.finalScore);await U(_(D,"artifacts",P,"public","data","rooms",d),{players:ae,status:"finished",turnState:"IDLE",winner:ae[0].name,feedbackTrigger:{id:Date.now(),type:"success",message:"GAME OVER",subtext:`${ae[0].name} wins!`}});return}let o=t.inspectorOrder[i-1],h=[...t.deck];const c=Object.keys(ie),s=c[Math.floor(Math.random()*c.length)],y=ie[s];let m=ut(t.players);m[o].role=null;const V=m[o].id,X={};m.forEach(L=>{X[L.id]={role:L.role,isInspector:L.id===V,income:0,expense:0,transactions:[],marketItems:[],roleBonus:0}});const p=m.map(L=>{const ae=[...L.hand],Z=L.upgrades?.includes("POCKETS")?7:6;for(;ae.length<Z&&h.length>0;){const Y=Ke(h,ae);Y&&ae.push(Y)}return{...L,hand:ae,loadedCrate:null,ready:!1}});await U(_(D,"artifacts",P,"public","data","rooms",d),{players:p,deck:h,inspectorIndex:o,currentRound:i,currentRoundStats:X,roundHistory:le({stats:t.currentRoundStats,event:t.marketEvent||ie.NORMAL}),turnState:"SHOPPING",marketEvent:y,logs:le({id:Date.now().toString(),text:`Round ${i} Started. Event: ${y.name}`,type:"neutral"})})};if(C)return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-4 text-center",children:[e.jsx(ht,{}),e.jsxs("div",{className:"bg-orange-500/10 p-8 rounded-2xl border border-orange-500/30",children:[e.jsx(Xe,{size:64,className:"text-orange-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Under Maintenance"}),e.jsx("p",{className:"text-gray-400",children:"Border crossing closed. Inspections are paused."})]}),e.jsx("div",{className:"h-8"}),e.jsx("a",{href:"/rawfids-gamehub/",children:e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("div",{className:"text-center pb-12 animate-pulse",children:e.jsxs("div",{className:"inline-flex items-center gap-3 px-8 py-4 bg-slate-900/50 rounded-full border border-indigo-500/20 text-indigo-300 font-bold tracking-widest text-sm uppercase backdrop-blur-sm",children:[e.jsx(dt,{size:16})," Visit Gamehub...Try our other releases..."," ",e.jsx(dt,{size:16})]})})})}),e.jsx(Ve,{})]});if(!a)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center text-green-500 animate-pulse",children:"Moving Shipments..."});if(d&&!t&&!N)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-4",children:[e.jsx(ve,{}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur p-8 rounded-2xl border border-zinc-700 shadow-2xl flex flex-col items-center gap-4 animate-in fade-in zoom-in duration-300",children:[e.jsx(jt,{size:48,className:"text-green-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reconnecting..."}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Resuming your session"})]})]})]});if(r==="splash")return e.jsx(Hs,{onStart:Tt});if(r==="menu")return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col items-center justify-center p-4 relative overflow-hidden font-sans",children:[e.jsx(ve,{}),e.jsx("nav",{className:"absolute top-0 left-0 w-full p-4 z-50",children:e.jsxs("a",{href:"/rawfids-gamehub/",className:`flex items-center gap-2 text-emerald-800 rounded-lg 
			font-bold shadow-md hover:text-emerald-400 transition-colors w-fit animate-pulse`,children:[e.jsx(as,{}),e.jsx("span",{children:"Back to Gamehub"})]})}),ee&&e.jsx(gt,{onClose:()=>M(!1)}),e.jsxs("div",{className:"z-10 text-center mb-10",children:[e.jsx(be,{size:64,className:"text-emerald-500 mx-auto mb-4 animate-bounce"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-linear-to-b from-emerald-400 to-green-700 tracking-widest",children:"CONTRABAND"}),e.jsx("p",{className:"text-white-400/60 tracking-[0.3em] uppercase mt-2",children:"Black Market Edition"})]}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur border border-emerald-500/30 p-8 rounded-2xl w-full max-w-md shadow-2xl z-10",children:[N&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-2 mb-4 rounded text-center text-sm",children:N}),e.jsx("input",{className:"w-full bg-black/50 border border-zinc-600 p-3 rounded mb-4 text-white placeholder-zinc-500 focus:border-emerald-500 outline-none",placeholder:"Alias",value:de,onChange:i=>Ot(i.target.value)}),e.jsxs("button",{onClick:_t,disabled:H,className:"w-full bg-emerald-700 hover:bg-emerald-600 p-4 rounded font-bold mb-4 flex items-center justify-center gap-2 transition-all",children:[e.jsx(yt,{size:20})," Create Syndicate"]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{className:"flex-1 min-w-0 bg-black/50 border border-zinc-600 p-3 rounded text-white placeholder-zinc-500 uppercase tracking-wider",placeholder:"CODE",value:A,onChange:i=>B(i.target.value.toUpperCase())}),e.jsx("button",{onClick:Dt,disabled:H,className:"bg-zinc-800 hover:bg-zinc-700 px-6 rounded font-bold shrink-0",children:"Join"})]}),e.jsxs("button",{onClick:()=>M(!0),className:"w-full text-center text-zinc-500 hover:text-white text-sm mt-2 flex items-center justify-center gap-2",children:[e.jsx(Ze,{size:14})," Smuggler's Guide"]})]})]});if(r==="lobby"&&t)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col items-center justify-center p-6 relative",children:[e.jsx(ve,{}),e.jsx(ht,{}),Se&&e.jsx(ft,{isHost:Ne,onConfirm:lt,onCancel:()=>te(!1)}),e.jsxs("div",{className:"z-10 w-full max-w-lg bg-zinc-900/90 backdrop-blur p-8 rounded-2xl border border-emerald-900/50 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl text-green-500 font-bold uppercase",children:"Station:"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-white font-black",children:t.roomId}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:$t,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:W?e.jsx(Ye,{size:16,className:"text-green-500"}):e.jsx(ns,{size:16})}),W&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-green-500 text-black text-xs font-bold px-2 py-1 rounded shadow-lg animate-fade-in-up whitespace-nowrap",children:"Copied!"})]})]})]}),e.jsx("button",{onClick:()=>te(!0),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:e.jsx(Qe,{size:16})})]}),e.jsx("div",{className:"space-y-2 mb-8",children:t.players.map(i=>e.jsxs("div",{className:"flex items-center justify-between bg-zinc-800/50 p-3 rounded border border-zinc-700/50",children:[e.jsxs("span",{className:"font-bold flex items-center gap-2",children:[e.jsx(De,{size:14,className:i.id===a.uid?"text-emerald-500":"text-zinc-500"}),i.name," ",i.id===t.hostId&&e.jsx(we,{size:14,className:"text-yellow-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-zinc-500 text-xs",children:"Waiting"}),t.hostId===a.uid&&i.id!==a.uid&&e.jsx("button",{onClick:()=>Mt(i.id),className:"p-1.5 bg-zinc-700 hover:bg-red-900/50 text-zinc-400 hover:text-red-400 rounded transition-colors",title:"Kick Player",children:e.jsx(Cs,{size:12})})]})]},i.id))}),t.hostId===a.uid&&e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs("div",{className:"bg-zinc-800 p-1 rounded-lg flex items-center",children:[e.jsx("button",{onClick:()=>U(_(D,"artifacts",P,"public","data","rooms",d),{gameLength:"SHORT"}),className:`px-4 py-2 rounded text-xs font-bold transition-all ${t.gameLength==="SHORT"?"bg-emerald-600 text-white":"text-zinc-500 hover:text-zinc-300"}`,children:"SHORT (1x)"}),e.jsx("button",{onClick:()=>U(_(D,"artifacts",P,"public","data","rooms",d),{gameLength:"LONG"}),className:`px-4 py-2 rounded text-xs font-bold transition-all ${t.gameLength==="LONG"?"bg-emerald-600 text-white":"text-zinc-500 hover:text-zinc-300"}`,children:"LONG (2x)"})]})}),e.jsxs("div",{className:"text-center text-xs text-zinc-500 mb-4 uppercase tracking-widest",children:["Game Length: ",t.gameLength||"SHORT"]}),t.hostId===a.uid&&e.jsx("button",{onClick:it,disabled:t.players.length<3,className:"w-full py-4 bg-emerald-700 hover:bg-emerald-600 rounded-xl font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:t.players.length<3?"Need 3+ Players":"Start Smuggling"})]}),e.jsx(Ve,{})]});if(r==="game"&&t){const i=t.players[t.inspectorIndex],o=t.players.find(s=>s.id===a?.uid);if(!i||!o)return e.jsxs("div",{className:"min-h-screen bg-zinc-950 flex flex-col items-center justify-center text-white p-6 relative overflow-hidden",children:[e.jsx(ve,{}),e.jsxs("div",{className:"z-10 bg-zinc-900/90 p-8 rounded-2xl border border-red-500/50 shadow-2xl text-center max-w-md animate-in fade-in zoom-in",children:[e.jsx(oe,{size:64,className:"text-red-500 mx-auto mb-4 animate-pulse"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"MISSION COMPROMISED"}),e.jsx("p",{className:"text-zinc-400 mb-6",children:"An agent has disconnected or the operation data is out of sync. The current round cannot continue."}),e.jsxs("button",{onClick:Ge,className:"w-full py-3 bg-zinc-700 hover:bg-zinc-600 text-white rounded-xl font-bold transition-all flex items-center justify-center gap-2",children:[e.jsx(Nt,{size:18})," Return to Lobby"]})]})]});const h=t.players.filter(s=>s.id!==t.hostId).every(s=>s.ready),c=f.ready||t.turnState!=="SHOPPING";return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col relative overflow-hidden font-sans",children:[e.jsx(ve,{}),O&&e.jsx(Bs,{type:O.type,message:O.message,subtext:O.subtext,icon:O.type==="danger"?oe:O.type==="bribe"?mt:vs}),ee&&e.jsx(gt,{onClose:()=>M(!1)}),je&&e.jsx(Fs,{logs:t.logs,onClose:()=>Ie(!1)}),Se&&e.jsx(ft,{isHost:Ne,onLobby:Ge,onConfirm:lt,onCancel:()=>te(!1)}),ce&&e.jsx(Ms,{stash:f.stash||[],onClose:()=>G(!1)}),Ce&&e.jsx($s,{player:t.players.find(s=>s.id===Ce),onClose:()=>se(null)}),e.jsx(Gs,{isOpen:ne,onClose:()=>ke(!1),player:f,onBuy:Pt}),e.jsxs("div",{className:"h-16 bg-zinc-900/90 border-b border-zinc-800 flex items-center justify-between px-4 z-50 backdrop-blur-md sticky top-0 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden md:flex flex-col",children:[e.jsx("span",{className:"text-xs text-zinc-500 uppercase tracking-widest",children:"Event"}),e.jsxs("span",{className:"text-sm font-bold text-yellow-500 flex items-center gap-1",children:[q.id==="WAR"&&e.jsx(at,{size:14}),q.id==="PANDEMIC"&&e.jsx(vt,{size:14}),q.id==="CRACKDOWN"&&e.jsx(oe,{size:14}),q.name]})]}),e.jsxs("div",{className:"bg-black/40 px-3 py-1 rounded-full border border-zinc-700 flex items-center gap-2",children:[e.jsx(Me,{size:14,className:"text-yellow-500"}),e.jsxs("span",{className:"font-mono font-bold",children:["$",f.coins]})]}),e.jsxs("div",{className:"text-xs text-zinc-500 bg-black/50 px-2 py-1 rounded border border-zinc-800 flex items-center gap-1",children:[e.jsx(is,{size:14}),e.jsxs("span",{children:[t.currentRound,"/",Le]})]}),e.jsxs("div",{className:"text-xs text-zinc-500 bg-black/50 px-2 py-1 rounded border border-zinc-800 flex items-center gap-1",children:[e.jsx(os,{size:14}),t.deck.length]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ie(!je),className:`p-2 rounded-full ${je?"bg-green-900 text-green-400":"text-gray-400 hover:bg-gray-800"}`,children:e.jsx(wt,{size:20})}),e.jsx("button",{onClick:()=>M(!0),className:"p-2 hover:bg-zinc-800 rounded text-zinc-400",children:e.jsx(Ze,{size:20})}),e.jsx("button",{onClick:()=>te(!0),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:e.jsx(Qe,{size:20})})]})]}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col items-center relative z-10 max-w-6xl mx-auto w-full gap-6",children:[e.jsx("div",{className:"flex items-center justify-center gap-4",children:e.jsxs("div",{className:`px-6 py-2 rounded-full border flex items-center gap-2 shadow-lg ${t.turnState==="INSPECTING"?"bg-red-900/30 border-red-500 text-red-200":"bg-emerald-900/30 border-emerald-500 text-emerald-200"}`,children:[t.turnState==="SHOPPING"?e.jsx(fe,{size:18}):t.turnState==="LOADING"?e.jsx(be,{size:18}):t.turnState==="ROUND_SUMMARY"?e.jsx(zt,{size:18}):e.jsx(oe,{size:18}),e.jsx("span",{className:"font-bold tracking-wide",children:t.turnState==="SHOPPING"?"MARKET PHASE":t.turnState==="LOADING"?"LOAD CRATES":t.turnState==="ROUND_SUMMARY"?"ROUND REPORT":`INSPECTOR: ${i.name}`})]})}),e.jsx("div",{className:`flex gap-3 justify-center flex-wrap w-full transition-opacity duration-500 ${t.status==="finished"?"opacity-20 pointer-events-none":"opacity-100"}`,children:t.players.map(s=>{if(s.id===a.uid)return null;const y=s.id===i.id;let m=De,V="text-zinc-500",X="Player";return y?(m=oe,V="text-red-500 animate-pulse",X="Inspector"):s.role&&(m=Q[s.role].icon,V=Q[s.role].color,X=Q[s.role].name),e.jsxs("div",{className:`relative bg-zinc-900/90 p-3 rounded-xl border-2 w-32 transition-all flex flex-col items-center ${y?"border-red-500 shadow-[0_0_16px_rgba(239,68,68,0.3)]":"border-zinc-700 shadow-[0_0_16px_rgba(34,197,94,0.3)]"} ${s.loadedCrate?"bg-zinc-800":""}`,children:[e.jsxs("div",{className:"relative flex flex-col items-center pt-4",children:[e.jsxs("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 flex items-center gap-1 opacity-70 text-[9px]",children:[e.jsx(m,{size:12,className:V}),e.jsx("span",{className:"uppercase animate-pulse tracking-tight",children:X})]}),e.jsx(De,{size:24,className:y?"text-red-500":"text-zinc-600"}),e.jsx("span",{className:`font-bold text-xs truncate w-full text-center mt-1 ${y?"text-red-200":"text-zinc-400"}`,children:s.name}),e.jsx("button",{onClick:()=>se(s.id),className:"mt-auto pt-2 w-full",children:e.jsxs("div",{className:"w-full py-1.5 bg-zinc-800 hover:bg-zinc-700 border border-zinc-600 rounded text-[10px] text-zinc-400 hover:text-white transition-colors flex items-center justify-center gap-1 uppercase font-bold tracking-wider",children:[e.jsx(ge,{size:10})," View Stash"]})})]}),s.upgrades&&s.upgrades.length>0&&e.jsx("div",{className:"flex gap-1 justify-center mt-1 flex-wrap",children:s.upgrades.map(p=>{const L=he[p];return L?e.jsx("div",{className:"p-0.5 bg-zinc-800 rounded border border-zinc-600 text-yellow-500",title:L.name,children:e.jsx(L.icon,{size:10})},p):null})}),s.loadedCrate?e.jsxs("div",{className:"mt-2 w-full bg-black/40 rounded p-2 text-center border border-zinc-600",children:[e.jsx("div",{className:"flex justify-center items-center gap-1 mb-1",children:e.jsxs("div",{className:"bg-zinc-700 text-zinc-300 text-[9px] px-1.5 py-0.5 rounded flex items-center gap-1",children:[e.jsx(St,{size:8})," ",s.loadedCrate.cards.length]})}),e.jsxs("div",{className:"text-[10px] text-zinc-500 uppercase flex justify-center items-center gap-1",children:[z[s.loadedCrate.declaration].name," ",s.loadedCrate.bribe>0&&e.jsx(Me,{size:10,className:"text-yellow-500"})]}),Ae&&f.id===i.id&&t.turnState==="INSPECTING"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[e.jsx("button",{onClick:()=>Re(s.id,"PASS"),className:"bg-emerald-700 hover:bg-emerald-600 text-[8px] py-2 rounded text-white font-bold",children:"PASS"}),e.jsx("button",{onClick:()=>Re(s.id,"OPEN"),className:"bg-red-700 hover:bg-red-600 text-[8px] py-2 rounded text-white font-bold",children:"OPEN"}),s.loadedCrate.bribe>0&&e.jsxs("button",{onClick:()=>Re(s.id,"ACCEPT_BRIBE"),className:"col-span-2 bg-yellow-600 hover:bg-yellow-500 text-[9px] py-1 rounded text-black font-bold flex items-center justify-center gap-1",children:["Take $",s.loadedCrate.bribe," Bribe"]}),f.upgrades?.includes("SCANNER")&&!s.loadedCrate.scanned&&e.jsxs("button",{onClick:()=>Re(s.id,"PEEK"),className:"col-span-2 bg-blue-600 hover:bg-blue-500 text-[9px] py-1 rounded text-white font-bold flex items-center justify-center gap-1",children:[e.jsx(Et,{size:10})," SCAN"]})]})]}):!y&&e.jsx("div",{className:"mt-2 text-[9px] text-zinc-600 animate-pulse",children:s.ready?"Ready":"Thinking..."})]},s.id)})}),e.jsx("div",{className:`w-full max-w-4xl bg-zinc-900/95 p-4 md:p-6 rounded-t-3xl border-t border-emerald-500/30 backdrop-blur-md mt-auto shadow-[0_-10px_40px_rgba(0,0,0,0.5)] z-20 transition-opacity duration-500 ${t.status==="finished"?"opacity-20 pointer-events-none":"opacity-100"}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2 min-w-[140px]",children:[Ae?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-bold text-lg text-white flex items-center gap-2",children:[e.jsx(oe,{size:18,className:"text-red-500 animate-pulse"}),f.name]}),e.jsx("div",{className:"text-xs text-red-300 font-bold",children:"You are the Inspector. Check crates!"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-bold text-lg text-white flex items-center gap-2",children:[f.role&&$e.createElement(Q[f.role].icon,{size:18,className:Q[f.role].color}),f.name]}),e.jsx("div",{className:"text-xs text-zinc-500",children:Q[f.role]?.desc})]}),e.jsxs("div",{className:"mt-2 border-t border-zinc-700 pt-2",children:[e.jsxs("div",{className:"text-[10px] text-zinc-500 uppercase font-bold mb-1 flex items-center gap-1",children:[e.jsx(cs,{size:10})," Event Active"]}),e.jsx("div",{className:"text-sm font-bold text-yellow-500",children:q.name}),e.jsx("div",{className:"text-[10px] text-zinc-400 leading-tight",children:q.desc})]}),e.jsx("div",{className:"mt-2 flex gap-1 flex-wrap",children:f.upgrades?.map(s=>{const y=he[s].icon;return e.jsx("div",{className:"p-1 bg-zinc-800 rounded border border-zinc-700 text-yellow-500",title:he[s].name,children:e.jsx(y,{size:12})},s)})}),e.jsxs("button",{onClick:()=>G(!0),className:"mt-2 w-full py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-xs text-zinc-300 border border-zinc-600 flex items-center justify-center gap-2 transition-colors",children:[e.jsx(ge,{size:12})," View Stash (",f.stash.length,")"]}),t.turnState==="SHOPPING"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>!c&&ke(!0),disabled:c,className:`mt-2 w-full py-2 rounded text-xs border flex items-center justify-center gap-2 transition-colors ${c?"bg-zinc-800 text-zinc-600 border-zinc-700 cursor-not-allowed":"bg-yellow-900/20 hover:bg-yellow-900/30 text-yellow-500 border-yellow-500/50"}`,children:[e.jsx(fe,{size:12})," Open Black Market"]}),e.jsx("button",{onClick:Fe,disabled:f.ready,className:`mt-2 py-2 px-4 rounded font-bold transition-all ${f.ready?"bg-green-600/50 text-white/50 cursor-not-allowed":"bg-zinc-700 text-zinc-300 hover:bg-zinc-600"}`,children:f.ready?"READY":"MARKET DONE"})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto min-h-[160px]",children:Ae?null:f.loadedCrate?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center w-full min-w-0",children:[e.jsx("div",{className:"w-full overflow-x-auto no-scrollbar",children:e.jsx("div",{className:"flex gap-2 w-max mx-auto px-4 py-4 grayscale-[0.3] scale-90 origin-bottom",children:f.loadedCrate.cards.map((s,y)=>e.jsxs("div",{className:"relative group shrink-0 transition-transform hover:-translate-y-2",children:[e.jsx(st,{typeId:s,small:!1}),e.jsx("div",{className:"absolute inset-0 bg-black/20 rounded-xl flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Je,{className:"text-white/80 drop-shadow-md"})})]},y))})}),e.jsxs("div",{className:"flex items-center gap-3 bg-zinc-900/80 px-4 py-2 rounded-full border border-emerald-500/30 text-xs shadow-xl backdrop-blur-md whitespace-nowrap z-20",children:[e.jsxs("span",{className:"flex items-center gap-1 text-emerald-400 font-bold",children:[e.jsx(Je,{size:12})," LOCKED"]}),e.jsx("div",{className:"w-px h-3 bg-zinc-700"}),e.jsxs("span",{className:"text-zinc-400",children:["Declared:"," ",e.jsx("strong",{className:"text-white",children:z[f.loadedCrate.declaration]?.name})]}),f.loadedCrate.bribe>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-3 bg-zinc-700"}),e.jsxs("span",{className:"flex items-center gap-1 text-yellow-500 font-mono",children:[e.jsx(Me,{size:12})," $",f.loadedCrate.bribe]})]})]})]}):t.turnState==="LOADING"?e.jsx("div",{className:"flex gap-2 pb-2",children:f.hand.map((s,y)=>e.jsx(st,{typeId:s,selected:re.includes(y),onClick:()=>{re.includes(y)?Pe(re.filter(m=>m!==y)):re.length<(f.upgrades?.includes("EXPANDED")?5:4)&&Pe([...re,y])}},y))}):e.jsx("div",{className:"h-full flex items-center justify-center text-zinc-600 italic",children:"Market Phase - Check Shop"})}),!Ae&&t.turnState!=="SHOPPING"&&e.jsxs("div",{className:"min-w-[200px] flex flex-col gap-3",children:[!f.loadedCrate&&t.turnState==="LOADING"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-zinc-800 p-2 rounded-xl border border-zinc-700",children:[e.jsx("label",{className:"text-[10px] text-zinc-500 uppercase font-bold mb-1 block",children:"Declare As"}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:["FOOD","MEDS","TEXTILE","PARTS"].map(s=>e.jsx("button",{onClick:()=>Lt(s),className:`p-2 rounded flex items-center justify-center ${rt===s?"bg-emerald-600 text-white":"bg-zinc-700 text-zinc-400"}`,children:$e.createElement(z[s].icon,{size:16})},s))})]}),e.jsxs("div",{className:"bg-zinc-800 p-2 rounded-xl border border-zinc-700 flex items-center gap-2",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase font-bold w-12",children:"Bribe"}),e.jsx("input",{type:"range",min:"0",max:Math.max(0,Math.min(f.coins,1e4)),step:"10",value:ue,onChange:s=>Ee(s.target.value),className:"flex-1 accent-yellow-500 h-2 bg-zinc-700 rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"text-xs font-mono text-yellow-500 w-10 text-right",children:["$",ue]})]}),e.jsx("button",{onClick:Gt,disabled:re.length===0,className:"w-full py-3 bg-linear-to-r from-emerald-600 to-green-500 hover:from-emerald-500 hover:to-green-400 disabled:opacity-50 text-white font-bold rounded-xl shadow-lg",children:"LOAD CRATE"})]}),f.loadedCrate&&e.jsxs("div",{className:"bg-zinc-800/80 p-3 rounded-xl border border-yellow-500/30 animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"text-xs font-bold text-white flex items-center gap-2",children:[e.jsx(mt,{size:14,className:"text-yellow-500"})," ","Negotiation"]}),e.jsx("div",{className:"text-[10px] text-zinc-400 uppercase tracking-wider",children:"Active"})]}),e.jsxs("div",{className:"bg-zinc-900 p-2 rounded-lg border border-zinc-700 flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase font-bold w-8",children:"Offer"}),e.jsx("input",{type:"range",min:"0",max:Math.min(1e4,f.coins+(f.loadedCrate?.bribe||0)),step:"10",value:ue,onChange:s=>Ee(s.target.value),className:"flex-1 accent-yellow-500 h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"text-xs font-mono text-yellow-500 w-10 text-right",children:["$",ue]})]}),e.jsx("button",{onClick:Bt,disabled:Date.now()-Be<2e3,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-500 disabled:bg-zinc-700 disabled:text-zinc-500 text-black font-bold rounded-lg text-xs shadow-lg shadow-yellow-900/20 transition-colors flex items-center justify-center gap-2",children:Date.now()-Be<2e3?e.jsxs(e.Fragment,{children:[e.jsx(ds,{size:12,className:"animate-spin"})," WAIT"]}):"UPDATE OFFER"})]})]})]})}),t.status==="finished"&&e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"w-full max-w-4xl bg-zinc-900 border border-emerald-500/50 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsx("div",{className:"p-6 bg-zinc-950 border-b border-zinc-800 text-center",children:e.jsxs("h2",{className:"text-4xl font-bold text-emerald-400 drop-shadow-md",children:[t.winner," Wins!"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(bt,{players:t.players,roundData:t.roundHistory,isFinal:!0})}),e.jsx("div",{className:"p-6 bg-zinc-950 border-t border-zinc-800 flex justify-center gap-4",children:Ne?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:it,disabled:!h,className:`px-6 py-3 rounded-xl font-bold text-white shadow-lg transition-all ${h?"bg-emerald-600 hover:bg-emerald-500":"bg-zinc-800 text-zinc-600 cursor-not-allowed"}`,children:"New Game"}),e.jsx("button",{onClick:Ge,disabled:!h,className:`px-6 py-3 rounded-xl font-bold text-white transition-all ${h?"bg-zinc-700 hover:bg-zinc-600":"bg-zinc-800 text-zinc-600 cursor-not-allowed"}`,children:"Return Team to Lobby"})]}):e.jsx("button",{onClick:Fe,className:`px-8 py-3 rounded-xl font-bold transition-all ${f.ready?"bg-green-600 text-white":"bg-zinc-700 hover:bg-zinc-600 text-white"}`,children:f.ready?"Ready! Waiting for Host...":"Ready for Next Round"})}),Ne&&!h&&e.jsx("div",{className:"pb-4 text-center text-xs text-zinc-500 animate-pulse",children:"Waiting for squad..."})]})}),t.turnState==="ROUND_SUMMARY"&&e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"w-full max-w-4xl bg-zinc-900 border border-zinc-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 bg-zinc-950 border-b border-zinc-800 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Round ",t.currentRound," Complete"]}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-widest",children:t.currentRound>=Le?"Game Sequence Complete":"Next Event Loading..."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(bt,{players:t.players,roundData:t.roundHistory,isFinal:!1})}),e.jsx("div",{className:"p-6 bg-zinc-950 border-t border-zinc-800 flex justify-center",children:e.jsx("button",{onClick:Fe,className:`px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2 ${f.ready?"bg-green-600 text-white shadow-green-900/20":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-900/20"}`,children:f.ready?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{size:20})," Waiting for others..."]}):e.jsx(e.Fragment,{children:t.currentRound>=Le?e.jsxs(e.Fragment,{children:["Show Final Results ",e.jsx(we,{size:20})]}):e.jsxs(e.Fragment,{children:["Start Round ",t.currentRound+1," ",e.jsx(ls,{size:20})]})})})}),e.jsx("div",{className:"pb-4 bg-zinc-950 flex justify-center gap-2",children:t.players.map(s=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${s.ready?"bg-green-500":"bg-zinc-700"}`,title:s.name},s.id))})]})})]}),e.jsx(Ve,{})]})}return null}Jt.createRoot(document.getElementById("root")).render(e.jsx(w.StrictMode,{children:e.jsx(Ys,{})}));
